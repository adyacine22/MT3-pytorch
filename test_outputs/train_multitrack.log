2025-11-03 09:31:38,871 - INFO - ================================================================================
2025-11-03 09:31:38,871 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 09:31:38,871 - INFO - ================================================================================
2025-11-03 09:31:38,871 - INFO - Configuration: A100_pretraining_test
2025-11-03 09:31:38,871 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 09:31:38,871 - INFO - ================================================================================
2025-11-03 09:31:38,927 - INFO - Device: cuda
2025-11-03 09:31:38,928 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 09:31:38,928 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 09:31:38,928 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 09:31:38,928 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=False
2025-11-03 09:31:38,928 - INFO -   Batch size: 128, Steps: 100
2025-11-03 09:31:38,929 - INFO -   Validation interval: 20 steps
2025-11-03 09:31:38,929 - INFO -   Log interval: 5 steps
2025-11-03 09:31:38,929 - INFO - 
Initializing model...
2025-11-03 09:31:40,356 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 09:31:40,358 - INFO -   Total parameters: 44,674,663
2025-11-03 09:31:40,368 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 09:31:40,368 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 09:32:12,633 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 09:32:12,633 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 09:32:12,633 - INFO - 
Setting up datasets...
2025-11-03 09:32:12,633 - INFO -   Loading MAESTRO dataset...
2025-11-03 09:33:29,165 - INFO -   ‚úì MAESTRO train: 800 samples (cached)
2025-11-03 09:33:29,166 - INFO -   ‚úì MAESTRO val: 137 samples (cached)
2025-11-03 09:33:29,166 - INFO -   Loading SLAKH stems dataset...
2025-11-03 09:35:47,518 - INFO -   ‚úì SLAKH stems train: 4135 samples (cached)
2025-11-03 09:37:13,188 - INFO -   ‚úì SLAKH stems val: 2833 samples (cached)
2025-11-03 09:37:13,188 - INFO -   Loading SLAKH mix dataset...
2025-11-03 09:38:59,541 - INFO -   ‚úì SLAKH mix train: 400 samples (cached)
2025-11-03 09:39:04,765 - INFO -   ‚úì SLAKH mix val: 270 samples (cached)
2025-11-03 09:39:04,765 - INFO - 
  Creating multi-task dataset...
2025-11-03 09:39:04,766 - INFO -   ‚úì Multi-task dataset: 5335 total samples
2025-11-03 09:39:04,766 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0}
2025-11-03 09:39:04,766 - INFO - 
  Setting up validation data...
2025-11-03 09:39:04,766 - INFO -   ‚úì Validation: 3240 samples
2025-11-03 09:39:04,771 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 09:39:04,771 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 09:39:04,771 - INFO -   Label smoothing: 0.1
2025-11-03 09:39:04,772 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 09:39:04,772 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 09:39:04,772 - INFO - 
Starting training...
2025-11-03 09:39:04,772 - INFO -   Total steps: 100
2025-11-03 09:39:04,772 - INFO -   Batch size: 128
2025-11-03 09:39:04,772 - INFO -   Learning rate: 0.0001
2025-11-03 09:39:04,772 - INFO -   Weight decay: 0.1
2025-11-03 09:39:04,772 - INFO -   Log interval: 5 steps
2025-11-03 09:39:04,772 - INFO -   Validation interval: 20 steps
2025-11-03 09:39:04,772 - INFO -   Save interval: 100 steps
2025-11-03 09:39:04,773 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 09:39:09,915 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 09:39:09,916 - INFO - 
================================================================================
2025-11-03 09:39:09,916 - INFO - STEP-BASED TRAINING
2025-11-03 09:39:09,916 - INFO -   Starting from step: 0
2025-11-03 09:39:09,916 - INFO -   Target steps: 100
2025-11-03 09:39:09,916 - INFO -   Batch size: 128
2025-11-03 09:39:09,916 - INFO -   Gradient accumulation steps: 4
2025-11-03 09:39:09,916 - INFO -   Effective batch size: 512
2025-11-03 09:39:09,916 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 09:39:09,916 - INFO - ================================================================================
2025-11-03 09:39:09,916 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 09:39:09,916 - INFO - 
üöÄ Starting training loop...
2025-11-03 09:39:09,916 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 09:39:09,916 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:39:29,643 - INFO -      [0] ‚úì Batch fetched in 19.727s
2025-11-03 09:39:29,643 - INFO -      [0] Moving data to device cuda...
2025-11-03 09:39:29,646 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:39:33,577 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 3.930s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:39:33,577 - INFO -      [0] Starting forward pass...
2025-11-03 09:39:57,181 - INFO -      [0] ‚úì Forward pass completed in 23.604s, loss = 289.2241 (accum_step 1/4)
2025-11-03 09:39:57,181 - INFO -      [0] Starting backward pass...
2025-11-03 09:40:03,859 - INFO -      [0] ‚úì Backward pass completed in 6.677s
2025-11-03 09:40:03,877 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:40:03,878 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 09:40:03,878 - INFO -      [0] Moving data to device cuda...
2025-11-03 09:40:03,884 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:40:03,885 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:40:03,885 - INFO -      [0] Starting forward pass...
2025-11-03 09:40:04,097 - INFO -      [0] ‚úì Forward pass completed in 0.028s, loss = 291.5531 (accum_step 2/4)
2025-11-03 09:40:04,097 - INFO -      [0] Starting backward pass...
2025-11-03 09:40:04,112 - INFO -      [0] ‚úì Backward pass completed in 0.015s
2025-11-03 09:40:04,357 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:40:04,357 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 09:40:04,357 - INFO -      [0] Moving data to device cuda...
2025-11-03 09:40:04,361 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:40:04,361 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:40:04,361 - INFO -      [0] Starting forward pass...
2025-11-03 09:40:04,573 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 292.2119 (accum_step 3/4)
2025-11-03 09:40:04,574 - INFO -      [0] Starting backward pass...
2025-11-03 09:40:04,584 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 09:40:04,833 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:40:04,833 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 09:40:04,833 - INFO -      [0] Moving data to device cuda...
2025-11-03 09:40:04,835 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:40:04,835 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:40:04,835 - INFO -      [0] Starting forward pass...
2025-11-03 09:40:05,048 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 289.9882 (accum_step 4/4)
2025-11-03 09:40:05,048 - INFO -      [0] Starting backward pass...
2025-11-03 09:40:05,058 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 09:40:05,307 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 09:52:08,639 - INFO - ================================================================================
2025-11-03 09:52:08,640 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 09:52:08,640 - INFO - ================================================================================
2025-11-03 09:52:08,640 - INFO - Configuration: A100_pretraining_test
2025-11-03 09:52:08,640 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 09:52:08,640 - INFO - ================================================================================
2025-11-03 09:52:08,644 - INFO - Device: cuda
2025-11-03 09:52:08,645 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 09:52:08,645 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 09:52:08,645 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 09:52:08,645 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=False
2025-11-03 09:52:08,645 - INFO -   Batch size: 128, Steps: 100
2025-11-03 09:52:08,645 - INFO -   Validation interval: 20 steps
2025-11-03 09:52:08,645 - INFO -   Log interval: 5 steps
2025-11-03 09:52:08,645 - INFO - 
Initializing model...
2025-11-03 09:52:09,345 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 09:52:09,346 - INFO -   Total parameters: 44,674,663
2025-11-03 09:52:09,346 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 09:52:20,672 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 09:52:20,672 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 09:52:20,681 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 09:52:20,681 - INFO - 
Setting up datasets...
2025-11-03 09:52:20,681 - INFO -   Loading MAESTRO dataset...
2025-11-03 09:52:30,496 - INFO -   ‚úì MAESTRO train: 200 samples (cached)
2025-11-03 09:52:30,498 - INFO -   ‚úì MAESTRO val: 137 samples (cached)
2025-11-03 09:52:30,498 - INFO -   Loading SLAKH stems dataset...
2025-11-03 09:52:40,294 - INFO -   ‚úì SLAKH stems train: 521 samples (cached)
2025-11-03 09:53:23,361 - INFO -   ‚úì SLAKH stems val: 2833 samples (cached)
2025-11-03 09:53:23,361 - INFO -   Loading SLAKH mix dataset...
2025-11-03 09:53:25,075 - INFO -   ‚úì SLAKH mix train: 50 samples (cached)
2025-11-03 09:53:25,124 - INFO -   ‚úì SLAKH mix val: 270 samples (cached)
2025-11-03 09:53:25,124 - INFO - 
  Creating multi-task dataset...
2025-11-03 09:53:25,124 - INFO -   ‚úì Multi-task dataset: 771 total samples
2025-11-03 09:53:25,124 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0}
2025-11-03 09:53:25,124 - INFO - 
  Setting up validation data...
2025-11-03 09:53:25,124 - INFO -   ‚úì Validation: 3240 samples
2025-11-03 09:53:25,126 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 09:53:25,126 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 09:53:25,126 - INFO -   Label smoothing: 0.1
2025-11-03 09:53:25,126 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 09:53:25,126 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 09:53:25,126 - INFO - 
Starting training...
2025-11-03 09:53:25,126 - INFO -   Total steps: 100
2025-11-03 09:53:25,126 - INFO -   Batch size: 128
2025-11-03 09:53:25,126 - INFO -   Learning rate: 0.0001
2025-11-03 09:53:25,126 - INFO -   Weight decay: 0.1
2025-11-03 09:53:25,127 - INFO -   Log interval: 5 steps
2025-11-03 09:53:25,127 - INFO -   Validation interval: 20 steps
2025-11-03 09:53:25,127 - INFO -   Save interval: 100 steps
2025-11-03 09:53:25,127 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 09:53:25,185 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 09:53:25,185 - INFO - 
================================================================================
2025-11-03 09:53:25,185 - INFO - STEP-BASED TRAINING
2025-11-03 09:53:25,185 - INFO -   Starting from step: 0
2025-11-03 09:53:25,186 - INFO -   Target steps: 100
2025-11-03 09:53:25,186 - INFO -   Batch size: 128
2025-11-03 09:53:25,186 - INFO -   Gradient accumulation steps: 4
2025-11-03 09:53:25,186 - INFO -   Effective batch size: 512
2025-11-03 09:53:25,186 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 09:53:25,186 - INFO - ================================================================================
2025-11-03 09:53:25,186 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 09:53:25,186 - INFO - 
üöÄ Starting training loop...
2025-11-03 09:53:25,186 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 09:53:25,186 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:53:27,619 - INFO -      [0] ‚úì Batch fetched in 2.433s
2025-11-03 09:53:27,620 - INFO -      [0] Moving data to device cuda...
2025-11-03 09:53:27,626 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:53:27,943 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.317s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:53:27,943 - INFO -      [0] Starting forward pass...
2025-11-03 09:53:30,567 - INFO -      [0] ‚úì Forward pass completed in 2.624s, loss = 291.1241 (accum_step 1/4)
2025-11-03 09:53:30,567 - INFO -      [0] Starting backward pass...
2025-11-03 09:53:30,884 - INFO -      [0] ‚úì Backward pass completed in 0.317s
2025-11-03 09:53:30,905 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:53:30,905 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 09:53:30,905 - INFO -      [0] Moving data to device cuda...
2025-11-03 09:53:30,908 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:53:30,909 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:53:30,909 - INFO -      [0] Starting forward pass...
2025-11-03 09:53:31,121 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 293.0616 (accum_step 2/4)
2025-11-03 09:53:31,122 - INFO -      [0] Starting backward pass...
2025-11-03 09:53:31,136 - INFO -      [0] ‚úì Backward pass completed in 0.015s
2025-11-03 09:53:31,381 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:53:31,381 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 09:53:31,381 - INFO -      [0] Moving data to device cuda...
2025-11-03 09:53:31,382 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:53:31,382 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:53:31,383 - INFO -      [0] Starting forward pass...
2025-11-03 09:53:31,595 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 293.0715 (accum_step 3/4)
2025-11-03 09:53:31,595 - INFO -      [0] Starting backward pass...
2025-11-03 09:53:31,606 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 09:53:31,854 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:53:31,854 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 09:53:31,854 - INFO -      [0] Moving data to device cuda...
2025-11-03 09:53:31,860 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:53:31,861 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:53:31,861 - INFO -      [0] Starting forward pass...
2025-11-03 09:53:32,073 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 290.8759 (accum_step 4/4)
2025-11-03 09:53:32,074 - INFO -      [0] Starting backward pass...
2025-11-03 09:53:32,084 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 09:53:32,333 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 09:53:32,471 - INFO -      [0] ‚úì Optimizer step completed in 0.138s, grad_norm = 323.8850
2025-11-03 09:53:32,472 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:53:32,472 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 09:53:32,472 - INFO -      [1] Moving data to device cuda...
2025-11-03 09:53:32,475 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:53:32,476 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:53:32,476 - INFO -      [1] Starting forward pass...
2025-11-03 09:53:32,690 - INFO -      [1] ‚úì Forward pass completed in 0.039s, loss = 289.7847 (accum_step 1/4)
2025-11-03 09:53:32,690 - INFO -      [1] Starting backward pass...
2025-11-03 09:53:32,706 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 09:53:32,957 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:53:32,957 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 09:53:32,957 - INFO -      [1] Moving data to device cuda...
2025-11-03 09:53:32,968 - INFO -      [1] ‚úì Data moved to device in 0.011s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:53:32,969 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:53:32,969 - INFO -      [1] Starting forward pass...
2025-11-03 09:53:33,182 - INFO -      [1] ‚úì Forward pass completed in 0.012s, loss = 290.7373 (accum_step 2/4)
2025-11-03 09:53:33,182 - INFO -      [1] Starting backward pass...
2025-11-03 09:53:33,199 - INFO -      [1] ‚úì Backward pass completed in 0.017s
2025-11-03 09:53:33,443 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:53:33,443 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 09:53:33,443 - INFO -      [1] Moving data to device cuda...
2025-11-03 09:53:33,443 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 09:53:33,445 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.002s (shape: torch.Size([3, 256, 512]))
2025-11-03 09:53:33,445 - INFO -      [1] Starting forward pass...
2025-11-03 09:54:12,274 - INFO -      [1] ‚úì Forward pass completed in 38.830s, loss = 296.0802 (accum_step 3/4)
2025-11-03 09:54:12,275 - INFO -      [1] Starting backward pass...
2025-11-03 09:54:12,565 - INFO -      [1] ‚úì Backward pass completed in 0.290s
2025-11-03 09:54:12,565 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:14,070 - INFO -      [1] ‚úì Batch fetched in 1.505s
2025-11-03 09:54:14,071 - INFO -      [1] Moving data to device cuda...
2025-11-03 09:54:14,075 - INFO -      [1] ‚úì Data moved to device in 0.004s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:54:14,079 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.003s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:54:14,079 - INFO -      [1] Starting forward pass...
2025-11-03 09:54:14,307 - INFO -      [1] ‚úì Forward pass completed in 0.008s, loss = 288.2699 (accum_step 4/4)
2025-11-03 09:54:14,307 - INFO -      [1] Starting backward pass...
2025-11-03 09:54:14,320 - INFO -      [1] ‚úì Backward pass completed in 0.013s
2025-11-03 09:54:14,587 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 09:54:14,599 - INFO -      [1] ‚úì Optimizer step completed in 0.012s, grad_norm = 327.2298
2025-11-03 09:54:14,599 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:14,599 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:14,599 - INFO -      [2] Moving data to device cuda...
2025-11-03 09:54:14,600 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:54:14,601 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:54:14,601 - INFO -      [2] Starting forward pass...
2025-11-03 09:54:14,814 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.1778 (accum_step 1/4)
2025-11-03 09:54:14,814 - INFO -      [2] Starting backward pass...
2025-11-03 09:54:14,826 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 09:54:15,093 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:15,093 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:15,093 - INFO -      [2] Moving data to device cuda...
2025-11-03 09:54:15,096 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:54:15,097 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:54:15,097 - INFO -      [2] Starting forward pass...
2025-11-03 09:54:15,310 - INFO -      [2] ‚úì Forward pass completed in 0.009s, loss = 288.3394 (accum_step 2/4)
2025-11-03 09:54:15,310 - INFO -      [2] Starting backward pass...
2025-11-03 09:54:15,321 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 09:54:15,590 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:15,590 - INFO -      [2] ‚úì Batch fetched in 0.001s
2025-11-03 09:54:15,590 - INFO -      [2] Moving data to device cuda...
2025-11-03 09:54:15,596 - INFO -      [2] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:54:15,598 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:54:15,598 - INFO -      [2] Starting forward pass...
2025-11-03 09:54:15,810 - INFO -      [2] ‚úì Forward pass completed in 0.014s, loss = 288.1929 (accum_step 3/4)
2025-11-03 09:54:15,810 - INFO -      [2] Starting backward pass...
2025-11-03 09:54:15,822 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 09:54:16,090 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:16,090 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:16,090 - INFO -      [2] Moving data to device cuda...
2025-11-03 09:54:16,095 - INFO -      [2] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:54:16,096 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:54:16,096 - INFO -      [2] Starting forward pass...
2025-11-03 09:54:16,308 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 291.7756 (accum_step 4/4)
2025-11-03 09:54:16,308 - INFO -      [2] Starting backward pass...
2025-11-03 09:54:16,320 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 09:54:16,588 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 09:54:16,597 - INFO -      [2] ‚úì Optimizer step completed in 0.009s, grad_norm = 327.2442
2025-11-03 09:54:16,598 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:16,598 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:16,811 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 286.3653 (accum_step 1/4)
2025-11-03 09:54:17,090 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:17,091 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:17,101 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 292.0160 (accum_step 2/4)
2025-11-03 09:54:17,115 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:18,886 - INFO -      [3] ‚úì Batch fetched in 1.771s
2025-11-03 09:54:19,125 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 284.7545 (accum_step 3/4)
2025-11-03 09:54:19,407 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:19,408 - INFO -      [3] ‚úì Batch fetched in 0.001s
2025-11-03 09:54:19,627 - INFO -      [3] ‚úì Forward pass completed in 0.011s, loss = 286.8998 (accum_step 4/4)
2025-11-03 09:54:19,919 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:19,919 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:20,138 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 279.0454 (accum_step 1/4)
2025-11-03 09:54:20,417 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:20,418 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:20,631 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 279.6483 (accum_step 2/4)
2025-11-03 09:54:20,912 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:20,912 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:21,131 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 280.6209 (accum_step 3/4)
2025-11-03 09:54:21,411 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:21,411 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:21,630 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 281.8136 (accum_step 4/4)
2025-11-03 09:54:21,918 - INFO -   Step 5/100: loss = 280.2821, avg_loss = 288.0327, lr = 0.000011, grad_norm = 331.7499
2025-11-03 09:54:21,918 - INFO -     ‚è±Ô∏è  Timing: total=1.999s (fetch=0.001s, to_device=0.018s, spec_compute=0.002s, forward=0.025s, backward=0.042s, optim=0.008s)
2025-11-03 09:54:21,918 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:21,918 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:21,929 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 285.3744 (accum_step 1/4)
2025-11-03 09:54:21,941 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:23,604 - INFO -      [5] ‚úì Batch fetched in 1.663s
2025-11-03 09:54:23,824 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 272.3882 (accum_step 2/4)
2025-11-03 09:54:24,103 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:24,103 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:24,321 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 267.7394 (accum_step 3/4)
2025-11-03 09:54:24,601 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:24,601 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:24,815 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 271.6115 (accum_step 4/4)
2025-11-03 09:54:25,103 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:25,103 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:25,319 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.7928 (accum_step 1/4)
2025-11-03 09:54:25,598 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:25,598 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:25,816 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.7070 (accum_step 2/4)
2025-11-03 09:54:26,095 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:26,095 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:26,312 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.3292 (accum_step 3/4)
2025-11-03 09:54:26,591 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:26,591 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:26,601 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 274.5590 (accum_step 4/4)
2025-11-03 09:54:26,622 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:28,398 - INFO -      [7] ‚úì Batch fetched in 1.775s
2025-11-03 09:54:28,626 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 252.8149 (accum_step 1/4)
2025-11-03 09:54:28,905 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:28,906 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:29,119 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 253.2110 (accum_step 2/4)
2025-11-03 09:54:29,398 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:29,399 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:29,616 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.0072 (accum_step 3/4)
2025-11-03 09:54:29,895 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:29,895 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:30,112 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.7379 (accum_step 4/4)
2025-11-03 09:54:30,400 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:30,400 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:30,616 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 240.2992 (accum_step 1/4)
2025-11-03 09:54:30,895 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:30,896 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:31,110 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.2614 (accum_step 2/4)
2025-11-03 09:54:31,389 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:31,389 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:31,400 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 234.9919 (accum_step 3/4)
2025-11-03 09:54:31,413 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:33,114 - INFO -      [8] ‚úì Batch fetched in 1.701s
2025-11-03 09:54:33,347 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 236.0595 (accum_step 4/4)
2025-11-03 09:54:33,643 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:33,644 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:33,863 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 224.6679 (accum_step 1/4)
2025-11-03 09:54:34,142 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:34,143 - INFO -      [9] ‚úì Batch fetched in 0.001s
2025-11-03 09:54:34,362 - INFO -      [9] ‚úì Forward pass completed in 0.008s, loss = 226.2681 (accum_step 2/4)
2025-11-03 09:54:34,641 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:34,642 - INFO -      [9] ‚úì Batch fetched in 0.001s
2025-11-03 09:54:34,861 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.2915 (accum_step 3/4)
2025-11-03 09:54:35,140 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:35,140 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:35,354 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 225.2048 (accum_step 4/4)
2025-11-03 09:54:35,645 - INFO -   Step 10/100: loss = 225.6081, avg_loss = 269.4493, lr = 0.000021, grad_norm = 277.8607
2025-11-03 09:54:35,645 - INFO -     ‚è±Ô∏è  Timing: total=2.002s (fetch=0.002s, to_device=0.018s, spec_compute=0.003s, forward=0.029s, backward=0.049s, optim=0.011s)
2025-11-03 09:54:35,645 - INFO -      [10] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:35,646 - INFO -      [10] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:35,646 - INFO -      [10] Moving data to device cuda...
2025-11-03 09:54:35,647 - INFO -      [10] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:54:35,648 - INFO -      [10] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:54:35,648 - INFO -      [10] Starting forward pass...
2025-11-03 09:54:35,860 - INFO -      [10] ‚úì Forward pass completed in 0.007s, loss = 213.2173 (accum_step 1/4)
2025-11-03 09:54:35,861 - INFO -      [10] Starting backward pass...
2025-11-03 09:54:35,871 - INFO -      [10] ‚úì Backward pass completed in 0.010s
2025-11-03 09:54:36,139 - INFO -      [10] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:36,139 - INFO -      [10] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:36,139 - INFO -      [10] Moving data to device cuda...
2025-11-03 09:54:36,140 - INFO -      [10] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 09:54:36,141 - INFO -      [10] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([3, 256, 512]))
2025-11-03 09:54:36,141 - INFO -      [10] Starting forward pass...
2025-11-03 09:54:36,150 - INFO -      [10] ‚úì Forward pass completed in 0.007s, loss = 223.9128 (accum_step 2/4)
2025-11-03 09:54:36,150 - INFO -      [10] Starting backward pass...
2025-11-03 09:54:36,161 - INFO -      [10] ‚úì Backward pass completed in 0.011s
2025-11-03 09:54:36,164 - INFO -      [10] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:37,801 - INFO -      [10] ‚úì Batch fetched in 1.637s
2025-11-03 09:54:37,801 - INFO -      [10] Moving data to device cuda...
2025-11-03 09:54:37,807 - INFO -      [10] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:54:37,808 - INFO -      [10] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:54:37,808 - INFO -      [10] Starting forward pass...
2025-11-03 09:54:38,021 - INFO -      [10] ‚úì Forward pass completed in 0.007s, loss = 214.8940 (accum_step 3/4)
2025-11-03 09:54:38,021 - INFO -      [10] Starting backward pass...
2025-11-03 09:54:38,033 - INFO -      [10] ‚úì Backward pass completed in 0.011s
2025-11-03 09:54:38,301 - INFO -      [10] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:38,302 - INFO -      [10] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:38,302 - INFO -      [10] Moving data to device cuda...
2025-11-03 09:54:38,307 - INFO -      [10] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:54:38,309 - INFO -      [10] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:54:38,309 - INFO -      [10] Starting forward pass...
2025-11-03 09:54:38,521 - INFO -      [10] ‚úì Forward pass completed in 0.015s, loss = 209.9974 (accum_step 4/4)
2025-11-03 09:54:38,521 - INFO -      [10] Starting backward pass...
2025-11-03 09:54:38,534 - INFO -      [10] ‚úì Backward pass completed in 0.013s
2025-11-03 09:54:38,800 - INFO -      [10] Gradient clipping and optimizer step...
2025-11-03 09:54:38,811 - INFO -      [10] ‚úì Optimizer step completed in 0.011s, grad_norm = 260.8149
2025-11-03 09:54:38,811 - INFO -      [11] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:38,811 - INFO -      [11] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:39,030 - INFO -      [11] ‚úì Forward pass completed in 0.007s, loss = 198.3969 (accum_step 1/4)
2025-11-03 09:54:39,310 - INFO -      [11] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:39,310 - INFO -      [11] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:39,530 - INFO -      [11] ‚úì Forward pass completed in 0.008s, loss = 200.1948 (accum_step 2/4)
2025-11-03 09:54:39,810 - INFO -      [11] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:39,811 - INFO -      [11] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:40,026 - INFO -      [11] ‚úì Forward pass completed in 0.007s, loss = 197.6421 (accum_step 3/4)
2025-11-03 09:54:40,305 - INFO -      [11] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:40,305 - INFO -      [11] ‚úì Batch fetched in 0.001s
2025-11-03 09:54:40,520 - INFO -      [11] ‚úì Forward pass completed in 0.007s, loss = 199.8975 (accum_step 4/4)
2025-11-03 09:54:40,808 - INFO -      [12] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:40,808 - INFO -      [12] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:40,819 - INFO -      [12] ‚úì Forward pass completed in 0.006s, loss = 189.0264 (accum_step 1/4)
2025-11-03 09:54:40,832 - INFO -      [12] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:42,116 - INFO -      [12] ‚úì Batch fetched in 1.284s
2025-11-03 09:54:42,335 - INFO -      [12] ‚úì Forward pass completed in 0.007s, loss = 184.7466 (accum_step 2/4)
2025-11-03 09:54:42,615 - INFO -      [12] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:42,615 - INFO -      [12] ‚úì Batch fetched in 0.001s
2025-11-03 09:54:42,834 - INFO -      [12] ‚úì Forward pass completed in 0.007s, loss = 184.2968 (accum_step 3/4)
2025-11-03 09:54:43,114 - INFO -      [12] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:43,114 - INFO -      [12] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:43,333 - INFO -      [12] ‚úì Forward pass completed in 0.006s, loss = 185.8853 (accum_step 4/4)
2025-11-03 09:54:43,622 - INFO -      [13] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:43,622 - INFO -      [13] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:43,838 - INFO -      [13] ‚úì Forward pass completed in 0.007s, loss = 171.1863 (accum_step 1/4)
2025-11-03 09:54:44,117 - INFO -      [13] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:44,117 - INFO -      [13] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:44,331 - INFO -      [13] ‚úì Forward pass completed in 0.006s, loss = 174.2446 (accum_step 2/4)
2025-11-03 09:54:44,610 - INFO -      [13] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:44,611 - INFO -      [13] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:44,825 - INFO -      [13] ‚úì Forward pass completed in 0.006s, loss = 173.0579 (accum_step 3/4)
2025-11-03 09:54:45,104 - INFO -      [13] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:45,105 - INFO -      [13] ‚úì Batch fetched in 0.001s
2025-11-03 09:54:45,115 - INFO -      [13] ‚úì Forward pass completed in 0.006s, loss = 178.9718 (accum_step 4/4)
2025-11-03 09:54:45,137 - INFO -      [14] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:46,979 - INFO -      [14] ‚úì Batch fetched in 1.842s
2025-11-03 09:54:47,214 - INFO -      [14] ‚úì Forward pass completed in 0.007s, loss = 160.1933 (accum_step 1/4)
2025-11-03 09:54:47,499 - INFO -      [14] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:47,499 - INFO -      [14] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:47,718 - INFO -      [14] ‚úì Forward pass completed in 0.006s, loss = 159.8420 (accum_step 2/4)
2025-11-03 09:54:47,997 - INFO -      [14] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:47,997 - INFO -      [14] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:48,215 - INFO -      [14] ‚úì Forward pass completed in 0.006s, loss = 158.7456 (accum_step 3/4)
2025-11-03 09:54:48,494 - INFO -      [14] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:48,494 - INFO -      [14] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:48,711 - INFO -      [14] ‚úì Forward pass completed in 0.006s, loss = 158.7767 (accum_step 4/4)
2025-11-03 09:54:48,998 - INFO -   Step 15/100: loss = 159.3894, avg_loss = 241.9183, lr = 0.000031, grad_norm = 163.0663
2025-11-03 09:54:48,999 - INFO -     ‚è±Ô∏è  Timing: total=3.861s (fetch=1.843s, to_device=0.020s, spec_compute=0.002s, forward=0.025s, backward=0.041s, optim=0.009s)
2025-11-03 09:54:48,999 - INFO -      [15] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:48,999 - INFO -      [15] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:49,215 - INFO -      [15] ‚úì Forward pass completed in 0.006s, loss = 147.4373 (accum_step 1/4)
2025-11-03 09:54:49,494 - INFO -      [15] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:49,494 - INFO -      [15] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:49,712 - INFO -      [15] ‚úì Forward pass completed in 0.006s, loss = 149.2285 (accum_step 2/4)
2025-11-03 09:54:49,991 - INFO -      [15] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:49,991 - INFO -      [15] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:50,001 - INFO -      [15] ‚úì Forward pass completed in 0.006s, loss = 138.8109 (accum_step 3/4)
2025-11-03 09:54:50,015 - INFO -      [15] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:51,920 - INFO -      [15] ‚úì Batch fetched in 1.906s
2025-11-03 09:54:52,154 - INFO -      [15] ‚úì Forward pass completed in 0.007s, loss = 149.4253 (accum_step 4/4)
2025-11-03 09:54:52,443 - INFO -      [16] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:52,443 - INFO -      [16] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:52,661 - INFO -      [16] ‚úì Forward pass completed in 0.006s, loss = 135.6256 (accum_step 1/4)
2025-11-03 09:54:52,940 - INFO -      [16] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:52,940 - INFO -      [16] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:53,157 - INFO -      [16] ‚úì Forward pass completed in 0.006s, loss = 138.0189 (accum_step 2/4)
2025-11-03 09:54:53,436 - INFO -      [16] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:53,436 - INFO -      [16] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:53,651 - INFO -      [16] ‚úì Forward pass completed in 0.006s, loss = 136.4088 (accum_step 3/4)
2025-11-03 09:54:53,930 - INFO -      [16] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:53,930 - INFO -      [16] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:54,144 - INFO -      [16] ‚úì Forward pass completed in 0.006s, loss = 137.1536 (accum_step 4/4)
2025-11-03 09:54:54,432 - INFO -      [17] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:54,432 - INFO -      [17] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:54,650 - INFO -      [17] ‚úì Forward pass completed in 0.006s, loss = 128.9636 (accum_step 1/4)
2025-11-03 09:54:54,929 - INFO -      [17] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:54,929 - INFO -      [17] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:54,940 - INFO -      [17] ‚úì Forward pass completed in 0.006s, loss = 126.1122 (accum_step 2/4)
2025-11-03 09:54:54,953 - INFO -      [17] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:56,186 - INFO -      [17] ‚úì Batch fetched in 1.233s
2025-11-03 09:54:56,406 - INFO -      [17] ‚úì Forward pass completed in 0.007s, loss = 127.4081 (accum_step 3/4)
2025-11-03 09:54:56,685 - INFO -      [17] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:57,079 - INFO -      [17] ‚úì Batch fetched in 0.394s
2025-11-03 09:54:57,298 - INFO -      [17] ‚úì Forward pass completed in 0.006s, loss = 129.7769 (accum_step 4/4)
2025-11-03 09:54:57,585 - INFO -      [18] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:57,585 - INFO -      [18] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:57,799 - INFO -      [18] ‚úì Forward pass completed in 0.006s, loss = 117.2543 (accum_step 1/4)
2025-11-03 09:54:58,078 - INFO -      [18] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:54:58,078 - INFO -      [18] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:58,297 - INFO -      [18] ‚úì Forward pass completed in 0.006s, loss = 118.4248 (accum_step 2/4)
2025-11-03 09:54:58,576 - INFO -      [18] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:54:58,576 - INFO -      [18] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:58,793 - INFO -      [18] ‚úì Forward pass completed in 0.006s, loss = 119.2678 (accum_step 3/4)
2025-11-03 09:54:59,073 - INFO -      [18] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:54:59,073 - INFO -      [18] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:59,292 - INFO -      [18] ‚úì Forward pass completed in 0.006s, loss = 118.9903 (accum_step 4/4)
2025-11-03 09:54:59,579 - INFO -      [19] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:54:59,579 - INFO -      [19] ‚úì Batch fetched in 0.000s
2025-11-03 09:54:59,590 - INFO -      [19] ‚úì Forward pass completed in 0.006s, loss = 114.0925 (accum_step 1/4)
2025-11-03 09:54:59,602 - INFO -      [19] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:55:01,240 - INFO -      [19] ‚úì Batch fetched in 1.638s
2025-11-03 09:55:01,460 - INFO -      [19] ‚úì Forward pass completed in 0.007s, loss = 110.2060 (accum_step 2/4)
2025-11-03 09:55:01,740 - INFO -      [19] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:55:01,740 - INFO -      [19] ‚úì Batch fetched in 0.000s
2025-11-03 09:55:01,954 - INFO -      [19] ‚úì Forward pass completed in 0.006s, loss = 110.6386 (accum_step 3/4)
2025-11-03 09:55:02,234 - INFO -      [19] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:55:02,234 - INFO -      [19] ‚úì Batch fetched in 0.000s
2025-11-03 09:55:02,452 - INFO -      [19] ‚úì Forward pass completed in 0.006s, loss = 109.9741 (accum_step 4/4)
2025-11-03 09:55:02,741 - INFO -   Step 20/100: loss = 111.2278, avg_loss = 213.4789, lr = 0.000041, grad_norm = 84.1763
2025-11-03 09:55:02,741 - INFO -     ‚è±Ô∏è  Timing: total=3.161s (fetch=1.639s, to_device=0.012s, spec_compute=0.002s, forward=0.025s, backward=0.041s, optim=0.009s)
2025-11-03 09:55:02,741 - INFO - 
  üîç Starting validation at step 20...
2025-11-03 09:55:02,741 - INFO -      Applying EMA weights for validation...
2025-11-03 09:55:02,762 - INFO -      Running validation...
2025-11-03 09:55:41,248 - INFO -        Validation batch 1/None: loss = 300.4236
2025-11-03 09:55:41,544 - INFO -        Validation batch 2/None: loss = 303.0466
2025-11-03 09:55:41,834 - INFO -        Validation batch 3/None: loss = 299.7989
2025-11-03 09:55:46,379 - INFO -        Validation batch 5/None: loss = 300.3060
2025-11-03 09:55:58,219 - INFO -        Validation batch 10/None: loss = 303.1576
2025-11-03 09:56:07,571 - INFO -        Validation batch 15/None: loss = 303.3412
2025-11-03 09:56:12,698 - INFO -        Validation batch 20/None: loss = 305.4754
2025-11-03 09:56:17,991 - INFO -        Validation batch 25/None: loss = 300.4352
2025-11-03 09:56:18,187 - INFO -      ‚úì Validation complete: avg_loss = 302.5420 (26 batches)
2025-11-03 09:56:18,188 - INFO -      Restoring training weights...
2025-11-03 09:56:18,191 - INFO -   ‚úì Validation completed in 75.45s
2025-11-03 09:56:18,191 - INFO -      üéØ New best validation loss: 302.5420 (previous: inf)
2025-11-03 09:56:18,192 - INFO -      Saving best model checkpoint...
2025-11-03 09:56:18,446 - INFO -   ‚úì Saved best model to /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint/best_A100_pretraining_test_model.pt (async)
2025-11-03 09:56:18,456 - INFO -      [20] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:18,520 - INFO -      [20] ‚úì Batch fetched in 0.063s
2025-11-03 09:56:18,523 - INFO -      [20] Moving data to device cuda...
2025-11-03 09:56:18,529 - INFO -      [20] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:56:18,530 - INFO -      [20] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:56:18,530 - INFO -      [20] Starting forward pass...
2025-11-03 09:56:18,787 - INFO -      [20] ‚úì Forward pass completed in 0.257s, loss = 102.2504 (accum_step 1/4)
2025-11-03 09:56:18,787 - INFO -      [20] Starting backward pass...
2025-11-03 09:56:19,157 - INFO -      [20] ‚úì Backward pass completed in 0.369s
2025-11-03 09:56:19,157 - INFO -      [20] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:19,157 - INFO -      [20] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:19,158 - INFO -      [20] Moving data to device cuda...
2025-11-03 09:56:19,159 - INFO -      [20] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:56:19,160 - INFO -      [20] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:56:19,245 - INFO -      [20] Starting forward pass...
2025-11-03 09:56:19,377 - INFO -      [20] ‚úì Forward pass completed in 0.077s, loss = 100.3869 (accum_step 2/4)
2025-11-03 09:56:19,378 - INFO -      [20] Starting backward pass...
2025-11-03 09:56:19,665 - INFO -      [20] ‚úì Backward pass completed in 0.287s
2025-11-03 09:56:19,665 - INFO -      [20] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:19,665 - INFO -      [20] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:19,665 - INFO -      [20] Moving data to device cuda...
2025-11-03 09:56:19,671 - INFO -      [20] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:56:19,672 - INFO -      [20] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:56:19,672 - INFO -      [20] Starting forward pass...
2025-11-03 09:56:19,887 - INFO -      [20] ‚úì Forward pass completed in 0.213s, loss = 101.6749 (accum_step 3/4)
2025-11-03 09:56:19,887 - INFO -      [20] Starting backward pass...
2025-11-03 09:56:20,172 - INFO -      [20] ‚úì Backward pass completed in 0.284s
2025-11-03 09:56:20,172 - INFO -      [20] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:20,173 - INFO -      [20] ‚úì Batch fetched in 0.001s
2025-11-03 09:56:20,173 - INFO -      [20] Moving data to device cuda...
2025-11-03 09:56:20,173 - INFO -      [20] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 09:56:20,174 - INFO -      [20] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([3, 256, 512]))
2025-11-03 09:56:20,178 - INFO -      [20] Starting forward pass...
2025-11-03 09:56:20,191 - INFO -      [20] ‚úì Forward pass completed in 0.012s, loss = 103.8632 (accum_step 4/4)
2025-11-03 09:56:20,191 - INFO -      [20] Starting backward pass...
2025-11-03 09:56:20,212 - INFO -      [20] ‚úì Backward pass completed in 0.021s
2025-11-03 09:56:20,212 - INFO -      [20] Gradient clipping and optimizer step...
2025-11-03 09:56:20,297 - INFO -      [20] ‚úì Optimizer step completed in 0.085s, grad_norm = 73.0589
2025-11-03 09:56:20,297 - INFO -      [21] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:21,994 - INFO -      [21] ‚úì Batch fetched in 1.697s
2025-11-03 09:56:22,230 - INFO -      [21] ‚úì Forward pass completed in 0.009s, loss = 95.8029 (accum_step 1/4)
2025-11-03 09:56:22,509 - INFO -      [21] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:22,510 - INFO -      [21] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:22,727 - INFO -      [21] ‚úì Forward pass completed in 0.007s, loss = 95.6483 (accum_step 2/4)
2025-11-03 09:56:23,007 - INFO -      [21] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:23,007 - INFO -      [21] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:23,226 - INFO -      [21] ‚úì Forward pass completed in 0.007s, loss = 95.5056 (accum_step 3/4)
2025-11-03 09:56:23,505 - INFO -      [21] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:23,505 - INFO -      [21] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:23,719 - INFO -      [21] ‚úì Forward pass completed in 0.006s, loss = 94.7825 (accum_step 4/4)
2025-11-03 09:56:24,008 - INFO -      [22] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:24,008 - INFO -      [22] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:24,226 - INFO -      [22] ‚úì Forward pass completed in 0.006s, loss = 89.9022 (accum_step 1/4)
2025-11-03 09:56:24,505 - INFO -      [22] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:24,505 - INFO -      [22] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:24,722 - INFO -      [22] ‚úì Forward pass completed in 0.006s, loss = 91.0279 (accum_step 2/4)
2025-11-03 09:56:25,001 - INFO -      [22] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:25,001 - INFO -      [22] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:25,012 - INFO -      [22] ‚úì Forward pass completed in 0.006s, loss = 91.4655 (accum_step 3/4)
2025-11-03 09:56:25,026 - INFO -      [22] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:27,065 - INFO -      [22] ‚úì Batch fetched in 2.039s
2025-11-03 09:56:27,284 - INFO -      [22] ‚úì Forward pass completed in 0.008s, loss = 90.1969 (accum_step 4/4)
2025-11-03 09:56:27,574 - INFO -      [23] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:27,574 - INFO -      [23] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:27,792 - INFO -      [23] ‚úì Forward pass completed in 0.006s, loss = 83.6021 (accum_step 1/4)
2025-11-03 09:56:28,070 - INFO -      [23] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:28,070 - INFO -      [23] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:28,284 - INFO -      [23] ‚úì Forward pass completed in 0.006s, loss = 84.1347 (accum_step 2/4)
2025-11-03 09:56:28,565 - INFO -      [23] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:28,566 - INFO -      [23] ‚úì Batch fetched in 0.001s
2025-11-03 09:56:28,784 - INFO -      [23] ‚úì Forward pass completed in 0.008s, loss = 84.8431 (accum_step 3/4)
2025-11-03 09:56:29,064 - INFO -      [23] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:29,065 - INFO -      [23] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:29,281 - INFO -      [23] ‚úì Forward pass completed in 0.006s, loss = 84.7492 (accum_step 4/4)
2025-11-03 09:56:29,570 - INFO -      [24] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:29,571 - INFO -      [24] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:29,784 - INFO -      [24] ‚úì Forward pass completed in 0.006s, loss = 79.1541 (accum_step 1/4)
2025-11-03 09:56:30,063 - INFO -      [24] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:30,063 - INFO -      [24] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:30,074 - INFO -      [24] ‚úì Forward pass completed in 0.006s, loss = 73.3511 (accum_step 2/4)
2025-11-03 09:56:30,088 - INFO -      [24] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:31,967 - INFO -      [24] ‚úì Batch fetched in 1.879s
2025-11-03 09:56:32,196 - INFO -      [24] ‚úì Forward pass completed in 0.007s, loss = 78.5255 (accum_step 3/4)
2025-11-03 09:56:32,476 - INFO -      [24] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:32,476 - INFO -      [24] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:32,693 - INFO -      [24] ‚úì Forward pass completed in 0.007s, loss = 79.4936 (accum_step 4/4)
2025-11-03 09:56:32,982 - INFO -   Step 25/100: loss = 77.6311, avg_loss = 188.7868, lr = 0.000051, grad_norm = 43.0853
2025-11-03 09:56:32,982 - INFO -     ‚è±Ô∏è  Timing: total=3.412s (fetch=1.880s, to_device=0.011s, spec_compute=0.002s, forward=0.027s, backward=0.046s, optim=0.009s)
2025-11-03 09:56:32,982 - INFO -      [25] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:32,982 - INFO -      [25] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:33,196 - INFO -      [25] ‚úì Forward pass completed in 0.006s, loss = 74.0607 (accum_step 1/4)
2025-11-03 09:56:33,475 - INFO -      [25] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:33,475 - INFO -      [25] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:33,694 - INFO -      [25] ‚úì Forward pass completed in 0.006s, loss = 75.6581 (accum_step 2/4)
2025-11-03 09:56:33,973 - INFO -      [25] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:33,973 - INFO -      [25] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:34,192 - INFO -      [25] ‚úì Forward pass completed in 0.006s, loss = 75.1319 (accum_step 3/4)
2025-11-03 09:56:34,471 - INFO -      [25] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:34,471 - INFO -      [25] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:34,685 - INFO -      [25] ‚úì Forward pass completed in 0.006s, loss = 74.9676 (accum_step 4/4)
2025-11-03 09:56:34,973 - INFO -      [26] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:34,973 - INFO -      [26] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:34,983 - INFO -      [26] ‚úì Forward pass completed in 0.006s, loss = 68.5097 (accum_step 1/4)
2025-11-03 09:56:34,996 - INFO -      [26] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:36,592 - INFO -      [26] ‚úì Batch fetched in 1.596s
2025-11-03 09:56:36,811 - INFO -      [26] ‚úì Forward pass completed in 0.007s, loss = 70.9398 (accum_step 2/4)
2025-11-03 09:56:37,092 - INFO -      [26] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:37,092 - INFO -      [26] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:37,312 - INFO -      [26] ‚úì Forward pass completed in 0.006s, loss = 70.3860 (accum_step 3/4)
2025-11-03 09:56:37,592 - INFO -      [26] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:37,592 - INFO -      [26] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:37,806 - INFO -      [26] ‚úì Forward pass completed in 0.006s, loss = 70.6001 (accum_step 4/4)
2025-11-03 09:56:38,095 - INFO -      [27] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:38,095 - INFO -      [27] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:38,313 - INFO -      [27] ‚úì Forward pass completed in 0.006s, loss = 67.5548 (accum_step 1/4)
2025-11-03 09:56:38,592 - INFO -      [27] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:38,593 - INFO -      [27] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:38,810 - INFO -      [27] ‚úì Forward pass completed in 0.006s, loss = 67.1373 (accum_step 2/4)
2025-11-03 09:56:39,089 - INFO -      [27] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:39,090 - INFO -      [27] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:39,304 - INFO -      [27] ‚úì Forward pass completed in 0.006s, loss = 67.3294 (accum_step 3/4)
2025-11-03 09:56:39,583 - INFO -      [27] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:39,584 - INFO -      [27] ‚úì Batch fetched in 0.001s
2025-11-03 09:56:39,595 - INFO -      [27] ‚úì Forward pass completed in 0.008s, loss = 70.4080 (accum_step 4/4)
2025-11-03 09:56:39,618 - INFO -      [28] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:41,821 - INFO -      [28] ‚úì Batch fetched in 2.204s
2025-11-03 09:56:42,046 - INFO -      [28] ‚úì Forward pass completed in 0.008s, loss = 63.0965 (accum_step 1/4)
2025-11-03 09:56:42,325 - INFO -      [28] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:42,325 - INFO -      [28] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:42,544 - INFO -      [28] ‚úì Forward pass completed in 0.006s, loss = 63.5885 (accum_step 2/4)
2025-11-03 09:56:42,823 - INFO -      [28] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:42,823 - INFO -      [28] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:43,041 - INFO -      [28] ‚úì Forward pass completed in 0.006s, loss = 63.1772 (accum_step 3/4)
2025-11-03 09:56:43,320 - INFO -      [28] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:43,320 - INFO -      [28] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:43,534 - INFO -      [28] ‚úì Forward pass completed in 0.006s, loss = 63.4385 (accum_step 4/4)
2025-11-03 09:56:43,822 - INFO -      [29] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:43,822 - INFO -      [29] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:44,040 - INFO -      [29] ‚úì Forward pass completed in 0.006s, loss = 60.5343 (accum_step 1/4)
2025-11-03 09:56:44,319 - INFO -      [29] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:44,319 - INFO -      [29] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:44,535 - INFO -      [29] ‚úì Forward pass completed in 0.006s, loss = 59.6970 (accum_step 2/4)
2025-11-03 09:56:44,814 - INFO -      [29] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:44,815 - INFO -      [29] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:44,825 - INFO -      [29] ‚úì Forward pass completed in 0.006s, loss = 58.9293 (accum_step 3/4)
2025-11-03 09:56:44,838 - INFO -      [29] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:46,207 - INFO -      [29] ‚úì Batch fetched in 1.369s
2025-11-03 09:56:46,426 - INFO -      [29] ‚úì Forward pass completed in 0.007s, loss = 60.7015 (accum_step 4/4)
2025-11-03 09:56:46,715 - INFO -   Step 30/100: loss = 59.9655, avg_loss = 168.5377, lr = 0.000060, grad_norm = 26.8218
2025-11-03 09:56:46,715 - INFO -     ‚è±Ô∏è  Timing: total=2.893s (fetch=1.370s, to_device=0.014s, spec_compute=0.002s, forward=0.025s, backward=0.041s, optim=0.010s)
2025-11-03 09:56:46,715 - INFO -      [30] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:46,841 - INFO -      [30] ‚úì Batch fetched in 0.126s
2025-11-03 09:56:46,842 - INFO -      [30] Moving data to device cuda...
2025-11-03 09:56:46,846 - INFO -      [30] ‚úì Data moved to device in 0.004s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:56:46,846 - INFO -      [30] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:56:46,846 - INFO -      [30] Starting forward pass...
2025-11-03 09:56:47,059 - INFO -      [30] ‚úì Forward pass completed in 0.007s, loss = 57.2146 (accum_step 1/4)
2025-11-03 09:56:47,059 - INFO -      [30] Starting backward pass...
2025-11-03 09:56:47,069 - INFO -      [30] ‚úì Backward pass completed in 0.010s
2025-11-03 09:56:47,338 - INFO -      [30] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:47,338 - INFO -      [30] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:47,338 - INFO -      [30] Moving data to device cuda...
2025-11-03 09:56:47,342 - INFO -      [30] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:56:47,342 - INFO -      [30] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:56:47,342 - INFO -      [30] Starting forward pass...
2025-11-03 09:56:47,555 - INFO -      [30] ‚úì Forward pass completed in 0.006s, loss = 57.4501 (accum_step 2/4)
2025-11-03 09:56:47,555 - INFO -      [30] Starting backward pass...
2025-11-03 09:56:47,566 - INFO -      [30] ‚úì Backward pass completed in 0.011s
2025-11-03 09:56:47,834 - INFO -      [30] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:47,834 - INFO -      [30] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:47,834 - INFO -      [30] Moving data to device cuda...
2025-11-03 09:56:47,840 - INFO -      [30] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:56:47,840 - INFO -      [30] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:56:47,840 - INFO -      [30] Starting forward pass...
2025-11-03 09:56:48,053 - INFO -      [30] ‚úì Forward pass completed in 0.006s, loss = 56.6176 (accum_step 3/4)
2025-11-03 09:56:48,053 - INFO -      [30] Starting backward pass...
2025-11-03 09:56:48,066 - INFO -      [30] ‚úì Backward pass completed in 0.013s
2025-11-03 09:56:48,333 - INFO -      [30] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:48,333 - INFO -      [30] ‚úì Batch fetched in 0.001s
2025-11-03 09:56:48,333 - INFO -      [30] Moving data to device cuda...
2025-11-03 09:56:48,339 - INFO -      [30] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:56:48,340 - INFO -      [30] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:56:48,340 - INFO -      [30] Starting forward pass...
2025-11-03 09:56:48,552 - INFO -      [30] ‚úì Forward pass completed in 0.011s, loss = 57.5345 (accum_step 4/4)
2025-11-03 09:56:48,553 - INFO -      [30] Starting backward pass...
2025-11-03 09:56:48,565 - INFO -      [30] ‚úì Backward pass completed in 0.012s
2025-11-03 09:56:48,832 - INFO -      [30] Gradient clipping and optimizer step...
2025-11-03 09:56:48,843 - INFO -      [30] ‚úì Optimizer step completed in 0.011s, grad_norm = 25.4405
2025-11-03 09:56:48,844 - INFO -      [31] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:48,844 - INFO -      [31] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:49,062 - INFO -      [31] ‚úì Forward pass completed in 0.007s, loss = 54.5700 (accum_step 1/4)
2025-11-03 09:56:49,341 - INFO -      [31] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:49,342 - INFO -      [31] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:49,352 - INFO -      [31] ‚úì Forward pass completed in 0.006s, loss = 55.1764 (accum_step 2/4)
2025-11-03 09:56:49,366 - INFO -      [31] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:51,212 - INFO -      [31] ‚úì Batch fetched in 1.846s
2025-11-03 09:56:51,446 - INFO -      [31] ‚úì Forward pass completed in 0.007s, loss = 54.5079 (accum_step 3/4)
2025-11-03 09:56:51,726 - INFO -      [31] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:51,726 - INFO -      [31] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:51,943 - INFO -      [31] ‚úì Forward pass completed in 0.007s, loss = 54.6595 (accum_step 4/4)
2025-11-03 09:56:52,231 - INFO -      [32] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:52,231 - INFO -      [32] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:52,449 - INFO -      [32] ‚úì Forward pass completed in 0.006s, loss = 52.4008 (accum_step 1/4)
2025-11-03 09:56:52,729 - INFO -      [32] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:52,729 - INFO -      [32] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:52,943 - INFO -      [32] ‚úì Forward pass completed in 0.006s, loss = 53.0738 (accum_step 2/4)
2025-11-03 09:56:53,222 - INFO -      [32] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:53,222 - INFO -      [32] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:53,439 - INFO -      [32] ‚úì Forward pass completed in 0.006s, loss = 51.7960 (accum_step 3/4)
2025-11-03 09:56:53,718 - INFO -      [32] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:53,719 - INFO -      [32] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:53,936 - INFO -      [32] ‚úì Forward pass completed in 0.006s, loss = 51.6983 (accum_step 4/4)
2025-11-03 09:56:54,224 - INFO -      [33] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:54,224 - INFO -      [33] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:54,235 - INFO -      [33] ‚úì Forward pass completed in 0.006s, loss = 51.4364 (accum_step 1/4)
2025-11-03 09:56:54,248 - INFO -      [33] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:56,119 - INFO -      [33] ‚úì Batch fetched in 1.871s
2025-11-03 09:56:56,343 - INFO -      [33] ‚úì Forward pass completed in 0.007s, loss = 49.6813 (accum_step 2/4)
2025-11-03 09:56:56,623 - INFO -      [33] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:56,623 - INFO -      [33] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:56,841 - INFO -      [33] ‚úì Forward pass completed in 0.006s, loss = 49.9888 (accum_step 3/4)
2025-11-03 09:56:57,121 - INFO -      [33] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:57,121 - INFO -      [33] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:57,337 - INFO -      [33] ‚úì Forward pass completed in 0.006s, loss = 50.5540 (accum_step 4/4)
2025-11-03 09:56:57,626 - INFO -      [34] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:56:57,626 - INFO -      [34] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:57,844 - INFO -      [34] ‚úì Forward pass completed in 0.006s, loss = 47.5085 (accum_step 1/4)
2025-11-03 09:56:58,123 - INFO -      [34] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:56:58,124 - INFO -      [34] ‚úì Batch fetched in 0.000s
2025-11-03 09:56:58,337 - INFO -      [34] ‚úì Forward pass completed in 0.007s, loss = 46.9760 (accum_step 2/4)
2025-11-03 09:56:58,617 - INFO -      [34] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:56:58,618 - INFO -      [34] ‚úì Batch fetched in 0.001s
2025-11-03 09:56:58,832 - INFO -      [34] ‚úì Forward pass completed in 0.009s, loss = 47.1381 (accum_step 3/4)
2025-11-03 09:56:59,112 - INFO -      [34] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:56:59,112 - INFO -      [34] ‚úì Batch fetched in 0.001s
2025-11-03 09:56:59,123 - INFO -      [34] ‚úì Forward pass completed in 0.008s, loss = 48.2970 (accum_step 4/4)
2025-11-03 09:56:59,146 - INFO -   Step 35/100: loss = 47.4799, avg_loss = 151.9486, lr = 0.000070, grad_norm = 16.4307
2025-11-03 09:56:59,146 - INFO -     ‚è±Ô∏è  Timing: total=1.520s (fetch=0.002s, to_device=0.007s, spec_compute=0.002s, forward=0.030s, backward=0.048s, optim=0.010s)
2025-11-03 09:56:59,146 - INFO -      [35] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:00,401 - INFO -      [35] ‚úì Batch fetched in 1.255s
2025-11-03 09:57:00,620 - INFO -      [35] ‚úì Forward pass completed in 0.007s, loss = 44.9160 (accum_step 1/4)
2025-11-03 09:57:00,899 - INFO -      [35] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:00,900 - INFO -      [35] ‚úì Batch fetched in 0.001s
2025-11-03 09:57:01,114 - INFO -      [35] ‚úì Forward pass completed in 0.007s, loss = 46.1218 (accum_step 2/4)
2025-11-03 09:57:01,393 - INFO -      [35] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:01,393 - INFO -      [35] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:01,611 - INFO -      [35] ‚úì Forward pass completed in 0.007s, loss = 45.2865 (accum_step 3/4)
2025-11-03 09:57:01,891 - INFO -      [35] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:01,891 - INFO -      [35] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:02,107 - INFO -      [35] ‚úì Forward pass completed in 0.006s, loss = 45.3984 (accum_step 4/4)
2025-11-03 09:57:02,396 - INFO -      [36] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:02,397 - INFO -      [36] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:02,613 - INFO -      [36] ‚úì Forward pass completed in 0.007s, loss = 44.2657 (accum_step 1/4)
2025-11-03 09:57:02,892 - INFO -      [36] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:02,893 - INFO -      [36] ‚úì Batch fetched in 0.001s
2025-11-03 09:57:03,112 - INFO -      [36] ‚úì Forward pass completed in 0.006s, loss = 43.3714 (accum_step 2/4)
2025-11-03 09:57:03,391 - INFO -      [36] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:03,391 - INFO -      [36] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:03,401 - INFO -      [36] ‚úì Forward pass completed in 0.006s, loss = 42.4415 (accum_step 3/4)
2025-11-03 09:57:03,415 - INFO -      [36] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:05,340 - INFO -      [36] ‚úì Batch fetched in 1.925s
2025-11-03 09:57:05,571 - INFO -      [36] ‚úì Forward pass completed in 0.007s, loss = 43.7597 (accum_step 4/4)
2025-11-03 09:57:05,860 - INFO -      [37] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:05,861 - INFO -      [37] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:06,078 - INFO -      [37] ‚úì Forward pass completed in 0.007s, loss = 42.2203 (accum_step 1/4)
2025-11-03 09:57:06,357 - INFO -      [37] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:06,358 - INFO -      [37] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:06,576 - INFO -      [37] ‚úì Forward pass completed in 0.007s, loss = 41.6326 (accum_step 2/4)
2025-11-03 09:57:06,855 - INFO -      [37] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:06,856 - INFO -      [37] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:07,069 - INFO -      [37] ‚úì Forward pass completed in 0.006s, loss = 41.9872 (accum_step 3/4)
2025-11-03 09:57:07,349 - INFO -      [37] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:07,349 - INFO -      [37] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:07,566 - INFO -      [37] ‚úì Forward pass completed in 0.007s, loss = 41.4588 (accum_step 4/4)
2025-11-03 09:57:07,856 - INFO -      [38] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:07,857 - INFO -      [38] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:08,076 - INFO -      [38] ‚úì Forward pass completed in 0.008s, loss = 39.6390 (accum_step 1/4)
2025-11-03 09:57:08,355 - INFO -      [38] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:08,355 - INFO -      [38] ‚úì Batch fetched in 0.001s
2025-11-03 09:57:08,366 - INFO -      [38] ‚úì Forward pass completed in 0.008s, loss = 41.8992 (accum_step 2/4)
2025-11-03 09:57:08,380 - INFO -      [38] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:09,686 - INFO -      [38] ‚úì Batch fetched in 1.306s
2025-11-03 09:57:09,905 - INFO -      [38] ‚úì Forward pass completed in 0.007s, loss = 39.1575 (accum_step 3/4)
2025-11-03 09:57:10,184 - INFO -      [38] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:10,185 - INFO -      [38] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:10,399 - INFO -      [38] ‚úì Forward pass completed in 0.007s, loss = 39.3783 (accum_step 4/4)
2025-11-03 09:57:10,689 - INFO -      [39] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:10,689 - INFO -      [39] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:10,908 - INFO -      [39] ‚úì Forward pass completed in 0.006s, loss = 38.0665 (accum_step 1/4)
2025-11-03 09:57:11,187 - INFO -      [39] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:11,188 - INFO -      [39] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:11,404 - INFO -      [39] ‚úì Forward pass completed in 0.006s, loss = 38.1311 (accum_step 2/4)
2025-11-03 09:57:11,683 - INFO -      [39] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:11,683 - INFO -      [39] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:11,902 - INFO -      [39] ‚úì Forward pass completed in 0.006s, loss = 38.2560 (accum_step 3/4)
2025-11-03 09:57:12,181 - INFO -      [39] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:12,182 - INFO -      [39] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:12,398 - INFO -      [39] ‚úì Forward pass completed in 0.006s, loss = 37.8076 (accum_step 4/4)
2025-11-03 09:57:12,686 - INFO -   Step 40/100: loss = 38.0653, avg_loss = 138.1750, lr = 0.000080, grad_norm = 11.2418
2025-11-03 09:57:12,686 - INFO -     ‚è±Ô∏è  Timing: total=1.997s (fetch=0.001s, to_device=0.018s, spec_compute=0.002s, forward=0.026s, backward=0.048s, optim=0.009s)
2025-11-03 09:57:12,686 - INFO - 
  üîç Starting validation at step 40...
2025-11-03 09:57:12,687 - INFO -      Applying EMA weights for validation...
2025-11-03 09:57:12,689 - INFO -      Running validation...
2025-11-03 09:57:15,310 - INFO -        Validation batch 1/None: loss = 300.3004
2025-11-03 09:57:15,603 - INFO -        Validation batch 2/None: loss = 302.1886
2025-11-03 09:57:17,134 - INFO -        Validation batch 3/None: loss = 301.0088
2025-11-03 09:57:18,962 - INFO -        Validation batch 5/None: loss = 300.0886
2025-11-03 09:57:22,360 - INFO -        Validation batch 10/None: loss = 302.8338
2025-11-03 09:57:26,715 - INFO -        Validation batch 15/None: loss = 299.9534
2025-11-03 09:57:30,014 - INFO -        Validation batch 20/None: loss = 301.1387
2025-11-03 09:57:34,520 - INFO -        Validation batch 25/None: loss = 301.6252
2025-11-03 09:57:34,614 - INFO -      ‚úì Validation complete: avg_loss = 300.3388 (26 batches)
2025-11-03 09:57:34,615 - INFO -      Restoring training weights...
2025-11-03 09:57:34,616 - INFO -   ‚úì Validation completed in 21.93s
2025-11-03 09:57:34,616 - INFO -      üéØ New best validation loss: 300.3388 (previous: 302.5420)
2025-11-03 09:57:34,616 - INFO -      Saving best model checkpoint...
2025-11-03 09:57:34,811 - INFO -   ‚úì Saved best model to /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint/best_A100_pretraining_test_model.pt (async)
2025-11-03 09:57:34,817 - INFO -      [40] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:34,832 - INFO -      [40] ‚úì Batch fetched in 0.015s
2025-11-03 09:57:34,834 - INFO -      [40] Moving data to device cuda...
2025-11-03 09:57:34,834 - INFO -      [40] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 09:57:34,834 - INFO -      [40] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([3, 256, 512]))
2025-11-03 09:57:34,835 - INFO -      [40] Starting forward pass...
2025-11-03 09:57:34,849 - INFO -      [40] ‚úì Forward pass completed in 0.014s, loss = 40.0438 (accum_step 1/4)
2025-11-03 09:57:34,849 - INFO -      [40] Starting backward pass...
2025-11-03 09:57:34,867 - INFO -      [40] ‚úì Backward pass completed in 0.018s
2025-11-03 09:57:34,868 - INFO -      [40] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:36,327 - INFO -      [40] ‚úì Batch fetched in 1.459s
2025-11-03 09:57:36,327 - INFO -      [40] Moving data to device cuda...
2025-11-03 09:57:36,333 - INFO -      [40] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:57:36,334 - INFO -      [40] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:57:36,334 - INFO -      [40] Starting forward pass...
2025-11-03 09:57:36,546 - INFO -      [40] ‚úì Forward pass completed in 0.008s, loss = 37.2436 (accum_step 2/4)
2025-11-03 09:57:36,546 - INFO -      [40] Starting backward pass...
2025-11-03 09:57:36,559 - INFO -      [40] ‚úì Backward pass completed in 0.013s
2025-11-03 09:57:36,826 - INFO -      [40] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:36,827 - INFO -      [40] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:36,827 - INFO -      [40] Moving data to device cuda...
2025-11-03 09:57:36,833 - INFO -      [40] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:57:36,834 - INFO -      [40] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:57:36,834 - INFO -      [40] Starting forward pass...
2025-11-03 09:57:37,046 - INFO -      [40] ‚úì Forward pass completed in 0.007s, loss = 37.6835 (accum_step 3/4)
2025-11-03 09:57:37,046 - INFO -      [40] Starting backward pass...
2025-11-03 09:57:37,059 - INFO -      [40] ‚úì Backward pass completed in 0.013s
2025-11-03 09:57:37,326 - INFO -      [40] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:37,326 - INFO -      [40] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:37,326 - INFO -      [40] Moving data to device cuda...
2025-11-03 09:57:37,330 - INFO -      [40] ‚úì Data moved to device in 0.004s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:57:37,331 - INFO -      [40] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:57:37,331 - INFO -      [40] Starting forward pass...
2025-11-03 09:57:37,543 - INFO -      [40] ‚úì Forward pass completed in 0.007s, loss = 37.6606 (accum_step 4/4)
2025-11-03 09:57:37,543 - INFO -      [40] Starting backward pass...
2025-11-03 09:57:37,555 - INFO -      [40] ‚úì Backward pass completed in 0.012s
2025-11-03 09:57:37,823 - INFO -      [40] Gradient clipping and optimizer step...
2025-11-03 09:57:37,832 - INFO -      [40] ‚úì Optimizer step completed in 0.009s, grad_norm = 11.2522
2025-11-03 09:57:37,832 - INFO -      [41] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:37,832 - INFO -      [41] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:38,046 - INFO -      [41] ‚úì Forward pass completed in 0.007s, loss = 35.6308 (accum_step 1/4)
2025-11-03 09:57:38,325 - INFO -      [41] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:38,325 - INFO -      [41] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:38,543 - INFO -      [41] ‚úì Forward pass completed in 0.006s, loss = 35.7527 (accum_step 2/4)
2025-11-03 09:57:38,822 - INFO -      [41] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:38,822 - INFO -      [41] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:39,041 - INFO -      [41] ‚úì Forward pass completed in 0.006s, loss = 35.7451 (accum_step 3/4)
2025-11-03 09:57:39,320 - INFO -      [41] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:39,320 - INFO -      [41] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:39,331 - INFO -      [41] ‚úì Forward pass completed in 0.006s, loss = 35.8852 (accum_step 4/4)
2025-11-03 09:57:39,353 - INFO -      [42] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:40,838 - INFO -      [42] ‚úì Batch fetched in 1.484s
2025-11-03 09:57:41,052 - INFO -      [42] ‚úì Forward pass completed in 0.007s, loss = 34.1454 (accum_step 1/4)
2025-11-03 09:57:41,332 - INFO -      [42] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:41,332 - INFO -      [42] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:41,551 - INFO -      [42] ‚úì Forward pass completed in 0.007s, loss = 34.8462 (accum_step 2/4)
2025-11-03 09:57:41,830 - INFO -      [42] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:41,831 - INFO -      [42] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:42,049 - INFO -      [42] ‚úì Forward pass completed in 0.007s, loss = 34.5006 (accum_step 3/4)
2025-11-03 09:57:42,328 - INFO -      [42] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:42,329 - INFO -      [42] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:42,542 - INFO -      [42] ‚úì Forward pass completed in 0.006s, loss = 34.1086 (accum_step 4/4)
2025-11-03 09:57:42,831 - INFO -      [43] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:42,831 - INFO -      [43] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:43,049 - INFO -      [43] ‚úì Forward pass completed in 0.006s, loss = 33.4715 (accum_step 1/4)
2025-11-03 09:57:43,328 - INFO -      [43] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:43,328 - INFO -      [43] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:43,547 - INFO -      [43] ‚úì Forward pass completed in 0.006s, loss = 34.0182 (accum_step 2/4)
2025-11-03 09:57:43,826 - INFO -      [43] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:43,827 - INFO -      [43] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:43,837 - INFO -      [43] ‚úì Forward pass completed in 0.006s, loss = 30.5214 (accum_step 3/4)
2025-11-03 09:57:43,851 - INFO -      [43] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:45,307 - INFO -      [43] ‚úì Batch fetched in 1.456s
2025-11-03 09:57:45,522 - INFO -      [43] ‚úì Forward pass completed in 0.007s, loss = 33.8710 (accum_step 4/4)
2025-11-03 09:57:45,811 - INFO -      [44] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:45,835 - INFO -      [44] ‚úì Batch fetched in 0.023s
2025-11-03 09:57:46,054 - INFO -      [44] ‚úì Forward pass completed in 0.007s, loss = 32.5061 (accum_step 1/4)
2025-11-03 09:57:46,334 - INFO -      [44] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:46,334 - INFO -      [44] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:46,553 - INFO -      [44] ‚úì Forward pass completed in 0.007s, loss = 32.4584 (accum_step 2/4)
2025-11-03 09:57:46,832 - INFO -      [44] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:46,833 - INFO -      [44] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:47,047 - INFO -      [44] ‚úì Forward pass completed in 0.006s, loss = 31.8973 (accum_step 3/4)
2025-11-03 09:57:47,327 - INFO -      [44] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:47,327 - INFO -      [44] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:47,544 - INFO -      [44] ‚úì Forward pass completed in 0.006s, loss = 31.6787 (accum_step 4/4)
2025-11-03 09:57:47,832 - INFO -   Step 45/100: loss = 32.1351, avg_loss = 126.6759, lr = 0.000090, grad_norm = 7.8200
2025-11-03 09:57:47,832 - INFO -     ‚è±Ô∏è  Timing: total=2.021s (fetch=0.024s, to_device=0.018s, spec_compute=0.002s, forward=0.026s, backward=0.046s, optim=0.009s)
2025-11-03 09:57:47,832 - INFO -      [45] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:47,832 - INFO -      [45] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:48,051 - INFO -      [45] ‚úì Forward pass completed in 0.006s, loss = 31.2351 (accum_step 1/4)
2025-11-03 09:57:48,329 - INFO -      [45] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:48,330 - INFO -      [45] ‚úì Batch fetched in 0.001s
2025-11-03 09:57:48,340 - INFO -      [45] ‚úì Forward pass completed in 0.008s, loss = 31.3147 (accum_step 2/4)
2025-11-03 09:57:48,354 - INFO -      [45] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:49,677 - INFO -      [45] ‚úì Batch fetched in 1.323s
2025-11-03 09:57:49,897 - INFO -      [45] ‚úì Forward pass completed in 0.007s, loss = 31.6998 (accum_step 3/4)
2025-11-03 09:57:50,176 - INFO -      [45] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:50,177 - INFO -      [45] ‚úì Batch fetched in 0.001s
2025-11-03 09:57:50,395 - INFO -      [45] ‚úì Forward pass completed in 0.008s, loss = 31.1133 (accum_step 4/4)
2025-11-03 09:57:50,683 - INFO -      [46] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:50,683 - INFO -      [46] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:50,897 - INFO -      [46] ‚úì Forward pass completed in 0.006s, loss = 29.7935 (accum_step 1/4)
2025-11-03 09:57:51,176 - INFO -      [46] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:51,176 - INFO -      [46] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:51,396 - INFO -      [46] ‚úì Forward pass completed in 0.006s, loss = 30.7850 (accum_step 2/4)
2025-11-03 09:57:51,675 - INFO -      [46] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:51,675 - INFO -      [46] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:51,894 - INFO -      [46] ‚úì Forward pass completed in 0.007s, loss = 30.4490 (accum_step 3/4)
2025-11-03 09:57:52,173 - INFO -      [46] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:52,173 - INFO -      [46] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:52,392 - INFO -      [46] ‚úì Forward pass completed in 0.007s, loss = 29.9550 (accum_step 4/4)
2025-11-03 09:57:52,680 - INFO -      [47] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:52,681 - INFO -      [47] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:52,691 - INFO -      [47] ‚úì Forward pass completed in 0.006s, loss = 27.8254 (accum_step 1/4)
2025-11-03 09:57:52,704 - INFO -      [47] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:54,262 - INFO -      [47] ‚úì Batch fetched in 1.558s
2025-11-03 09:57:54,476 - INFO -      [47] ‚úì Forward pass completed in 0.007s, loss = 29.8561 (accum_step 2/4)
2025-11-03 09:57:54,757 - INFO -      [47] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:54,757 - INFO -      [47] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:54,975 - INFO -      [47] ‚úì Forward pass completed in 0.007s, loss = 29.3144 (accum_step 3/4)
2025-11-03 09:57:55,254 - INFO -      [47] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:55,255 - INFO -      [47] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:55,473 - INFO -      [47] ‚úì Forward pass completed in 0.006s, loss = 29.7463 (accum_step 4/4)
2025-11-03 09:57:55,762 - INFO -      [48] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:55,762 - INFO -      [48] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:55,976 - INFO -      [48] ‚úì Forward pass completed in 0.006s, loss = 28.9773 (accum_step 1/4)
2025-11-03 09:57:56,255 - INFO -      [48] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:56,256 - INFO -      [48] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:56,474 - INFO -      [48] ‚úì Forward pass completed in 0.006s, loss = 28.1338 (accum_step 2/4)
2025-11-03 09:57:56,753 - INFO -      [48] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:56,754 - INFO -      [48] ‚úì Batch fetched in 0.001s
2025-11-03 09:57:56,971 - INFO -      [48] ‚úì Forward pass completed in 0.007s, loss = 29.0479 (accum_step 3/4)
2025-11-03 09:57:57,250 - INFO -      [48] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:57:57,250 - INFO -      [48] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:57,260 - INFO -      [48] ‚úì Forward pass completed in 0.006s, loss = 30.0093 (accum_step 4/4)
2025-11-03 09:57:57,283 - INFO -      [49] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:57:58,899 - INFO -      [49] ‚úì Batch fetched in 1.615s
2025-11-03 09:57:59,117 - INFO -      [49] ‚úì Forward pass completed in 0.007s, loss = 28.4918 (accum_step 1/4)
2025-11-03 09:57:59,396 - INFO -      [49] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:57:59,397 - INFO -      [49] ‚úì Batch fetched in 0.000s
2025-11-03 09:57:59,616 - INFO -      [49] ‚úì Forward pass completed in 0.006s, loss = 28.4116 (accum_step 2/4)
2025-11-03 09:57:59,895 - INFO -      [49] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:57:59,895 - INFO -      [49] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:00,109 - INFO -      [49] ‚úì Forward pass completed in 0.006s, loss = 28.5518 (accum_step 3/4)
2025-11-03 09:58:00,388 - INFO -      [49] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:00,388 - INFO -      [49] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:00,607 - INFO -      [49] ‚úì Forward pass completed in 0.006s, loss = 27.9776 (accum_step 4/4)
2025-11-03 09:58:00,898 - INFO -   Step 50/100: loss = 28.3582, avg_loss = 116.9718, lr = 0.000100, grad_norm = 5.4792
2025-11-03 09:58:00,898 - INFO -     ‚è±Ô∏è  Timing: total=3.615s (fetch=1.617s, to_device=0.018s, spec_compute=0.002s, forward=0.026s, backward=0.045s, optim=0.009s)
2025-11-03 09:58:00,898 - INFO -      [50] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:00,898 - INFO -      [50] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:00,899 - INFO -      [50] Moving data to device cuda...
2025-11-03 09:58:00,905 - INFO -      [50] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:58:00,905 - INFO -      [50] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:58:00,905 - INFO -      [50] Starting forward pass...
2025-11-03 09:58:01,118 - INFO -      [50] ‚úì Forward pass completed in 0.006s, loss = 27.8116 (accum_step 1/4)
2025-11-03 09:58:01,118 - INFO -      [50] Starting backward pass...
2025-11-03 09:58:01,128 - INFO -      [50] ‚úì Backward pass completed in 0.010s
2025-11-03 09:58:01,397 - INFO -      [50] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:01,397 - INFO -      [50] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:01,397 - INFO -      [50] Moving data to device cuda...
2025-11-03 09:58:01,398 - INFO -      [50] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:58:01,398 - INFO -      [50] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:58:01,398 - INFO -      [50] Starting forward pass...
2025-11-03 09:58:01,610 - INFO -      [50] ‚úì Forward pass completed in 0.006s, loss = 27.5914 (accum_step 2/4)
2025-11-03 09:58:01,610 - INFO -      [50] Starting backward pass...
2025-11-03 09:58:01,622 - INFO -      [50] ‚úì Backward pass completed in 0.012s
2025-11-03 09:58:01,890 - INFO -      [50] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:01,890 - INFO -      [50] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:01,890 - INFO -      [50] Moving data to device cuda...
2025-11-03 09:58:01,890 - INFO -      [50] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 09:58:01,891 - INFO -      [50] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([3, 256, 512]))
2025-11-03 09:58:01,891 - INFO -      [50] Starting forward pass...
2025-11-03 09:58:01,900 - INFO -      [50] ‚úì Forward pass completed in 0.006s, loss = 27.4455 (accum_step 3/4)
2025-11-03 09:58:01,900 - INFO -      [50] Starting backward pass...
2025-11-03 09:58:01,912 - INFO -      [50] ‚úì Backward pass completed in 0.011s
2025-11-03 09:58:01,914 - INFO -      [50] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:03,691 - INFO -      [50] ‚úì Batch fetched in 1.777s
2025-11-03 09:58:03,691 - INFO -      [50] Moving data to device cuda...
2025-11-03 09:58:03,693 - INFO -      [50] ‚úì Data moved to device in 0.002s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:58:03,694 - INFO -      [50] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:58:03,694 - INFO -      [50] Starting forward pass...
2025-11-03 09:58:03,922 - INFO -      [50] ‚úì Forward pass completed in 0.008s, loss = 26.9566 (accum_step 4/4)
2025-11-03 09:58:03,922 - INFO -      [50] Starting backward pass...
2025-11-03 09:58:03,935 - INFO -      [50] ‚úì Backward pass completed in 0.013s
2025-11-03 09:58:04,201 - INFO -      [50] Gradient clipping and optimizer step...
2025-11-03 09:58:04,255 - INFO -      [50] ‚úì Optimizer step completed in 0.054s, grad_norm = 6.7030
2025-11-03 09:58:04,256 - INFO -      [51] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:04,256 - INFO -      [51] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:04,481 - INFO -      [51] ‚úì Forward pass completed in 0.039s, loss = 27.4020 (accum_step 1/4)
2025-11-03 09:58:04,768 - INFO -      [51] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:04,769 - INFO -      [51] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:04,989 - INFO -      [51] ‚úì Forward pass completed in 0.010s, loss = 26.6359 (accum_step 2/4)
2025-11-03 09:58:05,269 - INFO -      [51] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:05,270 - INFO -      [51] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:05,485 - INFO -      [51] ‚úì Forward pass completed in 0.007s, loss = 26.6345 (accum_step 3/4)
2025-11-03 09:58:05,765 - INFO -      [51] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:05,765 - INFO -      [51] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:05,984 - INFO -      [51] ‚úì Forward pass completed in 0.006s, loss = 26.8383 (accum_step 4/4)
2025-11-03 09:58:06,271 - INFO -      [52] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:06,272 - INFO -      [52] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:06,490 - INFO -      [52] ‚úì Forward pass completed in 0.006s, loss = 26.4476 (accum_step 1/4)
2025-11-03 09:58:06,769 - INFO -      [52] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:06,770 - INFO -      [52] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:06,780 - INFO -      [52] ‚úì Forward pass completed in 0.006s, loss = 26.6943 (accum_step 2/4)
2025-11-03 09:58:06,794 - INFO -      [52] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:08,403 - INFO -      [52] ‚úì Batch fetched in 1.610s
2025-11-03 09:58:08,618 - INFO -      [52] ‚úì Forward pass completed in 0.007s, loss = 26.2362 (accum_step 3/4)
2025-11-03 09:58:08,898 - INFO -      [52] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:08,898 - INFO -      [52] ‚úì Batch fetched in 0.001s
2025-11-03 09:58:09,117 - INFO -      [52] ‚úì Forward pass completed in 0.007s, loss = 26.6380 (accum_step 4/4)
2025-11-03 09:58:09,407 - INFO -      [53] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:09,407 - INFO -      [53] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:09,621 - INFO -      [53] ‚úì Forward pass completed in 0.006s, loss = 26.1509 (accum_step 1/4)
2025-11-03 09:58:09,900 - INFO -      [53] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:09,901 - INFO -      [53] ‚úì Batch fetched in 0.001s
2025-11-03 09:58:10,118 - INFO -      [53] ‚úì Forward pass completed in 0.008s, loss = 26.3323 (accum_step 2/4)
2025-11-03 09:58:10,398 - INFO -      [53] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:10,398 - INFO -      [53] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:10,614 - INFO -      [53] ‚úì Forward pass completed in 0.007s, loss = 25.9716 (accum_step 3/4)
2025-11-03 09:58:10,894 - INFO -      [53] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:10,894 - INFO -      [53] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:11,108 - INFO -      [53] ‚úì Forward pass completed in 0.006s, loss = 26.0590 (accum_step 4/4)
2025-11-03 09:58:11,397 - INFO -      [54] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:11,397 - INFO -      [54] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:11,407 - INFO -      [54] ‚úì Forward pass completed in 0.006s, loss = 28.2230 (accum_step 1/4)
2025-11-03 09:58:11,420 - INFO -      [54] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:13,244 - INFO -      [54] ‚úì Batch fetched in 1.823s
2025-11-03 09:58:13,476 - INFO -      [54] ‚úì Forward pass completed in 0.008s, loss = 25.9045 (accum_step 2/4)
2025-11-03 09:58:13,759 - INFO -      [54] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:13,760 - INFO -      [54] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:13,976 - INFO -      [54] ‚úì Forward pass completed in 0.007s, loss = 25.8194 (accum_step 3/4)
2025-11-03 09:58:14,255 - INFO -      [54] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:14,255 - INFO -      [54] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:14,474 - INFO -      [54] ‚úì Forward pass completed in 0.007s, loss = 25.3047 (accum_step 4/4)
2025-11-03 09:58:14,762 - INFO -   Step 55/100: loss = 26.3129, avg_loss = 108.7611, lr = 0.000100, grad_norm = 5.1137
2025-11-03 09:58:14,762 - INFO -     ‚è±Ô∏è  Timing: total=3.365s (fetch=1.824s, to_device=0.015s, spec_compute=0.002s, forward=0.028s, backward=0.047s, optim=0.009s)
2025-11-03 09:58:14,762 - INFO -      [55] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:14,762 - INFO -      [55] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:14,975 - INFO -      [55] ‚úì Forward pass completed in 0.006s, loss = 25.3924 (accum_step 1/4)
2025-11-03 09:58:15,254 - INFO -      [55] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:15,254 - INFO -      [55] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:15,472 - INFO -      [55] ‚úì Forward pass completed in 0.006s, loss = 25.6964 (accum_step 2/4)
2025-11-03 09:58:15,751 - INFO -      [55] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:15,752 - INFO -      [55] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:15,968 - INFO -      [55] ‚úì Forward pass completed in 0.006s, loss = 25.3528 (accum_step 3/4)
2025-11-03 09:58:16,247 - INFO -      [55] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:16,248 - INFO -      [55] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:16,258 - INFO -      [55] ‚úì Forward pass completed in 0.006s, loss = 24.2422 (accum_step 4/4)
2025-11-03 09:58:16,281 - INFO -      [56] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:17,537 - INFO -      [56] ‚úì Batch fetched in 1.255s
2025-11-03 09:58:17,756 - INFO -      [56] ‚úì Forward pass completed in 0.007s, loss = 24.8951 (accum_step 1/4)
2025-11-03 09:58:18,036 - INFO -      [56] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:18,036 - INFO -      [56] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:18,251 - INFO -      [56] ‚úì Forward pass completed in 0.007s, loss = 25.2264 (accum_step 2/4)
2025-11-03 09:58:18,530 - INFO -      [56] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:18,530 - INFO -      [56] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:18,749 - INFO -      [56] ‚úì Forward pass completed in 0.006s, loss = 25.3082 (accum_step 3/4)
2025-11-03 09:58:19,028 - INFO -      [56] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:19,028 - INFO -      [56] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:19,246 - INFO -      [56] ‚úì Forward pass completed in 0.006s, loss = 25.0633 (accum_step 4/4)
2025-11-03 09:58:19,534 - INFO -      [57] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:19,535 - INFO -      [57] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:19,748 - INFO -      [57] ‚úì Forward pass completed in 0.006s, loss = 24.8412 (accum_step 1/4)
2025-11-03 09:58:20,027 - INFO -      [57] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:20,028 - INFO -      [57] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:20,246 - INFO -      [57] ‚úì Forward pass completed in 0.006s, loss = 25.0889 (accum_step 2/4)
2025-11-03 09:58:20,525 - INFO -      [57] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:20,525 - INFO -      [57] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:20,536 - INFO -      [57] ‚úì Forward pass completed in 0.006s, loss = 28.2762 (accum_step 3/4)
2025-11-03 09:58:20,549 - INFO -      [57] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:22,047 - INFO -      [57] ‚úì Batch fetched in 1.498s
2025-11-03 09:58:22,262 - INFO -      [57] ‚úì Forward pass completed in 0.007s, loss = 24.9873 (accum_step 4/4)
2025-11-03 09:58:22,551 - INFO -      [58] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:22,551 - INFO -      [58] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:22,769 - INFO -      [58] ‚úì Forward pass completed in 0.007s, loss = 24.3872 (accum_step 1/4)
2025-11-03 09:58:23,048 - INFO -      [58] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:23,049 - INFO -      [58] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:23,269 - INFO -      [58] ‚úì Forward pass completed in 0.007s, loss = 24.8604 (accum_step 2/4)
2025-11-03 09:58:23,547 - INFO -      [58] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:23,548 - INFO -      [58] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:23,761 - INFO -      [58] ‚úì Forward pass completed in 0.006s, loss = 24.6408 (accum_step 3/4)
2025-11-03 09:58:24,040 - INFO -      [58] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:24,041 - INFO -      [58] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:24,259 - INFO -      [58] ‚úì Forward pass completed in 0.006s, loss = 24.6652 (accum_step 4/4)
2025-11-03 09:58:24,547 - INFO -      [59] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:24,547 - INFO -      [59] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:24,765 - INFO -      [59] ‚úì Forward pass completed in 0.006s, loss = 24.3040 (accum_step 1/4)
2025-11-03 09:58:25,044 - INFO -      [59] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:25,045 - INFO -      [59] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:25,055 - INFO -      [59] ‚úì Forward pass completed in 0.006s, loss = 25.5511 (accum_step 2/4)
2025-11-03 09:58:25,069 - INFO -      [59] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:27,105 - INFO -      [59] ‚úì Batch fetched in 2.036s
2025-11-03 09:58:27,319 - INFO -      [59] ‚úì Forward pass completed in 0.007s, loss = 23.7868 (accum_step 3/4)
2025-11-03 09:58:27,598 - INFO -      [59] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:27,598 - INFO -      [59] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:27,817 - INFO -      [59] ‚úì Forward pass completed in 0.007s, loss = 24.5370 (accum_step 4/4)
2025-11-03 09:58:28,106 - INFO -   Step 60/100: loss = 24.5447, avg_loss = 101.7856, lr = 0.000100, grad_norm = 5.1709
2025-11-03 09:58:28,106 - INFO -     ‚è±Ô∏è  Timing: total=3.559s (fetch=2.037s, to_device=0.013s, spec_compute=0.003s, forward=0.027s, backward=0.046s, optim=0.009s)
2025-11-03 09:58:28,106 - INFO - 
  üîç Starting validation at step 60...
2025-11-03 09:58:28,106 - INFO -      Applying EMA weights for validation...
2025-11-03 09:58:28,108 - INFO -      Running validation...
2025-11-03 09:58:29,889 - INFO -        Validation batch 1/None: loss = 296.4530
2025-11-03 09:58:30,181 - INFO -        Validation batch 2/None: loss = 299.7449
2025-11-03 09:58:31,411 - INFO -        Validation batch 3/None: loss = 303.6062
2025-11-03 09:58:32,794 - INFO -        Validation batch 5/None: loss = 298.6111
2025-11-03 09:58:36,428 - INFO -        Validation batch 10/None: loss = 300.5166
2025-11-03 09:58:40,812 - INFO -        Validation batch 15/None: loss = 299.9077
2025-11-03 09:58:43,791 - INFO -        Validation batch 20/None: loss = 302.1851
2025-11-03 09:58:48,003 - INFO -        Validation batch 25/None: loss = 297.7703
2025-11-03 09:58:48,099 - INFO -      ‚úì Validation complete: avg_loss = 298.4667 (26 batches)
2025-11-03 09:58:48,099 - INFO -      Restoring training weights...
2025-11-03 09:58:48,100 - INFO -   ‚úì Validation completed in 19.99s
2025-11-03 09:58:48,100 - INFO -      üéØ New best validation loss: 298.4667 (previous: 300.3388)
2025-11-03 09:58:48,100 - INFO -      Saving best model checkpoint...
2025-11-03 09:58:48,299 - INFO -   ‚úì Saved best model to /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint/best_A100_pretraining_test_model.pt (async)
2025-11-03 09:58:48,310 - INFO -      [60] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:48,320 - INFO -      [60] ‚úì Batch fetched in 0.011s
2025-11-03 09:58:48,320 - INFO -      [60] Moving data to device cuda...
2025-11-03 09:58:48,326 - INFO -      [60] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:58:48,327 - INFO -      [60] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:58:48,327 - INFO -      [60] Starting forward pass...
2025-11-03 09:58:48,545 - INFO -      [60] ‚úì Forward pass completed in 0.215s, loss = 24.1042 (accum_step 1/4)
2025-11-03 09:58:48,545 - INFO -      [60] Starting backward pass...
2025-11-03 09:58:48,828 - INFO -      [60] ‚úì Backward pass completed in 0.283s
2025-11-03 09:58:48,828 - INFO -      [60] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:48,829 - INFO -      [60] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:48,829 - INFO -      [60] Moving data to device cuda...
2025-11-03 09:58:48,835 - INFO -      [60] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:58:48,836 - INFO -      [60] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:58:48,836 - INFO -      [60] Starting forward pass...
2025-11-03 09:58:49,048 - INFO -      [60] ‚úì Forward pass completed in 0.141s, loss = 24.2624 (accum_step 2/4)
2025-11-03 09:58:49,049 - INFO -      [60] Starting backward pass...
2025-11-03 09:58:49,322 - INFO -      [60] ‚úì Backward pass completed in 0.274s
2025-11-03 09:58:49,333 - INFO -      [60] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:49,333 - INFO -      [60] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:49,334 - INFO -      [60] Moving data to device cuda...
2025-11-03 09:58:49,335 - INFO -      [60] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:58:49,336 - INFO -      [60] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:58:49,336 - INFO -      [60] Starting forward pass...
2025-11-03 09:58:49,551 - INFO -      [60] ‚úì Forward pass completed in 0.215s, loss = 24.0318 (accum_step 3/4)
2025-11-03 09:58:49,551 - INFO -      [60] Starting backward pass...
2025-11-03 09:58:49,834 - INFO -      [60] ‚úì Backward pass completed in 0.283s
2025-11-03 09:58:49,835 - INFO -      [60] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:49,835 - INFO -      [60] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:49,835 - INFO -      [60] Moving data to device cuda...
2025-11-03 09:58:49,840 - INFO -      [60] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:58:49,841 - INFO -      [60] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:58:49,841 - INFO -      [60] Starting forward pass...
2025-11-03 09:58:50,057 - INFO -      [60] ‚úì Forward pass completed in 0.119s, loss = 24.3290 (accum_step 4/4)
2025-11-03 09:58:50,059 - INFO -      [60] Starting backward pass...
2025-11-03 09:58:50,343 - INFO -      [60] ‚úì Backward pass completed in 0.284s
2025-11-03 09:58:50,343 - INFO -      [60] Gradient clipping and optimizer step...
2025-11-03 09:58:50,359 - INFO -      [60] ‚úì Optimizer step completed in 0.016s, grad_norm = 4.0387
2025-11-03 09:58:50,359 - INFO -      [61] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:50,359 - INFO -      [61] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:50,376 - INFO -      [61] ‚úì Forward pass completed in 0.016s, loss = 23.3642 (accum_step 1/4)
2025-11-03 09:58:50,400 - INFO -      [61] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:52,523 - INFO -      [61] ‚úì Batch fetched in 2.123s
2025-11-03 09:58:52,762 - INFO -      [61] ‚úì Forward pass completed in 0.010s, loss = 23.8630 (accum_step 2/4)
2025-11-03 09:58:53,046 - INFO -      [61] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:53,046 - INFO -      [61] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:53,266 - INFO -      [61] ‚úì Forward pass completed in 0.007s, loss = 23.9170 (accum_step 3/4)
2025-11-03 09:58:53,545 - INFO -      [61] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:53,545 - INFO -      [61] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:53,764 - INFO -      [61] ‚úì Forward pass completed in 0.006s, loss = 24.3339 (accum_step 4/4)
2025-11-03 09:58:54,052 - INFO -      [62] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:54,052 - INFO -      [62] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:54,268 - INFO -      [62] ‚úì Forward pass completed in 0.006s, loss = 23.9264 (accum_step 1/4)
2025-11-03 09:58:54,546 - INFO -      [62] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:54,547 - INFO -      [62] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:54,765 - INFO -      [62] ‚úì Forward pass completed in 0.006s, loss = 24.3073 (accum_step 2/4)
2025-11-03 09:58:55,044 - INFO -      [62] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:55,044 - INFO -      [62] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:55,260 - INFO -      [62] ‚úì Forward pass completed in 0.006s, loss = 23.9615 (accum_step 3/4)
2025-11-03 09:58:55,539 - INFO -      [62] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:55,540 - INFO -      [62] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:55,550 - INFO -      [62] ‚úì Forward pass completed in 0.006s, loss = 23.9120 (accum_step 4/4)
2025-11-03 09:58:55,573 - INFO -      [63] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:57,395 - INFO -      [63] ‚úì Batch fetched in 1.822s
2025-11-03 09:58:57,614 - INFO -      [63] ‚úì Forward pass completed in 0.008s, loss = 23.6959 (accum_step 1/4)
2025-11-03 09:58:57,893 - INFO -      [63] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:57,893 - INFO -      [63] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:58,111 - INFO -      [63] ‚úì Forward pass completed in 0.007s, loss = 23.8115 (accum_step 2/4)
2025-11-03 09:58:58,390 - INFO -      [63] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:58:58,390 - INFO -      [63] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:58,606 - INFO -      [63] ‚úì Forward pass completed in 0.007s, loss = 23.7207 (accum_step 3/4)
2025-11-03 09:58:58,885 - INFO -      [63] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:58:58,886 - INFO -      [63] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:59,105 - INFO -      [63] ‚úì Forward pass completed in 0.006s, loss = 23.5932 (accum_step 4/4)
2025-11-03 09:58:59,393 - INFO -      [64] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:58:59,393 - INFO -      [64] ‚úì Batch fetched in 0.000s
2025-11-03 09:58:59,612 - INFO -      [64] ‚úì Forward pass completed in 0.006s, loss = 24.0522 (accum_step 1/4)
2025-11-03 09:58:59,890 - INFO -      [64] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:58:59,890 - INFO -      [64] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:00,106 - INFO -      [64] ‚úì Forward pass completed in 0.006s, loss = 23.2849 (accum_step 2/4)
2025-11-03 09:59:00,385 - INFO -      [64] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:00,385 - INFO -      [64] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:00,396 - INFO -      [64] ‚úì Forward pass completed in 0.006s, loss = 21.5791 (accum_step 3/4)
2025-11-03 09:59:00,409 - INFO -      [64] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:02,457 - INFO -      [64] ‚úì Batch fetched in 2.047s
2025-11-03 09:59:02,697 - INFO -      [64] ‚úì Forward pass completed in 0.008s, loss = 23.6656 (accum_step 4/4)
2025-11-03 09:59:02,987 - INFO -   Step 65/100: loss = 23.1455, avg_loss = 95.7857, lr = 0.000100, grad_norm = 5.5051
2025-11-03 09:59:02,987 - INFO -     ‚è±Ô∏è  Timing: total=3.594s (fetch=2.048s, to_device=0.016s, spec_compute=0.002s, forward=0.027s, backward=0.047s, optim=0.010s)
2025-11-03 09:59:02,987 - INFO -      [65] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:02,987 - INFO -      [65] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:03,203 - INFO -      [65] ‚úì Forward pass completed in 0.007s, loss = 24.1586 (accum_step 1/4)
2025-11-03 09:59:03,481 - INFO -      [65] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:03,482 - INFO -      [65] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:03,699 - INFO -      [65] ‚úì Forward pass completed in 0.007s, loss = 23.8206 (accum_step 2/4)
2025-11-03 09:59:03,979 - INFO -      [65] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:03,979 - INFO -      [65] ‚úì Batch fetched in 0.001s
2025-11-03 09:59:04,192 - INFO -      [65] ‚úì Forward pass completed in 0.007s, loss = 23.7755 (accum_step 3/4)
2025-11-03 09:59:04,471 - INFO -      [65] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:04,472 - INFO -      [65] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:04,690 - INFO -      [65] ‚úì Forward pass completed in 0.006s, loss = 24.0557 (accum_step 4/4)
2025-11-03 09:59:04,978 - INFO -      [66] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:04,978 - INFO -      [66] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:05,195 - INFO -      [66] ‚úì Forward pass completed in 0.006s, loss = 23.4917 (accum_step 1/4)
2025-11-03 09:59:05,473 - INFO -      [66] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:05,473 - INFO -      [66] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:05,484 - INFO -      [66] ‚úì Forward pass completed in 0.006s, loss = 20.3919 (accum_step 2/4)
2025-11-03 09:59:05,497 - INFO -      [66] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:07,829 - INFO -      [66] ‚úì Batch fetched in 2.332s
2025-11-03 09:59:08,067 - INFO -      [66] ‚úì Forward pass completed in 0.007s, loss = 23.6513 (accum_step 3/4)
2025-11-03 09:59:08,350 - INFO -      [66] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:08,351 - INFO -      [66] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:08,569 - INFO -      [66] ‚úì Forward pass completed in 0.007s, loss = 23.0820 (accum_step 4/4)
2025-11-03 09:59:08,858 - INFO -      [67] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:08,858 - INFO -      [67] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:09,074 - INFO -      [67] ‚úì Forward pass completed in 0.008s, loss = 23.5330 (accum_step 1/4)
2025-11-03 09:59:09,353 - INFO -      [67] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:09,353 - INFO -      [67] ‚úì Batch fetched in 0.001s
2025-11-03 09:59:10,004 - INFO -      [67] ‚úì Forward pass completed in 0.643s, loss = 23.3392 (accum_step 2/4)
2025-11-03 09:59:10,283 - INFO -      [67] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:10,284 - INFO -      [67] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:10,498 - INFO -      [67] ‚úì Forward pass completed in 0.007s, loss = 23.2813 (accum_step 3/4)
2025-11-03 09:59:10,777 - INFO -      [67] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:10,778 - INFO -      [67] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:10,995 - INFO -      [67] ‚úì Forward pass completed in 0.007s, loss = 23.5858 (accum_step 4/4)
2025-11-03 09:59:11,284 - INFO -      [68] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:11,284 - INFO -      [68] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:11,295 - INFO -      [68] ‚úì Forward pass completed in 0.007s, loss = 19.8932 (accum_step 1/4)
2025-11-03 09:59:11,308 - INFO -      [68] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:12,893 - INFO -      [68] ‚úì Batch fetched in 1.585s
2025-11-03 09:59:13,109 - INFO -      [68] ‚úì Forward pass completed in 0.007s, loss = 23.0064 (accum_step 2/4)
2025-11-03 09:59:13,389 - INFO -      [68] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:13,389 - INFO -      [68] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:13,603 - INFO -      [68] ‚úì Forward pass completed in 0.006s, loss = 23.0775 (accum_step 3/4)
2025-11-03 09:59:13,882 - INFO -      [68] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:13,883 - INFO -      [68] ‚úì Batch fetched in 0.001s
2025-11-03 09:59:14,099 - INFO -      [68] ‚úì Forward pass completed in 0.007s, loss = 23.1435 (accum_step 4/4)
2025-11-03 09:59:14,388 - INFO -      [69] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:14,388 - INFO -      [69] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:14,606 - INFO -      [69] ‚úì Forward pass completed in 0.006s, loss = 23.1877 (accum_step 1/4)
2025-11-03 09:59:14,885 - INFO -      [69] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:14,886 - INFO -      [69] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:15,104 - INFO -      [69] ‚úì Forward pass completed in 0.006s, loss = 23.0187 (accum_step 2/4)
2025-11-03 09:59:15,383 - INFO -      [69] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:15,384 - INFO -      [69] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:15,602 - INFO -      [69] ‚úì Forward pass completed in 0.006s, loss = 22.6709 (accum_step 3/4)
2025-11-03 09:59:15,881 - INFO -      [69] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:15,882 - INFO -      [69] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:15,892 - INFO -      [69] ‚úì Forward pass completed in 0.006s, loss = 22.4822 (accum_step 4/4)
2025-11-03 09:59:15,915 - INFO -   Step 70/100: loss = 22.8399, avg_loss = 90.5890, lr = 0.000100, grad_norm = 4.1662
2025-11-03 09:59:15,915 - INFO -     ‚è±Ô∏è  Timing: total=1.527s (fetch=0.001s, to_device=0.017s, spec_compute=0.002s, forward=0.025s, backward=0.045s, optim=0.009s)
2025-11-03 09:59:15,915 - INFO -      [70] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:17,530 - INFO -      [70] ‚úì Batch fetched in 1.615s
2025-11-03 09:59:17,530 - INFO -      [70] Moving data to device cuda...
2025-11-03 09:59:17,535 - INFO -      [70] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:59:17,536 - INFO -      [70] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:59:17,536 - INFO -      [70] Starting forward pass...
2025-11-03 09:59:17,748 - INFO -      [70] ‚úì Forward pass completed in 0.006s, loss = 23.0690 (accum_step 1/4)
2025-11-03 09:59:17,748 - INFO -      [70] Starting backward pass...
2025-11-03 09:59:17,760 - INFO -      [70] ‚úì Backward pass completed in 0.012s
2025-11-03 09:59:18,028 - INFO -      [70] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:18,028 - INFO -      [70] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:18,028 - INFO -      [70] Moving data to device cuda...
2025-11-03 09:59:18,029 - INFO -      [70] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:59:18,030 - INFO -      [70] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:59:18,030 - INFO -      [70] Starting forward pass...
2025-11-03 09:59:18,242 - INFO -      [70] ‚úì Forward pass completed in 0.006s, loss = 22.5881 (accum_step 2/4)
2025-11-03 09:59:18,242 - INFO -      [70] Starting backward pass...
2025-11-03 09:59:18,253 - INFO -      [70] ‚úì Backward pass completed in 0.012s
2025-11-03 09:59:18,521 - INFO -      [70] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:18,521 - INFO -      [70] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:18,521 - INFO -      [70] Moving data to device cuda...
2025-11-03 09:59:18,526 - INFO -      [70] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:59:18,527 - INFO -      [70] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:59:18,527 - INFO -      [70] Starting forward pass...
2025-11-03 09:59:18,739 - INFO -      [70] ‚úì Forward pass completed in 0.006s, loss = 22.9611 (accum_step 3/4)
2025-11-03 09:59:18,739 - INFO -      [70] Starting backward pass...
2025-11-03 09:59:18,750 - INFO -      [70] ‚úì Backward pass completed in 0.011s
2025-11-03 09:59:19,019 - INFO -      [70] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:19,019 - INFO -      [70] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:19,019 - INFO -      [70] Moving data to device cuda...
2025-11-03 09:59:19,024 - INFO -      [70] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 09:59:19,025 - INFO -      [70] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 09:59:19,025 - INFO -      [70] Starting forward pass...
2025-11-03 09:59:19,237 - INFO -      [70] ‚úì Forward pass completed in 0.006s, loss = 23.0202 (accum_step 4/4)
2025-11-03 09:59:19,237 - INFO -      [70] Starting backward pass...
2025-11-03 09:59:19,249 - INFO -      [70] ‚úì Backward pass completed in 0.011s
2025-11-03 09:59:19,516 - INFO -      [70] Gradient clipping and optimizer step...
2025-11-03 09:59:19,525 - INFO -      [70] ‚úì Optimizer step completed in 0.009s, grad_norm = 3.7668
2025-11-03 09:59:19,525 - INFO -      [71] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:19,525 - INFO -      [71] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:19,744 - INFO -      [71] ‚úì Forward pass completed in 0.006s, loss = 22.9377 (accum_step 1/4)
2025-11-03 09:59:20,023 - INFO -      [71] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:20,024 - INFO -      [71] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:20,241 - INFO -      [71] ‚úì Forward pass completed in 0.006s, loss = 22.9221 (accum_step 2/4)
2025-11-03 09:59:20,521 - INFO -      [71] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:20,521 - INFO -      [71] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:20,531 - INFO -      [71] ‚úì Forward pass completed in 0.006s, loss = 23.6248 (accum_step 3/4)
2025-11-03 09:59:20,545 - INFO -      [71] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:21,572 - INFO -      [71] ‚úì Batch fetched in 1.027s
2025-11-03 09:59:21,791 - INFO -      [71] ‚úì Forward pass completed in 0.007s, loss = 22.9002 (accum_step 4/4)
2025-11-03 09:59:22,079 - INFO -      [72] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:22,079 - INFO -      [72] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:22,293 - INFO -      [72] ‚úì Forward pass completed in 0.006s, loss = 22.6815 (accum_step 1/4)
2025-11-03 09:59:22,572 - INFO -      [72] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:22,572 - INFO -      [72] ‚úì Batch fetched in 0.001s
2025-11-03 09:59:22,791 - INFO -      [72] ‚úì Forward pass completed in 0.006s, loss = 22.4157 (accum_step 2/4)
2025-11-03 09:59:23,070 - INFO -      [72] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:23,070 - INFO -      [72] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:23,288 - INFO -      [72] ‚úì Forward pass completed in 0.006s, loss = 22.5698 (accum_step 3/4)
2025-11-03 09:59:23,567 - INFO -      [72] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:23,568 - INFO -      [72] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:23,785 - INFO -      [72] ‚úì Forward pass completed in 0.006s, loss = 22.5564 (accum_step 4/4)
2025-11-03 09:59:24,073 - INFO -      [73] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:24,073 - INFO -      [73] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:24,292 - INFO -      [73] ‚úì Forward pass completed in 0.006s, loss = 22.3543 (accum_step 1/4)
2025-11-03 09:59:24,571 - INFO -      [73] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:24,571 - INFO -      [73] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:24,581 - INFO -      [73] ‚úì Forward pass completed in 0.006s, loss = 23.2830 (accum_step 2/4)
2025-11-03 09:59:24,595 - INFO -      [73] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:25,791 - INFO -      [73] ‚úì Batch fetched in 1.196s
2025-11-03 09:59:26,008 - INFO -      [73] ‚úì Forward pass completed in 0.007s, loss = 22.5172 (accum_step 3/4)
2025-11-03 09:59:26,288 - INFO -      [73] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:26,288 - INFO -      [73] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:26,506 - INFO -      [73] ‚úì Forward pass completed in 0.006s, loss = 22.8466 (accum_step 4/4)
2025-11-03 09:59:26,795 - INFO -      [74] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:26,795 - INFO -      [74] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:27,014 - INFO -      [74] ‚úì Forward pass completed in 0.006s, loss = 22.7398 (accum_step 1/4)
2025-11-03 09:59:27,293 - INFO -      [74] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:27,293 - INFO -      [74] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:27,511 - INFO -      [74] ‚úì Forward pass completed in 0.006s, loss = 22.5560 (accum_step 2/4)
2025-11-03 09:59:27,790 - INFO -      [74] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:27,791 - INFO -      [74] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:28,009 - INFO -      [74] ‚úì Forward pass completed in 0.006s, loss = 22.6224 (accum_step 3/4)
2025-11-03 09:59:28,289 - INFO -      [74] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:28,289 - INFO -      [74] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:28,507 - INFO -      [74] ‚úì Forward pass completed in 0.006s, loss = 22.2878 (accum_step 4/4)
2025-11-03 09:59:28,795 - INFO -   Step 75/100: loss = 22.5515, avg_loss = 86.0679, lr = 0.000100, grad_norm = 3.8007
2025-11-03 09:59:28,795 - INFO -     ‚è±Ô∏è  Timing: total=2.000s (fetch=0.001s, to_device=0.022s, spec_compute=0.002s, forward=0.025s, backward=0.044s, optim=0.009s)
2025-11-03 09:59:28,795 - INFO -      [75] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:28,795 - INFO -      [75] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:28,805 - INFO -      [75] ‚úì Forward pass completed in 0.006s, loss = 21.7902 (accum_step 1/4)
2025-11-03 09:59:28,818 - INFO -      [75] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:30,312 - INFO -      [75] ‚úì Batch fetched in 1.493s
2025-11-03 09:59:30,532 - INFO -      [75] ‚úì Forward pass completed in 0.007s, loss = 22.4453 (accum_step 2/4)
2025-11-03 09:59:30,812 - INFO -      [75] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:31,201 - INFO -      [75] ‚úì Batch fetched in 0.389s
2025-11-03 09:59:31,420 - INFO -      [75] ‚úì Forward pass completed in 0.006s, loss = 22.2100 (accum_step 3/4)
2025-11-03 09:59:31,699 - INFO -      [75] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:31,699 - INFO -      [75] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:31,918 - INFO -      [75] ‚úì Forward pass completed in 0.006s, loss = 22.6957 (accum_step 4/4)
2025-11-03 09:59:32,206 - INFO -      [76] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:32,206 - INFO -      [76] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:32,422 - INFO -      [76] ‚úì Forward pass completed in 0.006s, loss = 22.5401 (accum_step 1/4)
2025-11-03 09:59:32,701 - INFO -      [76] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:32,702 - INFO -      [76] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:32,920 - INFO -      [76] ‚úì Forward pass completed in 0.006s, loss = 22.1594 (accum_step 2/4)
2025-11-03 09:59:33,200 - INFO -      [76] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:33,200 - INFO -      [76] ‚úì Batch fetched in 0.001s
2025-11-03 09:59:33,419 - INFO -      [76] ‚úì Forward pass completed in 0.006s, loss = 22.2484 (accum_step 3/4)
2025-11-03 09:59:33,698 - INFO -      [76] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:33,698 - INFO -      [76] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:33,709 - INFO -      [76] ‚úì Forward pass completed in 0.007s, loss = 22.0071 (accum_step 4/4)
2025-11-03 09:59:33,732 - INFO -      [77] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:35,500 - INFO -      [77] ‚úì Batch fetched in 1.769s
2025-11-03 09:59:35,720 - INFO -      [77] ‚úì Forward pass completed in 0.007s, loss = 22.3466 (accum_step 1/4)
2025-11-03 09:59:35,999 - INFO -      [77] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:36,000 - INFO -      [77] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:36,214 - INFO -      [77] ‚úì Forward pass completed in 0.007s, loss = 22.2279 (accum_step 2/4)
2025-11-03 09:59:36,493 - INFO -      [77] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:36,494 - INFO -      [77] ‚úì Batch fetched in 0.001s
2025-11-03 09:59:36,711 - INFO -      [77] ‚úì Forward pass completed in 0.007s, loss = 22.0794 (accum_step 3/4)
2025-11-03 09:59:36,990 - INFO -      [77] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:36,990 - INFO -      [77] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:37,208 - INFO -      [77] ‚úì Forward pass completed in 0.007s, loss = 22.4534 (accum_step 4/4)
2025-11-03 09:59:37,496 - INFO -      [78] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:37,496 - INFO -      [78] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:37,715 - INFO -      [78] ‚úì Forward pass completed in 0.006s, loss = 22.0811 (accum_step 1/4)
2025-11-03 09:59:37,994 - INFO -      [78] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:37,994 - INFO -      [78] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:38,213 - INFO -      [78] ‚úì Forward pass completed in 0.006s, loss = 22.1883 (accum_step 2/4)
2025-11-03 09:59:38,492 - INFO -      [78] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:38,492 - INFO -      [78] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:38,503 - INFO -      [78] ‚úì Forward pass completed in 0.006s, loss = 24.2434 (accum_step 3/4)
2025-11-03 09:59:38,516 - INFO -      [78] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:40,215 - INFO -      [78] ‚úì Batch fetched in 1.698s
2025-11-03 09:59:40,447 - INFO -      [78] ‚úì Forward pass completed in 0.008s, loss = 21.9061 (accum_step 4/4)
2025-11-03 09:59:40,743 - INFO -      [79] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 09:59:40,743 - INFO -      [79] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:40,961 - INFO -      [79] ‚úì Forward pass completed in 0.007s, loss = 21.6820 (accum_step 1/4)
2025-11-03 09:59:41,240 - INFO -      [79] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 09:59:41,241 - INFO -      [79] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:41,457 - INFO -      [79] ‚úì Forward pass completed in 0.007s, loss = 22.0864 (accum_step 2/4)
2025-11-03 09:59:41,736 - INFO -      [79] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 09:59:41,737 - INFO -      [79] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:41,955 - INFO -      [79] ‚úì Forward pass completed in 0.006s, loss = 21.9946 (accum_step 3/4)
2025-11-03 09:59:42,234 - INFO -      [79] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 09:59:42,235 - INFO -      [79] ‚úì Batch fetched in 0.000s
2025-11-03 09:59:42,454 - INFO -      [79] ‚úì Forward pass completed in 0.006s, loss = 22.2491 (accum_step 4/4)
2025-11-03 09:59:42,746 - INFO -   Step 80/100: loss = 22.0030, avg_loss = 82.0813, lr = 0.000100, grad_norm = 3.6640
2025-11-03 09:59:42,746 - INFO -     ‚è±Ô∏è  Timing: total=2.003s (fetch=0.002s, to_device=0.020s, spec_compute=0.003s, forward=0.027s, backward=0.053s, optim=0.011s)
2025-11-03 09:59:42,746 - INFO - 
  üîç Starting validation at step 80...
2025-11-03 09:59:42,746 - INFO -      Applying EMA weights for validation...
2025-11-03 09:59:42,748 - INFO -      Running validation...
2025-11-03 09:59:44,526 - INFO -        Validation batch 1/None: loss = 296.2939
2025-11-03 09:59:45,513 - INFO -        Validation batch 2/None: loss = 297.3485
2025-11-03 09:59:46,025 - INFO -        Validation batch 3/None: loss = 296.1340
2025-11-03 09:59:47,794 - INFO -        Validation batch 5/None: loss = 295.9282
2025-11-03 09:59:51,668 - INFO -        Validation batch 10/None: loss = 296.4232
2025-11-03 09:59:55,237 - INFO -        Validation batch 15/None: loss = 292.8331
2025-11-03 09:59:58,804 - INFO -        Validation batch 20/None: loss = 297.7885
2025-11-03 10:00:02,687 - INFO -        Validation batch 25/None: loss = 293.1521
2025-11-03 10:00:02,783 - INFO -      ‚úì Validation complete: avg_loss = 296.2319 (26 batches)
2025-11-03 10:00:02,783 - INFO -      Restoring training weights...
2025-11-03 10:00:02,784 - INFO -   ‚úì Validation completed in 20.04s
2025-11-03 10:00:02,784 - INFO -      üéØ New best validation loss: 296.2319 (previous: 298.4667)
2025-11-03 10:00:02,785 - INFO -      Saving best model checkpoint...
2025-11-03 10:00:02,980 - INFO -   ‚úì Saved best model to /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint/best_A100_pretraining_test_model.pt (async)
2025-11-03 10:00:02,990 - INFO -      [80] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:03,000 - INFO -      [80] ‚úì Batch fetched in 0.010s
2025-11-03 10:00:03,000 - INFO -      [80] Moving data to device cuda...
2025-11-03 10:00:03,007 - INFO -      [80] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:00:03,008 - INFO -      [80] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:00:03,008 - INFO -      [80] Starting forward pass...
2025-11-03 10:00:03,223 - INFO -      [80] ‚úì Forward pass completed in 0.215s, loss = 21.7609 (accum_step 1/4)
2025-11-03 10:00:03,223 - INFO -      [80] Starting backward pass...
2025-11-03 10:00:03,506 - INFO -      [80] ‚úì Backward pass completed in 0.282s
2025-11-03 10:00:03,509 - INFO -      [80] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:03,511 - INFO -      [80] ‚úì Batch fetched in 0.003s
2025-11-03 10:00:03,511 - INFO -      [80] Moving data to device cuda...
2025-11-03 10:00:03,512 - INFO -      [80] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 10:00:03,512 - INFO -      [80] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([3, 256, 512]))
2025-11-03 10:00:03,512 - INFO -      [80] Starting forward pass...
2025-11-03 10:00:03,526 - INFO -      [80] ‚úì Forward pass completed in 0.013s, loss = 21.0493 (accum_step 2/4)
2025-11-03 10:00:03,526 - INFO -      [80] Starting backward pass...
2025-11-03 10:00:03,549 - INFO -      [80] ‚úì Backward pass completed in 0.022s
2025-11-03 10:00:03,549 - INFO -      [80] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:04,825 - INFO -      [80] ‚úì Batch fetched in 1.276s
2025-11-03 10:00:04,825 - INFO -      [80] Moving data to device cuda...
2025-11-03 10:00:04,831 - INFO -      [80] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:00:04,832 - INFO -      [80] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:00:04,832 - INFO -      [80] Starting forward pass...
2025-11-03 10:00:05,044 - INFO -      [80] ‚úì Forward pass completed in 0.007s, loss = 22.0016 (accum_step 3/4)
2025-11-03 10:00:05,045 - INFO -      [80] Starting backward pass...
2025-11-03 10:00:05,058 - INFO -      [80] ‚úì Backward pass completed in 0.013s
2025-11-03 10:00:05,324 - INFO -      [80] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:05,324 - INFO -      [80] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:05,324 - INFO -      [80] Moving data to device cuda...
2025-11-03 10:00:05,331 - INFO -      [80] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:00:05,332 - INFO -      [80] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:00:05,332 - INFO -      [80] Starting forward pass...
2025-11-03 10:00:05,544 - INFO -      [80] ‚úì Forward pass completed in 0.007s, loss = 21.8135 (accum_step 4/4)
2025-11-03 10:00:05,544 - INFO -      [80] Starting backward pass...
2025-11-03 10:00:05,557 - INFO -      [80] ‚úì Backward pass completed in 0.013s
2025-11-03 10:00:05,824 - INFO -      [80] Gradient clipping and optimizer step...
2025-11-03 10:00:05,833 - INFO -      [80] ‚úì Optimizer step completed in 0.010s, grad_norm = 5.0197
2025-11-03 10:00:05,834 - INFO -      [81] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:05,834 - INFO -      [81] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:06,053 - INFO -      [81] ‚úì Forward pass completed in 0.007s, loss = 21.7821 (accum_step 1/4)
2025-11-03 10:00:06,331 - INFO -      [81] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:06,331 - INFO -      [81] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:06,550 - INFO -      [81] ‚úì Forward pass completed in 0.007s, loss = 21.7243 (accum_step 2/4)
2025-11-03 10:00:06,829 - INFO -      [81] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:06,829 - INFO -      [81] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:07,046 - INFO -      [81] ‚úì Forward pass completed in 0.008s, loss = 21.6588 (accum_step 3/4)
2025-11-03 10:00:07,325 - INFO -      [81] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:07,325 - INFO -      [81] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:07,543 - INFO -      [81] ‚úì Forward pass completed in 0.007s, loss = 21.8675 (accum_step 4/4)
2025-11-03 10:00:07,831 - INFO -      [82] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:07,832 - INFO -      [82] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:07,842 - INFO -      [82] ‚úì Forward pass completed in 0.006s, loss = 24.0579 (accum_step 1/4)
2025-11-03 10:00:07,855 - INFO -      [82] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:09,262 - INFO -      [82] ‚úì Batch fetched in 1.408s
2025-11-03 10:00:09,482 - INFO -      [82] ‚úì Forward pass completed in 0.008s, loss = 21.5407 (accum_step 2/4)
2025-11-03 10:00:09,762 - INFO -      [82] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:09,763 - INFO -      [82] ‚úì Batch fetched in 0.001s
2025-11-03 10:00:09,979 - INFO -      [82] ‚úì Forward pass completed in 0.008s, loss = 21.9784 (accum_step 3/4)
2025-11-03 10:00:10,258 - INFO -      [82] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:10,259 - INFO -      [82] ‚úì Batch fetched in 0.001s
2025-11-03 10:00:10,477 - INFO -      [82] ‚úì Forward pass completed in 0.008s, loss = 21.5525 (accum_step 4/4)
2025-11-03 10:00:10,774 - INFO -      [83] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:10,774 - INFO -      [83] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:10,990 - INFO -      [83] ‚úì Forward pass completed in 0.009s, loss = 21.7983 (accum_step 1/4)
2025-11-03 10:00:11,268 - INFO -      [83] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:11,269 - INFO -      [83] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:11,488 - INFO -      [83] ‚úì Forward pass completed in 0.007s, loss = 21.4733 (accum_step 2/4)
2025-11-03 10:00:11,767 - INFO -      [83] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:11,767 - INFO -      [83] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:11,986 - INFO -      [83] ‚úì Forward pass completed in 0.006s, loss = 21.7020 (accum_step 3/4)
2025-11-03 10:00:12,265 - INFO -      [83] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:12,265 - INFO -      [83] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:12,276 - INFO -      [83] ‚úì Forward pass completed in 0.007s, loss = 21.1159 (accum_step 4/4)
2025-11-03 10:00:12,299 - INFO -      [84] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:13,556 - INFO -      [84] ‚úì Batch fetched in 1.257s
2025-11-03 10:00:13,775 - INFO -      [84] ‚úì Forward pass completed in 0.007s, loss = 21.8454 (accum_step 1/4)
2025-11-03 10:00:14,054 - INFO -      [84] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:14,055 - INFO -      [84] ‚úì Batch fetched in 0.001s
2025-11-03 10:00:14,273 - INFO -      [84] ‚úì Forward pass completed in 0.008s, loss = 21.4436 (accum_step 2/4)
2025-11-03 10:00:14,552 - INFO -      [84] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:14,552 - INFO -      [84] ‚úì Batch fetched in 0.001s
2025-11-03 10:00:14,771 - INFO -      [84] ‚úì Forward pass completed in 0.007s, loss = 21.7226 (accum_step 3/4)
2025-11-03 10:00:15,050 - INFO -      [84] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:15,051 - INFO -      [84] ‚úì Batch fetched in 0.001s
2025-11-03 10:00:15,267 - INFO -      [84] ‚úì Forward pass completed in 0.007s, loss = 21.9424 (accum_step 4/4)
2025-11-03 10:00:15,555 - INFO -   Step 85/100: loss = 21.7385, avg_loss = 78.5348, lr = 0.000100, grad_norm = 3.9166
2025-11-03 10:00:15,555 - INFO -     ‚è±Ô∏è  Timing: total=3.256s (fetch=1.259s, to_device=0.020s, spec_compute=0.003s, forward=0.029s, backward=0.047s, optim=0.010s)
2025-11-03 10:00:15,555 - INFO -      [85] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:15,556 - INFO -      [85] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:15,775 - INFO -      [85] ‚úì Forward pass completed in 0.006s, loss = 21.5511 (accum_step 1/4)
2025-11-03 10:00:16,053 - INFO -      [85] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:16,053 - INFO -      [85] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:16,272 - INFO -      [85] ‚úì Forward pass completed in 0.006s, loss = 21.4725 (accum_step 2/4)
2025-11-03 10:00:16,551 - INFO -      [85] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:16,551 - INFO -      [85] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:16,562 - INFO -      [85] ‚úì Forward pass completed in 0.007s, loss = 20.3479 (accum_step 3/4)
2025-11-03 10:00:16,576 - INFO -      [85] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:18,267 - INFO -      [85] ‚úì Batch fetched in 1.691s
2025-11-03 10:00:18,484 - INFO -      [85] ‚úì Forward pass completed in 0.007s, loss = 21.6062 (accum_step 4/4)
2025-11-03 10:00:18,774 - INFO -      [86] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:18,851 - INFO -      [86] ‚úì Batch fetched in 0.077s
2025-11-03 10:00:19,070 - INFO -      [86] ‚úì Forward pass completed in 0.006s, loss = 21.7876 (accum_step 1/4)
2025-11-03 10:00:19,350 - INFO -      [86] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:19,350 - INFO -      [86] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:19,569 - INFO -      [86] ‚úì Forward pass completed in 0.009s, loss = 21.3795 (accum_step 2/4)
2025-11-03 10:00:19,848 - INFO -      [86] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:19,848 - INFO -      [86] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:20,062 - INFO -      [86] ‚úì Forward pass completed in 0.007s, loss = 21.7055 (accum_step 3/4)
2025-11-03 10:00:20,341 - INFO -      [86] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:20,342 - INFO -      [86] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:20,560 - INFO -      [86] ‚úì Forward pass completed in 0.006s, loss = 21.4496 (accum_step 4/4)
2025-11-03 10:00:20,850 - INFO -      [87] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:20,850 - INFO -      [87] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:21,066 - INFO -      [87] ‚úì Forward pass completed in 0.007s, loss = 21.4085 (accum_step 1/4)
2025-11-03 10:00:21,344 - INFO -      [87] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:21,345 - INFO -      [87] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:21,355 - INFO -      [87] ‚úì Forward pass completed in 0.007s, loss = 22.1941 (accum_step 2/4)
2025-11-03 10:00:21,369 - INFO -      [87] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:22,511 - INFO -      [87] ‚úì Batch fetched in 1.142s
2025-11-03 10:00:22,725 - INFO -      [87] ‚úì Forward pass completed in 0.007s, loss = 20.9385 (accum_step 3/4)
2025-11-03 10:00:23,005 - INFO -      [87] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:23,005 - INFO -      [87] ‚úì Batch fetched in 0.001s
2025-11-03 10:00:23,224 - INFO -      [87] ‚úì Forward pass completed in 0.007s, loss = 21.3972 (accum_step 4/4)
2025-11-03 10:00:23,514 - INFO -      [88] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:23,527 - INFO -      [88] ‚úì Batch fetched in 0.013s
2025-11-03 10:00:23,745 - INFO -      [88] ‚úì Forward pass completed in 0.007s, loss = 21.4076 (accum_step 1/4)
2025-11-03 10:00:24,023 - INFO -      [88] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:24,023 - INFO -      [88] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:24,241 - INFO -      [88] ‚úì Forward pass completed in 0.007s, loss = 21.5260 (accum_step 2/4)
2025-11-03 10:00:24,521 - INFO -      [88] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:24,521 - INFO -      [88] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:24,735 - INFO -      [88] ‚úì Forward pass completed in 0.007s, loss = 21.4464 (accum_step 3/4)
2025-11-03 10:00:25,015 - INFO -      [88] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:25,015 - INFO -      [88] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:25,232 - INFO -      [88] ‚úì Forward pass completed in 0.006s, loss = 21.2995 (accum_step 4/4)
2025-11-03 10:00:25,520 - INFO -      [89] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:25,520 - INFO -      [89] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:25,530 - INFO -      [89] ‚úì Forward pass completed in 0.006s, loss = 21.4512 (accum_step 1/4)
2025-11-03 10:00:25,543 - INFO -      [89] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:27,801 - INFO -      [89] ‚úì Batch fetched in 2.258s
2025-11-03 10:00:28,020 - INFO -      [89] ‚úì Forward pass completed in 0.007s, loss = 21.4871 (accum_step 2/4)
2025-11-03 10:00:28,299 - INFO -      [89] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:28,299 - INFO -      [89] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:28,513 - INFO -      [89] ‚úì Forward pass completed in 0.007s, loss = 21.6334 (accum_step 3/4)
2025-11-03 10:00:28,793 - INFO -      [89] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:28,793 - INFO -      [89] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:29,012 - INFO -      [89] ‚úì Forward pass completed in 0.007s, loss = 21.3264 (accum_step 4/4)
2025-11-03 10:00:29,300 - INFO -   Step 90/100: loss = 21.4745, avg_loss = 75.3629, lr = 0.000100, grad_norm = 4.8542
2025-11-03 10:00:29,301 - INFO -     ‚è±Ô∏è  Timing: total=3.781s (fetch=2.259s, to_device=0.013s, spec_compute=0.002s, forward=0.027s, backward=0.047s, optim=0.009s)
2025-11-03 10:00:29,301 - INFO -      [90] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:29,301 - INFO -      [90] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:29,301 - INFO -      [90] Moving data to device cuda...
2025-11-03 10:00:29,304 - INFO -      [90] ‚úì Data moved to device in 0.004s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:00:29,305 - INFO -      [90] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:00:29,305 - INFO -      [90] Starting forward pass...
2025-11-03 10:00:29,517 - INFO -      [90] ‚úì Forward pass completed in 0.006s, loss = 21.3739 (accum_step 1/4)
2025-11-03 10:00:29,517 - INFO -      [90] Starting backward pass...
2025-11-03 10:00:29,529 - INFO -      [90] ‚úì Backward pass completed in 0.011s
2025-11-03 10:00:29,796 - INFO -      [90] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:29,796 - INFO -      [90] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:29,796 - INFO -      [90] Moving data to device cuda...
2025-11-03 10:00:29,802 - INFO -      [90] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:00:29,803 - INFO -      [90] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:00:29,803 - INFO -      [90] Starting forward pass...
2025-11-03 10:00:30,015 - INFO -      [90] ‚úì Forward pass completed in 0.006s, loss = 21.1096 (accum_step 2/4)
2025-11-03 10:00:30,015 - INFO -      [90] Starting backward pass...
2025-11-03 10:00:30,026 - INFO -      [90] ‚úì Backward pass completed in 0.011s
2025-11-03 10:00:30,294 - INFO -      [90] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:30,294 - INFO -      [90] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:30,294 - INFO -      [90] Moving data to device cuda...
2025-11-03 10:00:30,300 - INFO -      [90] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:00:30,301 - INFO -      [90] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:00:30,301 - INFO -      [90] Starting forward pass...
2025-11-03 10:00:30,513 - INFO -      [90] ‚úì Forward pass completed in 0.006s, loss = 20.9853 (accum_step 3/4)
2025-11-03 10:00:30,513 - INFO -      [90] Starting backward pass...
2025-11-03 10:00:30,524 - INFO -      [90] ‚úì Backward pass completed in 0.012s
2025-11-03 10:00:30,792 - INFO -      [90] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:30,792 - INFO -      [90] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:30,792 - INFO -      [90] Moving data to device cuda...
2025-11-03 10:00:30,792 - INFO -      [90] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 10:00:30,793 - INFO -      [90] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([3, 256, 512]))
2025-11-03 10:00:30,793 - INFO -      [90] Starting forward pass...
2025-11-03 10:00:30,802 - INFO -      [90] ‚úì Forward pass completed in 0.006s, loss = 20.5827 (accum_step 4/4)
2025-11-03 10:00:30,803 - INFO -      [90] Starting backward pass...
2025-11-03 10:00:30,814 - INFO -      [90] ‚úì Backward pass completed in 0.011s
2025-11-03 10:00:30,816 - INFO -      [90] Gradient clipping and optimizer step...
2025-11-03 10:00:30,825 - INFO -      [90] ‚úì Optimizer step completed in 0.009s, grad_norm = 4.2773
2025-11-03 10:00:30,825 - INFO -      [91] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:32,521 - INFO -      [91] ‚úì Batch fetched in 1.696s
2025-11-03 10:00:32,738 - INFO -      [91] ‚úì Forward pass completed in 0.007s, loss = 21.1667 (accum_step 1/4)
2025-11-03 10:00:33,017 - INFO -      [91] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:33,017 - INFO -      [91] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:33,233 - INFO -      [91] ‚úì Forward pass completed in 0.007s, loss = 21.0918 (accum_step 2/4)
2025-11-03 10:00:33,512 - INFO -      [91] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:33,513 - INFO -      [91] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:33,726 - INFO -      [91] ‚úì Forward pass completed in 0.006s, loss = 20.9303 (accum_step 3/4)
2025-11-03 10:00:34,005 - INFO -      [91] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:34,005 - INFO -      [91] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:34,224 - INFO -      [91] ‚úì Forward pass completed in 0.006s, loss = 21.1424 (accum_step 4/4)
2025-11-03 10:00:34,513 - INFO -      [92] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:34,513 - INFO -      [92] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:34,731 - INFO -      [92] ‚úì Forward pass completed in 0.006s, loss = 21.1417 (accum_step 1/4)
2025-11-03 10:00:35,009 - INFO -      [92] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:35,010 - INFO -      [92] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:35,228 - INFO -      [92] ‚úì Forward pass completed in 0.007s, loss = 21.2888 (accum_step 2/4)
2025-11-03 10:00:35,507 - INFO -      [92] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:35,508 - INFO -      [92] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:35,518 - INFO -      [92] ‚úì Forward pass completed in 0.007s, loss = 20.2966 (accum_step 3/4)
2025-11-03 10:00:35,532 - INFO -      [92] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:37,234 - INFO -      [92] ‚úì Batch fetched in 1.702s
2025-11-03 10:00:37,466 - INFO -      [92] ‚úì Forward pass completed in 0.007s, loss = 21.2363 (accum_step 4/4)
2025-11-03 10:00:37,760 - INFO -      [93] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:37,760 - INFO -      [93] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:37,974 - INFO -      [93] ‚úì Forward pass completed in 0.006s, loss = 21.0152 (accum_step 1/4)
2025-11-03 10:00:38,252 - INFO -      [93] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:38,253 - INFO -      [93] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:38,472 - INFO -      [93] ‚úì Forward pass completed in 0.006s, loss = 21.1704 (accum_step 2/4)
2025-11-03 10:00:38,751 - INFO -      [93] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:38,751 - INFO -      [93] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:38,967 - INFO -      [93] ‚úì Forward pass completed in 0.006s, loss = 21.0026 (accum_step 3/4)
2025-11-03 10:00:39,246 - INFO -      [93] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:39,247 - INFO -      [93] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:39,465 - INFO -      [93] ‚úì Forward pass completed in 0.006s, loss = 20.9785 (accum_step 4/4)
2025-11-03 10:00:39,753 - INFO -      [94] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:39,753 - INFO -      [94] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:39,967 - INFO -      [94] ‚úì Forward pass completed in 0.006s, loss = 21.0777 (accum_step 1/4)
2025-11-03 10:00:40,246 - INFO -      [94] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:40,246 - INFO -      [94] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:40,257 - INFO -      [94] ‚úì Forward pass completed in 0.006s, loss = 20.7243 (accum_step 2/4)
2025-11-03 10:00:40,271 - INFO -      [94] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:41,840 - INFO -      [94] ‚úì Batch fetched in 1.569s
2025-11-03 10:00:42,054 - INFO -      [94] ‚úì Forward pass completed in 0.007s, loss = 21.2355 (accum_step 3/4)
2025-11-03 10:00:42,334 - INFO -      [94] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:42,335 - INFO -      [94] ‚úì Batch fetched in 0.001s
2025-11-03 10:00:42,553 - INFO -      [94] ‚úì Forward pass completed in 0.008s, loss = 20.8354 (accum_step 4/4)
2025-11-03 10:00:42,845 - INFO -   Step 95/100: loss = 20.9682, avg_loss = 72.5027, lr = 0.000100, grad_norm = 4.8791
2025-11-03 10:00:42,845 - INFO -     ‚è±Ô∏è  Timing: total=3.091s (fetch=1.570s, to_device=0.009s, spec_compute=0.002s, forward=0.027s, backward=0.046s, optim=0.011s)
2025-11-03 10:00:42,845 - INFO -      [95] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:42,845 - INFO -      [95] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:43,063 - INFO -      [95] ‚úì Forward pass completed in 0.007s, loss = 20.7080 (accum_step 1/4)
2025-11-03 10:00:43,342 - INFO -      [95] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:43,345 - INFO -      [95] ‚úì Batch fetched in 0.003s
2025-11-03 10:00:43,561 - INFO -      [95] ‚úì Forward pass completed in 0.011s, loss = 20.8933 (accum_step 2/4)
2025-11-03 10:00:43,839 - INFO -      [95] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:43,840 - INFO -      [95] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:44,059 - INFO -      [95] ‚úì Forward pass completed in 0.007s, loss = 20.9983 (accum_step 3/4)
2025-11-03 10:00:44,338 - INFO -      [95] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:44,338 - INFO -      [95] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:44,552 - INFO -      [95] ‚úì Forward pass completed in 0.007s, loss = 20.8899 (accum_step 4/4)
2025-11-03 10:00:44,842 - INFO -      [96] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:44,842 - INFO -      [96] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:44,853 - INFO -      [96] ‚úì Forward pass completed in 0.007s, loss = 19.9945 (accum_step 1/4)
2025-11-03 10:00:44,866 - INFO -      [96] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:46,635 - INFO -      [96] ‚úì Batch fetched in 1.769s
2025-11-03 10:00:46,853 - INFO -      [96] ‚úì Forward pass completed in 0.007s, loss = 21.1136 (accum_step 2/4)
2025-11-03 10:00:47,132 - INFO -      [96] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:47,133 - INFO -      [96] ‚úì Batch fetched in 0.001s
2025-11-03 10:00:47,351 - INFO -      [96] ‚úì Forward pass completed in 0.007s, loss = 20.9251 (accum_step 3/4)
2025-11-03 10:00:47,630 - INFO -      [96] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:47,630 - INFO -      [96] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:47,848 - INFO -      [96] ‚úì Forward pass completed in 0.007s, loss = 20.7920 (accum_step 4/4)
2025-11-03 10:00:48,138 - INFO -      [97] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:48,138 - INFO -      [97] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:48,357 - INFO -      [97] ‚úì Forward pass completed in 0.006s, loss = 20.5315 (accum_step 1/4)
2025-11-03 10:00:48,636 - INFO -      [97] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:48,636 - INFO -      [97] ‚úì Batch fetched in 0.001s
2025-11-03 10:00:48,855 - INFO -      [97] ‚úì Forward pass completed in 0.008s, loss = 20.9787 (accum_step 2/4)
2025-11-03 10:00:49,134 - INFO -      [97] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:49,135 - INFO -      [97] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:49,349 - INFO -      [97] ‚úì Forward pass completed in 0.006s, loss = 20.8522 (accum_step 3/4)
2025-11-03 10:00:49,628 - INFO -      [97] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:49,628 - INFO -      [97] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:49,639 - INFO -      [97] ‚úì Forward pass completed in 0.007s, loss = 21.1797 (accum_step 4/4)
2025-11-03 10:00:49,662 - INFO -      [98] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:51,900 - INFO -      [98] ‚úì Batch fetched in 2.239s
2025-11-03 10:00:52,126 - INFO -      [98] ‚úì Forward pass completed in 0.007s, loss = 20.4367 (accum_step 1/4)
2025-11-03 10:00:52,405 - INFO -      [98] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:52,405 - INFO -      [98] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:52,624 - INFO -      [98] ‚úì Forward pass completed in 0.006s, loss = 20.6774 (accum_step 2/4)
2025-11-03 10:00:52,904 - INFO -      [98] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:52,904 - INFO -      [98] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:53,120 - INFO -      [98] ‚úì Forward pass completed in 0.007s, loss = 20.8113 (accum_step 3/4)
2025-11-03 10:00:53,400 - INFO -      [98] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:53,401 - INFO -      [98] ‚úì Batch fetched in 0.002s
2025-11-03 10:00:53,620 - INFO -      [98] ‚úì Forward pass completed in 0.008s, loss = 20.7265 (accum_step 4/4)
2025-11-03 10:00:53,909 - INFO -      [99] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:00:53,910 - INFO -      [99] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:54,128 - INFO -      [99] ‚úì Forward pass completed in 0.007s, loss = 20.4207 (accum_step 1/4)
2025-11-03 10:00:54,406 - INFO -      [99] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:00:54,406 - INFO -      [99] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:54,625 - INFO -      [99] ‚úì Forward pass completed in 0.008s, loss = 20.6100 (accum_step 2/4)
2025-11-03 10:00:54,904 - INFO -      [99] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:00:54,905 - INFO -      [99] ‚úì Batch fetched in 0.000s
2025-11-03 10:00:54,915 - INFO -      [99] ‚úì Forward pass completed in 0.006s, loss = 21.0192 (accum_step 3/4)
2025-11-03 10:00:54,929 - INFO -      [99] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:00:56,675 - INFO -      [99] ‚úì Batch fetched in 1.747s
2025-11-03 10:00:56,894 - INFO -      [99] ‚úì Forward pass completed in 0.009s, loss = 20.2116 (accum_step 4/4)
2025-11-03 10:00:57,184 - INFO -   Step 100/100: loss = 20.5654, avg_loss = 69.9145, lr = 0.000100, grad_norm = 4.6525
2025-11-03 10:00:57,184 - INFO -     ‚è±Ô∏è  Timing: total=3.275s (fetch=1.748s, to_device=0.016s, spec_compute=0.002s, forward=0.029s, backward=0.047s, optim=0.010s)
2025-11-03 10:00:57,184 - INFO - 
  üîç Starting validation at step 100...
2025-11-03 10:00:57,184 - INFO -      Applying EMA weights for validation...
2025-11-03 10:00:57,187 - INFO -      Running validation...
2025-11-03 10:00:59,089 - INFO -        Validation batch 1/None: loss = 293.1016
2025-11-03 10:00:59,518 - INFO -        Validation batch 2/None: loss = 293.2792
2025-11-03 10:01:00,509 - INFO -        Validation batch 3/None: loss = 289.3002
2025-11-03 10:01:02,011 - INFO -        Validation batch 5/None: loss = 288.3796
2025-11-03 10:01:05,462 - INFO -        Validation batch 10/None: loss = 292.1308
2025-11-03 10:01:09,655 - INFO -        Validation batch 15/None: loss = 293.3293
2025-11-03 10:01:13,873 - INFO -        Validation batch 20/None: loss = 292.4968
2025-11-03 10:01:17,010 - INFO -        Validation batch 25/None: loss = 288.7117
2025-11-03 10:01:17,105 - INFO -      ‚úì Validation complete: avg_loss = 292.4873 (26 batches)
2025-11-03 10:01:17,105 - INFO -      Restoring training weights...
2025-11-03 10:01:17,106 - INFO -   ‚úì Validation completed in 19.92s
2025-11-03 10:01:17,106 - INFO -      üéØ New best validation loss: 292.4873 (previous: 296.2319)
2025-11-03 10:01:17,106 - INFO -      Saving best model checkpoint...
2025-11-03 10:01:17,304 - INFO -   ‚úì Saved best model to /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint/best_A100_pretraining_test_model.pt (async)
2025-11-03 10:01:17,314 - INFO - 
  üíæ Saving periodic checkpoint at step 100...
2025-11-03 10:01:17,328 - INFO -      Checkpoint size: ~170.4 MB
2025-11-03 10:01:17,335 - INFO -   ‚úì Checkpoint saved to /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint/A100_pretraining_test_step_100.pt (async)
2025-11-03 10:01:17,340 - INFO - 
================================================================================
2025-11-03 10:01:17,346 - INFO - TRAINING SUMMARY:
2025-11-03 10:01:17,351 - INFO -   Steps Completed: 100
2025-11-03 10:01:17,351 - INFO -   Average Loss: 69.9145
2025-11-03 10:01:17,351 - INFO -   Best Validation Loss: 292.4873
2025-11-03 10:01:17,351 - INFO - ================================================================================
2025-11-03 10:01:17,351 - INFO - 
================================================================================
2025-11-03 10:01:17,351 - INFO - TRAINING COMPLETED
2025-11-03 10:01:17,351 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:01:17,354 - INFO - Final step: 100
2025-11-03 10:01:17,354 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 10:01:17,354 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:01:17,354 - INFO - ================================================================================
2025-11-03 10:02:01,095 - INFO - ================================================================================
2025-11-03 10:02:01,095 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 10:02:01,095 - INFO - ================================================================================
2025-11-03 10:02:01,095 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:02:01,095 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:02:01,095 - INFO - ================================================================================
2025-11-03 10:02:01,100 - INFO - Device: cuda
2025-11-03 10:02:01,100 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 10:02:01,100 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 10:02:01,100 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 10:02:01,100 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=False
2025-11-03 10:02:01,100 - INFO -   Batch size: 128, Steps: 10
2025-11-03 10:02:01,100 - INFO -   Validation interval: 20 steps
2025-11-03 10:02:01,100 - INFO -   Log interval: 5 steps
2025-11-03 10:02:01,100 - INFO - 
Initializing model...
2025-11-03 10:02:01,939 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 10:02:01,939 - INFO -   Total parameters: 44,674,663
2025-11-03 10:02:01,940 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 10:02:07,881 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 10:02:07,881 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 10:02:07,889 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 10:02:07,889 - INFO - 
Setting up datasets...
2025-11-03 10:02:07,889 - INFO -   Loading MAESTRO dataset...
2025-11-03 10:02:16,117 - INFO -   ‚úì MAESTRO train: 200 samples (cached)
2025-11-03 10:02:16,118 - INFO -   ‚úì MAESTRO val: 137 samples (cached)
2025-11-03 10:02:16,119 - INFO -   Loading SLAKH stems dataset...
2025-11-03 10:02:23,946 - INFO -   ‚úì SLAKH stems train: 521 samples (cached)
2025-11-03 10:02:30,078 - INFO -   ‚úì SLAKH stems val: 2833 samples (cached)
2025-11-03 10:02:30,079 - INFO -   Loading SLAKH mix dataset...
2025-11-03 10:02:31,787 - INFO -   ‚úì SLAKH mix train: 50 samples (cached)
2025-11-03 10:02:31,840 - INFO -   ‚úì SLAKH mix val: 270 samples (cached)
2025-11-03 10:02:31,840 - INFO - 
  Creating multi-task dataset...
2025-11-03 10:02:31,840 - INFO -   ‚úì Multi-task dataset: 771 total samples
2025-11-03 10:02:31,840 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0}
2025-11-03 10:02:31,840 - INFO - 
  Setting up validation data...
2025-11-03 10:02:31,840 - INFO -   ‚úì Validation: 3240 samples
2025-11-03 10:02:31,842 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 10:02:31,842 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 10:02:31,842 - INFO -   Label smoothing: 0.1
2025-11-03 10:02:31,842 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 10:02:31,842 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 10:02:31,842 - INFO - 
Starting training...
2025-11-03 10:02:31,842 - INFO -   Total steps: 10
2025-11-03 10:02:31,842 - INFO -   Batch size: 128
2025-11-03 10:02:31,842 - INFO -   Learning rate: 0.0001
2025-11-03 10:02:31,842 - INFO -   Weight decay: 0.1
2025-11-03 10:02:31,842 - INFO -   Log interval: 5 steps
2025-11-03 10:02:31,842 - INFO -   Validation interval: 20 steps
2025-11-03 10:02:31,842 - INFO -   Save interval: 100 steps
2025-11-03 10:02:31,843 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 10:02:31,908 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 10:02:31,908 - INFO - 
================================================================================
2025-11-03 10:02:31,908 - INFO - STEP-BASED TRAINING
2025-11-03 10:02:31,908 - INFO -   Starting from step: 0
2025-11-03 10:02:31,908 - INFO -   Target steps: 10
2025-11-03 10:02:31,908 - INFO -   Batch size: 128
2025-11-03 10:02:31,909 - INFO -   Gradient accumulation steps: 4
2025-11-03 10:02:31,909 - INFO -   Effective batch size: 512
2025-11-03 10:02:31,909 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 10:02:31,909 - INFO - ================================================================================
2025-11-03 10:02:31,909 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 10:02:31,909 - INFO - 
üöÄ Starting training loop...
2025-11-03 10:02:31,909 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 10:02:31,909 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:02:34,430 - INFO -      [0] ‚úì Batch fetched in 2.521s
2025-11-03 10:02:34,430 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:02:34,441 - INFO -      [0] ‚úì Data moved to device in 0.010s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:02:35,268 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.827s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:02:35,268 - INFO -      [0] Starting forward pass...
2025-11-03 10:02:38,216 - INFO -      [0] ‚úì Forward pass completed in 2.947s, loss = 291.1241 (accum_step 1/4)
2025-11-03 10:02:38,216 - INFO -      [0] Starting backward pass...
2025-11-03 10:02:38,538 - INFO -      [0] ‚úì Backward pass completed in 0.322s
2025-11-03 10:02:38,559 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:02:38,560 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:38,560 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:02:38,566 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:02:38,567 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:02:38,567 - INFO -      [0] Starting forward pass...
2025-11-03 10:02:38,779 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 293.0616 (accum_step 2/4)
2025-11-03 10:02:38,780 - INFO -      [0] Starting backward pass...
2025-11-03 10:02:38,794 - INFO -      [0] ‚úì Backward pass completed in 0.014s
2025-11-03 10:02:39,039 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:02:39,039 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:39,039 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:02:39,045 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:02:39,045 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:02:39,046 - INFO -      [0] Starting forward pass...
2025-11-03 10:02:39,258 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 293.0715 (accum_step 3/4)
2025-11-03 10:02:39,258 - INFO -      [0] Starting backward pass...
2025-11-03 10:02:39,269 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:02:39,518 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:02:39,518 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:39,518 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:02:39,524 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:02:39,525 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:02:39,525 - INFO -      [0] Starting forward pass...
2025-11-03 10:02:39,737 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 290.8759 (accum_step 4/4)
2025-11-03 10:02:39,737 - INFO -      [0] Starting backward pass...
2025-11-03 10:02:39,748 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:02:39,996 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 10:02:40,703 - INFO -      [0] ‚úì Optimizer step completed in 0.707s, grad_norm = 323.8850
2025-11-03 10:02:40,704 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:02:40,704 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:40,704 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:02:40,717 - INFO -      [1] ‚úì Data moved to device in 0.013s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:02:40,718 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:02:40,718 - INFO -      [1] Starting forward pass...
2025-11-03 10:02:40,932 - INFO -      [1] ‚úì Forward pass completed in 0.040s, loss = 289.7843 (accum_step 1/4)
2025-11-03 10:02:40,932 - INFO -      [1] Starting backward pass...
2025-11-03 10:02:40,948 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 10:02:41,198 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:02:41,199 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:41,199 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:02:41,207 - INFO -      [1] ‚úì Data moved to device in 0.008s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:02:41,208 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:02:41,208 - INFO -      [1] Starting forward pass...
2025-11-03 10:02:41,421 - INFO -      [1] ‚úì Forward pass completed in 0.012s, loss = 290.7373 (accum_step 2/4)
2025-11-03 10:02:41,421 - INFO -      [1] Starting backward pass...
2025-11-03 10:02:41,438 - INFO -      [1] ‚úì Backward pass completed in 0.017s
2025-11-03 10:02:41,681 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:02:41,681 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:41,681 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:02:41,681 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 10:02:41,683 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([3, 256, 512]))
2025-11-03 10:02:41,683 - INFO -      [1] Starting forward pass...
2025-11-03 10:02:44,375 - INFO -      [1] ‚úì Forward pass completed in 2.691s, loss = 296.0812 (accum_step 3/4)
2025-11-03 10:02:44,375 - INFO -      [1] Starting backward pass...
2025-11-03 10:02:44,390 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 10:02:44,392 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:02:45,908 - INFO -      [1] ‚úì Batch fetched in 1.515s
2025-11-03 10:02:45,908 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:02:45,915 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:02:45,916 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:02:45,916 - INFO -      [1] Starting forward pass...
2025-11-03 10:02:46,137 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 288.2697 (accum_step 4/4)
2025-11-03 10:02:46,138 - INFO -      [1] Starting backward pass...
2025-11-03 10:02:46,150 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 10:02:46,418 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 10:02:46,427 - INFO -      [1] ‚úì Optimizer step completed in 0.009s, grad_norm = 327.2297
2025-11-03 10:02:46,427 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:02:46,428 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:46,428 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:02:46,432 - INFO -      [2] ‚úì Data moved to device in 0.004s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:02:46,433 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:02:46,433 - INFO -      [2] Starting forward pass...
2025-11-03 10:02:46,645 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.1779 (accum_step 1/4)
2025-11-03 10:02:46,645 - INFO -      [2] Starting backward pass...
2025-11-03 10:02:46,656 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:02:46,924 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:02:46,924 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:46,925 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:02:46,930 - INFO -      [2] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:02:46,931 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:02:46,931 - INFO -      [2] Starting forward pass...
2025-11-03 10:02:47,143 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.3393 (accum_step 2/4)
2025-11-03 10:02:47,143 - INFO -      [2] Starting backward pass...
2025-11-03 10:02:47,154 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:02:47,423 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:02:47,423 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:47,424 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:02:47,429 - INFO -      [2] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:02:47,430 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:02:47,430 - INFO -      [2] Starting forward pass...
2025-11-03 10:02:47,642 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.1927 (accum_step 3/4)
2025-11-03 10:02:47,643 - INFO -      [2] Starting backward pass...
2025-11-03 10:02:47,653 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:02:47,923 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:02:47,923 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:47,923 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:02:47,924 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:02:47,924 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:02:47,924 - INFO -      [2] Starting forward pass...
2025-11-03 10:02:48,137 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 291.7756 (accum_step 4/4)
2025-11-03 10:02:48,137 - INFO -      [2] Starting backward pass...
2025-11-03 10:02:48,148 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:02:48,417 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 10:02:48,425 - INFO -      [2] ‚úì Optimizer step completed in 0.008s, grad_norm = 327.2442
2025-11-03 10:02:48,426 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:02:48,426 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:48,644 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 286.3653 (accum_step 1/4)
2025-11-03 10:02:48,923 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:02:48,923 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:48,934 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 292.0156 (accum_step 2/4)
2025-11-03 10:02:48,947 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:02:50,735 - INFO -      [3] ‚úì Batch fetched in 1.788s
2025-11-03 10:02:50,955 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 284.7545 (accum_step 3/4)
2025-11-03 10:02:51,235 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:02:51,236 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:51,450 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 286.8999 (accum_step 4/4)
2025-11-03 10:02:51,739 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:02:51,739 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:51,958 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 279.0454 (accum_step 1/4)
2025-11-03 10:02:52,237 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:02:52,237 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:52,456 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 279.6484 (accum_step 2/4)
2025-11-03 10:02:52,737 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:02:52,737 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:52,956 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 280.6211 (accum_step 3/4)
2025-11-03 10:02:53,235 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:02:53,236 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:53,454 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 281.8135 (accum_step 4/4)
2025-11-03 10:02:53,743 - INFO -   Step 5/10: loss = 280.2821, avg_loss = 288.0327, lr = 0.000011, grad_norm = 331.7500
2025-11-03 10:02:53,743 - INFO -     ‚è±Ô∏è  Timing: total=2.004s (fetch=0.001s, to_device=0.023s, spec_compute=0.002s, forward=0.025s, backward=0.043s, optim=0.009s)
2025-11-03 10:02:53,743 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:02:53,743 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:53,754 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 285.3742 (accum_step 1/4)
2025-11-03 10:02:53,767 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:02:55,438 - INFO -      [5] ‚úì Batch fetched in 1.671s
2025-11-03 10:02:55,658 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 272.3881 (accum_step 2/4)
2025-11-03 10:02:55,938 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:02:55,938 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:56,157 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 267.7396 (accum_step 3/4)
2025-11-03 10:02:56,436 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:02:56,437 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:56,656 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 271.6114 (accum_step 4/4)
2025-11-03 10:02:56,944 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:02:56,944 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:57,162 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.7929 (accum_step 1/4)
2025-11-03 10:02:57,441 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:02:57,441 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:57,658 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.7072 (accum_step 2/4)
2025-11-03 10:02:57,936 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:02:57,937 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:58,156 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.3292 (accum_step 3/4)
2025-11-03 10:02:58,435 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:02:58,435 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:02:58,445 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 274.5582 (accum_step 4/4)
2025-11-03 10:02:58,466 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:03:00,259 - INFO -      [7] ‚úì Batch fetched in 1.792s
2025-11-03 10:03:00,495 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 252.8150 (accum_step 1/4)
2025-11-03 10:03:00,775 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:03:00,775 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:03:00,995 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 253.2111 (accum_step 2/4)
2025-11-03 10:03:01,273 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:03:01,274 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:03:01,492 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.0071 (accum_step 3/4)
2025-11-03 10:03:01,771 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:03:01,772 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:03:01,991 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.7381 (accum_step 4/4)
2025-11-03 10:03:02,278 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:03:02,278 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:03:02,497 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.2992 (accum_step 1/4)
2025-11-03 10:03:02,776 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:03:02,776 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:03:02,993 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.2614 (accum_step 2/4)
2025-11-03 10:03:03,272 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:03:03,272 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:03:03,282 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 234.9925 (accum_step 3/4)
2025-11-03 10:03:03,296 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:03:05,003 - INFO -      [8] ‚úì Batch fetched in 1.707s
2025-11-03 10:03:05,223 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 236.0593 (accum_step 4/4)
2025-11-03 10:03:05,512 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:03:05,512 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:03:05,726 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 224.6680 (accum_step 1/4)
2025-11-03 10:03:06,005 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:03:06,006 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:03:06,224 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 226.2681 (accum_step 2/4)
2025-11-03 10:03:06,503 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:03:06,504 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:03:06,723 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 226.2916 (accum_step 3/4)
2025-11-03 10:03:07,002 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:03:07,003 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:03:07,221 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 225.2049 (accum_step 4/4)
2025-11-03 10:03:07,510 - INFO -   Step 10/10: loss = 225.6081, avg_loss = 269.4493, lr = 0.000021, grad_norm = 277.8607
2025-11-03 10:03:07,510 - INFO -     ‚è±Ô∏è  Timing: total=1.998s (fetch=0.001s, to_device=0.018s, spec_compute=0.002s, forward=0.025s, backward=0.043s, optim=0.009s)
2025-11-03 10:03:07,510 - INFO - 
================================================================================
2025-11-03 10:03:07,510 - INFO - TRAINING SUMMARY:
2025-11-03 10:03:07,510 - INFO -   Steps Completed: 10
2025-11-03 10:03:07,510 - INFO -   Average Loss: 269.4493
2025-11-03 10:03:07,510 - INFO -   Best Validation Loss: inf
2025-11-03 10:03:07,510 - INFO - ================================================================================
2025-11-03 10:03:07,510 - INFO - 
================================================================================
2025-11-03 10:03:07,510 - INFO - TRAINING COMPLETED
2025-11-03 10:03:07,511 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:03:07,511 - INFO - Final step: 10
2025-11-03 10:03:07,511 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 10:03:07,511 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:03:07,511 - INFO - ================================================================================
2025-11-03 10:38:26,997 - INFO - ================================================================================
2025-11-03 10:38:26,998 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 10:38:26,998 - INFO - ================================================================================
2025-11-03 10:38:26,998 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:38:26,998 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:38:26,998 - INFO - ================================================================================
2025-11-03 10:38:26,999 - INFO - Device: cuda
2025-11-03 10:38:26,999 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 10:38:26,999 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 10:38:26,999 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 10:38:26,999 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=False
2025-11-03 10:38:26,999 - INFO -   Batch size: 128, Steps: 10
2025-11-03 10:38:26,999 - INFO -   Validation interval: 20 steps
2025-11-03 10:38:26,999 - INFO -   Log interval: 5 steps
2025-11-03 10:38:26,999 - INFO - 
Initializing model...
2025-11-03 10:38:27,584 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 10:38:27,585 - INFO -   Total parameters: 44,674,663
2025-11-03 10:38:27,585 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 10:38:31,064 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 10:38:31,065 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 10:38:31,073 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 10:38:31,073 - INFO - 
Setting up datasets...
2025-11-03 10:38:31,073 - INFO -   Loading MAESTRO dataset...
2025-11-03 10:38:32,769 - INFO -   ‚úì MAESTRO train: 200 samples (cached)
2025-11-03 10:38:32,770 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 10:38:32,770 - INFO -   Loading SLAKH stems dataset...
2025-11-03 10:38:34,461 - INFO -   ‚úì SLAKH stems train: 521 samples (cached)
2025-11-03 10:38:34,988 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 10:38:34,988 - INFO -   Loading SLAKH mix dataset...
2025-11-03 10:38:36,679 - INFO -   ‚úì SLAKH mix train: 50 samples (cached)
2025-11-03 10:38:36,742 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 10:38:36,742 - INFO - 
  Creating multi-task dataset...
2025-11-03 10:38:36,742 - INFO -   ‚úì Multi-task dataset: 771 total samples
2025-11-03 10:38:36,742 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0}
2025-11-03 10:38:36,742 - INFO - 
  Setting up validation data...
2025-11-03 10:38:36,742 - INFO -   ‚úì Validation: 247 samples
2025-11-03 10:38:36,744 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 10:38:36,744 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 10:38:36,744 - INFO -   Label smoothing: 0.1
2025-11-03 10:38:36,744 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 10:38:36,744 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 10:38:36,744 - INFO - 
Starting training...
2025-11-03 10:38:36,744 - INFO -   Total steps: 10
2025-11-03 10:38:36,744 - INFO -   Batch size: 128
2025-11-03 10:38:36,744 - INFO -   Learning rate: 0.0001
2025-11-03 10:38:36,744 - INFO -   Weight decay: 0.1
2025-11-03 10:38:36,744 - INFO -   Log interval: 5 steps
2025-11-03 10:38:36,744 - INFO -   Validation interval: 20 steps
2025-11-03 10:38:36,744 - INFO -   Save interval: 100 steps
2025-11-03 10:38:36,745 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 10:38:36,806 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 10:38:36,806 - INFO - 
================================================================================
2025-11-03 10:38:36,807 - INFO - STEP-BASED TRAINING
2025-11-03 10:38:36,807 - INFO -   Starting from step: 0
2025-11-03 10:38:36,807 - INFO -   Target steps: 10
2025-11-03 10:38:36,807 - INFO -   Batch size: 128
2025-11-03 10:38:36,807 - INFO -   Gradient accumulation steps: 4
2025-11-03 10:38:36,807 - INFO -   Effective batch size: 512
2025-11-03 10:38:36,807 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 10:38:36,807 - INFO - ================================================================================
2025-11-03 10:38:36,807 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 10:38:36,807 - INFO - 
üöÄ Starting training loop...
2025-11-03 10:38:36,807 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 10:38:36,807 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:38:38,814 - INFO -      [0] ‚úì Batch fetched in 2.007s
2025-11-03 10:38:38,814 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:38:38,815 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:38:39,087 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.271s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:38:39,087 - INFO -      [0] Starting forward pass...
2025-11-03 10:38:41,637 - INFO -      [0] ‚úì Forward pass completed in 2.550s, loss = 290.0146 (accum_step 1/4)
2025-11-03 10:38:41,637 - INFO -      [0] Starting backward pass...
2025-11-03 10:38:41,951 - INFO -      [0] ‚úì Backward pass completed in 0.314s
2025-11-03 10:38:41,972 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:38:43,473 - INFO -      [0] ‚úì Batch fetched in 1.502s
2025-11-03 10:38:43,474 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:38:43,475 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:38:43,476 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:38:43,476 - INFO -      [0] Starting forward pass...
2025-11-03 10:38:43,689 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 292.4609 (accum_step 2/4)
2025-11-03 10:38:43,689 - INFO -      [0] Starting backward pass...
2025-11-03 10:38:43,704 - INFO -      [0] ‚úì Backward pass completed in 0.015s
2025-11-03 10:38:43,949 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:38:45,728 - INFO -      [0] ‚úì Batch fetched in 1.778s
2025-11-03 10:38:45,728 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:38:45,735 - INFO -      [0] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:38:45,735 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:38:45,736 - INFO -      [0] Starting forward pass...
2025-11-03 10:38:45,948 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 292.8611 (accum_step 3/4)
2025-11-03 10:38:45,948 - INFO -      [0] Starting backward pass...
2025-11-03 10:38:45,960 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:38:46,208 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:38:48,117 - INFO -      [0] ‚úì Batch fetched in 1.909s
2025-11-03 10:38:48,117 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:38:48,125 - INFO -      [0] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:38:48,125 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:38:48,125 - INFO -      [0] Starting forward pass...
2025-11-03 10:38:48,349 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 293.0827 (accum_step 4/4)
2025-11-03 10:38:48,349 - INFO -      [0] Starting backward pass...
2025-11-03 10:38:48,360 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:38:48,608 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 10:38:48,708 - INFO -      [0] ‚úì Optimizer step completed in 0.099s, grad_norm = 325.3829
2025-11-03 10:38:48,708 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:38:50,765 - INFO -      [1] ‚úì Batch fetched in 2.057s
2025-11-03 10:38:50,765 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:38:50,772 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:38:50,781 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.009s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:38:50,782 - INFO -      [1] Starting forward pass...
2025-11-03 10:38:50,994 - INFO -      [1] ‚úì Forward pass completed in 0.038s, loss = 295.7601 (accum_step 1/4)
2025-11-03 10:38:50,995 - INFO -      [1] Starting backward pass...
2025-11-03 10:38:51,009 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 10:38:51,254 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:38:52,695 - INFO -      [1] ‚úì Batch fetched in 1.441s
2025-11-03 10:38:52,695 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:38:52,702 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:38:52,703 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:38:52,703 - INFO -      [1] Starting forward pass...
2025-11-03 10:38:52,916 - INFO -      [1] ‚úì Forward pass completed in 0.010s, loss = 291.2142 (accum_step 2/4)
2025-11-03 10:38:52,916 - INFO -      [1] Starting backward pass...
2025-11-03 10:38:52,931 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 10:38:53,175 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:38:53,340 - INFO -      [1] ‚úì Batch fetched in 0.164s
2025-11-03 10:38:53,340 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:38:53,340 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 10:38:53,342 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([3, 256, 512]))
2025-11-03 10:38:53,342 - INFO -      [1] Starting forward pass...
2025-11-03 10:38:55,965 - INFO -      [1] ‚úì Forward pass completed in 2.623s, loss = 295.1045 (accum_step 3/4)
2025-11-03 10:38:55,966 - INFO -      [1] Starting backward pass...
2025-11-03 10:38:55,982 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 10:38:55,984 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:38:57,613 - INFO -      [1] ‚úì Batch fetched in 1.629s
2025-11-03 10:38:57,613 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:38:57,620 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:38:57,621 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:38:57,621 - INFO -      [1] Starting forward pass...
2025-11-03 10:38:57,852 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 291.7719 (accum_step 4/4)
2025-11-03 10:38:57,852 - INFO -      [1] Starting backward pass...
2025-11-03 10:38:57,864 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 10:38:58,135 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 10:38:58,144 - INFO -      [1] ‚úì Optimizer step completed in 0.009s, grad_norm = 331.4434
2025-11-03 10:38:58,144 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:38:59,551 - INFO -      [2] ‚úì Batch fetched in 1.407s
2025-11-03 10:38:59,551 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:38:59,558 - INFO -      [2] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:38:59,559 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:38:59,559 - INFO -      [2] Starting forward pass...
2025-11-03 10:38:59,771 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 287.6533 (accum_step 1/4)
2025-11-03 10:38:59,771 - INFO -      [2] Starting backward pass...
2025-11-03 10:38:59,782 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:39:00,050 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:39:01,699 - INFO -      [2] ‚úì Batch fetched in 1.649s
2025-11-03 10:39:01,700 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:39:01,706 - INFO -      [2] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:39:01,707 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:39:01,707 - INFO -      [2] Starting forward pass...
2025-11-03 10:39:01,920 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 287.3639 (accum_step 2/4)
2025-11-03 10:39:01,920 - INFO -      [2] Starting backward pass...
2025-11-03 10:39:01,931 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 10:39:02,199 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:39:04,093 - INFO -      [2] ‚úì Batch fetched in 1.894s
2025-11-03 10:39:04,093 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:39:04,100 - INFO -      [2] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:39:04,101 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:39:04,101 - INFO -      [2] Starting forward pass...
2025-11-03 10:39:04,334 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 290.7712 (accum_step 3/4)
2025-11-03 10:39:04,334 - INFO -      [2] Starting backward pass...
2025-11-03 10:39:04,345 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:39:04,614 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:39:05,995 - INFO -      [2] ‚úì Batch fetched in 1.380s
2025-11-03 10:39:05,995 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:39:06,002 - INFO -      [2] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:39:06,002 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:39:06,002 - INFO -      [2] Starting forward pass...
2025-11-03 10:39:06,215 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 291.8638 (accum_step 4/4)
2025-11-03 10:39:06,215 - INFO -      [2] Starting backward pass...
2025-11-03 10:39:06,227 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:39:06,495 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 10:39:06,504 - INFO -      [2] ‚úì Optimizer step completed in 0.009s, grad_norm = 326.9391
2025-11-03 10:39:06,505 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:39:08,480 - INFO -      [3] ‚úì Batch fetched in 1.975s
2025-11-03 10:39:08,713 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 286.0807 (accum_step 1/4)
2025-11-03 10:39:08,996 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:39:09,068 - INFO -      [3] ‚úì Batch fetched in 0.072s
2025-11-03 10:39:09,079 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 272.4684 (accum_step 2/4)
2025-11-03 10:39:09,093 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:39:10,910 - INFO -      [3] ‚úì Batch fetched in 1.818s
2025-11-03 10:39:11,151 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 282.6570 (accum_step 3/4)
2025-11-03 10:39:11,438 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:39:12,752 - INFO -      [3] ‚úì Batch fetched in 1.314s
2025-11-03 10:39:12,966 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 285.4396 (accum_step 4/4)
2025-11-03 10:39:13,256 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:39:14,580 - INFO -      [4] ‚úì Batch fetched in 1.324s
2025-11-03 10:39:14,801 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 278.2820 (accum_step 1/4)
2025-11-03 10:39:15,080 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:39:16,487 - INFO -      [4] ‚úì Batch fetched in 1.407s
2025-11-03 10:39:16,707 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 278.3768 (accum_step 2/4)
2025-11-03 10:39:16,987 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:39:18,562 - INFO -      [4] ‚úì Batch fetched in 1.575s
2025-11-03 10:39:18,782 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 277.2018 (accum_step 3/4)
2025-11-03 10:39:19,062 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:39:20,784 - INFO -      [4] ‚úì Batch fetched in 1.722s
2025-11-03 10:39:21,018 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 276.2234 (accum_step 4/4)
2025-11-03 10:39:21,308 - INFO -   Step 5/10: loss = 277.5210, avg_loss = 286.8326, lr = 0.000011, grad_norm = 327.9409
2025-11-03 10:39:21,308 - INFO -     ‚è±Ô∏è  Timing: total=8.052s (fetch=6.028s, to_device=0.026s, spec_compute=0.003s, forward=0.027s, backward=0.045s, optim=0.009s)
2025-11-03 10:39:21,308 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:39:21,346 - INFO -      [5] ‚úì Batch fetched in 0.038s
2025-11-03 10:39:21,357 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 278.1203 (accum_step 1/4)
2025-11-03 10:39:21,370 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:39:22,733 - INFO -      [5] ‚úì Batch fetched in 1.363s
2025-11-03 10:39:22,953 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 275.3315 (accum_step 2/4)
2025-11-03 10:39:23,233 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:39:24,308 - INFO -      [5] ‚úì Batch fetched in 1.076s
2025-11-03 10:39:24,523 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 272.9300 (accum_step 3/4)
2025-11-03 10:39:24,803 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:39:26,618 - INFO -      [5] ‚úì Batch fetched in 1.815s
2025-11-03 10:39:26,852 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 270.2317 (accum_step 4/4)
2025-11-03 10:39:27,143 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:39:28,549 - INFO -      [6] ‚úì Batch fetched in 1.406s
2025-11-03 10:39:28,769 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 260.5970 (accum_step 1/4)
2025-11-03 10:39:29,048 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:39:30,505 - INFO -      [6] ‚úì Batch fetched in 1.457s
2025-11-03 10:39:30,725 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 261.6462 (accum_step 2/4)
2025-11-03 10:39:31,005 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:39:32,618 - INFO -      [6] ‚úì Batch fetched in 1.613s
2025-11-03 10:39:32,838 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 263.5596 (accum_step 3/4)
2025-11-03 10:39:33,118 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:39:33,199 - INFO -      [6] ‚úì Batch fetched in 0.081s
2025-11-03 10:39:33,209 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 265.0895 (accum_step 4/4)
2025-11-03 10:39:33,232 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:39:34,728 - INFO -      [7] ‚úì Batch fetched in 1.496s
2025-11-03 10:39:34,948 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 248.2047 (accum_step 1/4)
2025-11-03 10:39:35,227 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:39:36,839 - INFO -      [7] ‚úì Batch fetched in 1.611s
2025-11-03 10:39:37,053 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.4245 (accum_step 2/4)
2025-11-03 10:39:37,333 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:39:38,808 - INFO -      [7] ‚úì Batch fetched in 1.475s
2025-11-03 10:39:39,023 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.9812 (accum_step 3/4)
2025-11-03 10:39:39,303 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:39:41,300 - INFO -      [7] ‚úì Batch fetched in 1.997s
2025-11-03 10:39:41,541 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 251.2312 (accum_step 4/4)
2025-11-03 10:39:41,834 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:39:43,553 - INFO -      [8] ‚úì Batch fetched in 1.719s
2025-11-03 10:39:43,784 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 241.6590 (accum_step 1/4)
2025-11-03 10:39:44,064 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:39:45,915 - INFO -      [8] ‚úì Batch fetched in 1.851s
2025-11-03 10:39:46,145 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 241.0666 (accum_step 2/4)
2025-11-03 10:39:46,426 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:39:46,488 - INFO -      [8] ‚úì Batch fetched in 0.062s
2025-11-03 10:39:46,498 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 234.7746 (accum_step 3/4)
2025-11-03 10:39:46,512 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:39:48,348 - INFO -      [8] ‚úì Batch fetched in 1.836s
2025-11-03 10:39:48,588 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 237.4152 (accum_step 4/4)
2025-11-03 10:43:50,192 - INFO - ================================================================================
2025-11-03 10:43:50,192 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 10:43:50,192 - INFO - ================================================================================
2025-11-03 10:43:50,192 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:43:50,192 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:43:50,192 - INFO - ================================================================================
2025-11-03 10:43:50,193 - INFO - Device: cuda
2025-11-03 10:43:50,193 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 10:43:50,193 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 10:43:50,193 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 10:43:50,193 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=False
2025-11-03 10:43:50,193 - INFO -   Batch size: 128, Steps: 10
2025-11-03 10:43:50,193 - INFO -   Validation interval: 20 steps
2025-11-03 10:43:50,193 - INFO -   Log interval: 5 steps
2025-11-03 10:43:50,193 - INFO - 
Initializing model...
2025-11-03 10:43:50,793 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 10:43:50,794 - INFO -   Total parameters: 44,674,663
2025-11-03 10:43:50,794 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 10:43:53,906 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 10:43:53,906 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 10:43:53,915 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 10:43:53,915 - INFO - 
Setting up datasets...
2025-11-03 10:43:53,915 - INFO -   Loading MAESTRO dataset...
2025-11-03 10:43:55,655 - INFO -   ‚úì MAESTRO train: 200 samples (cached)
2025-11-03 10:43:55,656 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 10:43:55,656 - INFO -   Loading SLAKH stems dataset...
2025-11-03 10:43:57,363 - INFO -   ‚úì SLAKH stems train: 521 samples (cached)
2025-11-03 10:43:57,886 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 10:43:57,886 - INFO -   Loading SLAKH mix dataset...
2025-11-03 10:43:59,608 - INFO -   ‚úì SLAKH mix train: 50 samples (cached)
2025-11-03 10:43:59,671 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 10:43:59,671 - INFO - 
  Creating multi-task dataset...
2025-11-03 10:43:59,671 - INFO -   ‚úì Multi-task dataset: 771 total samples
2025-11-03 10:43:59,671 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0}
2025-11-03 10:43:59,671 - INFO - 
  Setting up validation data...
2025-11-03 10:43:59,672 - INFO -   ‚úì Validation: 247 samples
2025-11-03 10:43:59,673 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 10:43:59,673 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 10:43:59,673 - INFO -   Label smoothing: 0.1
2025-11-03 10:43:59,674 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 10:43:59,674 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 10:43:59,674 - INFO - 
Starting training...
2025-11-03 10:43:59,674 - INFO -   Total steps: 10
2025-11-03 10:43:59,674 - INFO -   Batch size: 128
2025-11-03 10:43:59,674 - INFO -   Learning rate: 0.0001
2025-11-03 10:43:59,674 - INFO -   Weight decay: 0.1
2025-11-03 10:43:59,674 - INFO -   Log interval: 5 steps
2025-11-03 10:43:59,674 - INFO -   Validation interval: 20 steps
2025-11-03 10:43:59,674 - INFO -   Save interval: 100 steps
2025-11-03 10:43:59,675 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 10:43:59,739 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 10:43:59,739 - INFO - 
================================================================================
2025-11-03 10:43:59,739 - INFO - STEP-BASED TRAINING
2025-11-03 10:43:59,739 - INFO -   Starting from step: 0
2025-11-03 10:43:59,739 - INFO -   Target steps: 10
2025-11-03 10:43:59,739 - INFO -   Batch size: 128
2025-11-03 10:43:59,739 - INFO -   Gradient accumulation steps: 4
2025-11-03 10:43:59,739 - INFO -   Effective batch size: 512
2025-11-03 10:43:59,739 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 10:43:59,739 - INFO - ================================================================================
2025-11-03 10:43:59,739 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 10:43:59,739 - INFO - 
üöÄ Starting training loop...
2025-11-03 10:43:59,739 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 10:43:59,739 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:44:01,276 - INFO -      [0] ‚úì Batch fetched in 1.537s
2025-11-03 10:44:01,276 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:44:01,278 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:44:01,599 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.320s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:44:01,599 - INFO -      [0] Starting forward pass...
2025-11-03 10:44:04,730 - INFO -      [0] ‚úì Forward pass completed in 3.130s, loss = 291.1241 (accum_step 1/4)
2025-11-03 10:44:04,730 - INFO -      [0] Starting backward pass...
2025-11-03 10:44:05,048 - INFO -      [0] ‚úì Backward pass completed in 0.317s
2025-11-03 10:44:05,069 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:44:05,069 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:05,069 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:44:05,076 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:44:05,077 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:44:05,077 - INFO -      [0] Starting forward pass...
2025-11-03 10:44:05,289 - INFO -      [0] ‚úì Forward pass completed in 0.011s, loss = 293.0616 (accum_step 2/4)
2025-11-03 10:44:05,289 - INFO -      [0] Starting backward pass...
2025-11-03 10:44:05,306 - INFO -      [0] ‚úì Backward pass completed in 0.017s
2025-11-03 10:44:05,549 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:44:05,549 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:05,549 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:44:05,550 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:44:05,551 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:44:05,551 - INFO -      [0] Starting forward pass...
2025-11-03 10:44:05,763 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 289.1639 (accum_step 3/4)
2025-11-03 10:44:05,763 - INFO -      [0] Starting backward pass...
2025-11-03 10:44:05,775 - INFO -      [0] ‚úì Backward pass completed in 0.012s
2025-11-03 10:44:06,023 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:44:06,023 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:06,023 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:44:06,029 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:44:06,030 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:44:06,030 - INFO -      [0] Starting forward pass...
2025-11-03 10:44:06,242 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 291.4747 (accum_step 4/4)
2025-11-03 10:44:06,242 - INFO -      [0] Starting backward pass...
2025-11-03 10:44:06,253 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:44:06,502 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 10:44:06,608 - INFO -      [0] ‚úì Optimizer step completed in 0.106s, grad_norm = 323.0117
2025-11-03 10:44:06,608 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:44:06,609 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:06,609 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:44:06,610 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:44:06,612 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:44:06,612 - INFO -      [1] Starting forward pass...
2025-11-03 10:44:06,825 - INFO -      [1] ‚úì Forward pass completed in 0.039s, loss = 291.5877 (accum_step 1/4)
2025-11-03 10:44:06,826 - INFO -      [1] Starting backward pass...
2025-11-03 10:44:06,842 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 10:44:07,092 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:44:07,093 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:07,093 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:44:07,105 - INFO -      [1] ‚úì Data moved to device in 0.013s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:44:07,106 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:44:07,106 - INFO -      [1] Starting forward pass...
2025-11-03 10:44:07,319 - INFO -      [1] ‚úì Forward pass completed in 0.013s, loss = 293.7806 (accum_step 2/4)
2025-11-03 10:44:07,320 - INFO -      [1] Starting backward pass...
2025-11-03 10:44:07,338 - INFO -      [1] ‚úì Backward pass completed in 0.018s
2025-11-03 10:44:07,579 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:44:07,579 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:07,579 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:44:07,580 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 10:44:07,581 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.002s (shape: torch.Size([3, 256, 512]))
2025-11-03 10:44:07,582 - INFO -      [1] Starting forward pass...
2025-11-03 10:44:10,249 - INFO -      [1] ‚úì Forward pass completed in 2.667s, loss = 285.1059 (accum_step 3/4)
2025-11-03 10:44:10,250 - INFO -      [1] Starting backward pass...
2025-11-03 10:44:10,265 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 10:44:10,267 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:44:12,093 - INFO -      [1] ‚úì Batch fetched in 1.825s
2025-11-03 10:44:12,093 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:44:12,100 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:44:12,101 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:44:12,101 - INFO -      [1] Starting forward pass...
2025-11-03 10:44:12,332 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 293.8708 (accum_step 4/4)
2025-11-03 10:44:12,333 - INFO -      [1] Starting backward pass...
2025-11-03 10:44:12,345 - INFO -      [1] ‚úì Backward pass completed in 0.013s
2025-11-03 10:44:12,612 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 10:44:12,625 - INFO -      [1] ‚úì Optimizer step completed in 0.012s, grad_norm = 326.4164
2025-11-03 10:44:12,625 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:44:12,625 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:12,625 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:44:12,630 - INFO -      [2] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:44:12,631 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:44:12,631 - INFO -      [2] Starting forward pass...
2025-11-03 10:44:12,843 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 285.6553 (accum_step 1/4)
2025-11-03 10:44:12,843 - INFO -      [2] Starting backward pass...
2025-11-03 10:44:12,855 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:44:13,122 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:44:13,987 - INFO -      [2] ‚úì Batch fetched in 0.864s
2025-11-03 10:44:13,987 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:44:13,988 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:44:13,989 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:44:13,989 - INFO -      [2] Starting forward pass...
2025-11-03 10:44:14,202 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 291.6246 (accum_step 2/4)
2025-11-03 10:44:14,202 - INFO -      [2] Starting backward pass...
2025-11-03 10:44:14,214 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 10:44:14,482 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:44:14,482 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:14,482 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:44:14,483 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:44:14,484 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:44:14,484 - INFO -      [2] Starting forward pass...
2025-11-03 10:44:14,696 - INFO -      [2] ‚úì Forward pass completed in 0.009s, loss = 292.4107 (accum_step 3/4)
2025-11-03 10:44:14,696 - INFO -      [2] Starting backward pass...
2025-11-03 10:44:14,708 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 10:44:14,976 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:44:15,593 - INFO -      [2] ‚úì Batch fetched in 0.617s
2025-11-03 10:44:15,593 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:44:15,599 - INFO -      [2] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:44:15,600 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:44:15,600 - INFO -      [2] Starting forward pass...
2025-11-03 10:44:15,813 - INFO -      [2] ‚úì Forward pass completed in 0.008s, loss = 286.3713 (accum_step 4/4)
2025-11-03 10:44:15,813 - INFO -      [2] Starting backward pass...
2025-11-03 10:44:15,825 - INFO -      [2] ‚úì Backward pass completed in 0.013s
2025-11-03 10:44:16,093 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 10:44:16,103 - INFO -      [2] ‚úì Optimizer step completed in 0.010s, grad_norm = 326.9385
2025-11-03 10:44:16,103 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:44:16,103 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:16,317 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 283.6096 (accum_step 1/4)
2025-11-03 10:44:16,596 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:44:16,596 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:16,607 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 299.3879 (accum_step 2/4)
2025-11-03 10:44:16,620 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:44:18,267 - INFO -      [3] ‚úì Batch fetched in 1.647s
2025-11-03 10:44:18,482 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 287.1437 (accum_step 3/4)
2025-11-03 10:44:18,762 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:44:18,763 - INFO -      [3] ‚úì Batch fetched in 0.001s
2025-11-03 10:44:18,982 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 282.3124 (accum_step 4/4)
2025-11-03 10:44:19,272 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:44:19,658 - INFO -      [4] ‚úì Batch fetched in 0.386s
2025-11-03 10:44:19,877 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 278.4527 (accum_step 1/4)
2025-11-03 10:44:20,156 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:44:20,156 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:20,375 - INFO -      [4] ‚úì Forward pass completed in 0.008s, loss = 277.2302 (accum_step 2/4)
2025-11-03 10:44:20,655 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:44:21,500 - INFO -      [4] ‚úì Batch fetched in 0.845s
2025-11-03 10:44:21,720 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 278.1899 (accum_step 3/4)
2025-11-03 10:44:22,000 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:44:22,000 - INFO -      [4] ‚úì Batch fetched in 0.001s
2025-11-03 10:44:22,219 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 277.6219 (accum_step 4/4)
2025-11-03 10:44:22,509 - INFO -   Step 5/10: loss = 277.8737, avg_loss = 287.4590, lr = 0.000011, grad_norm = 328.1466
2025-11-03 10:44:22,509 - INFO -     ‚è±Ô∏è  Timing: total=3.238s (fetch=1.232s, to_device=0.022s, spec_compute=0.003s, forward=0.028s, backward=0.044s, optim=0.010s)
2025-11-03 10:44:22,509 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:44:22,510 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:22,520 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 284.0818 (accum_step 1/4)
2025-11-03 10:44:22,533 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:44:24,465 - INFO -      [5] ‚úì Batch fetched in 1.932s
2025-11-03 10:44:24,704 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 272.7282 (accum_step 2/4)
2025-11-03 10:44:24,987 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:44:24,988 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:25,202 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 266.6895 (accum_step 3/4)
2025-11-03 10:44:25,481 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:44:25,801 - INFO -      [5] ‚úì Batch fetched in 0.320s
2025-11-03 10:44:26,021 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 270.1393 (accum_step 4/4)
2025-11-03 10:44:26,311 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:44:26,370 - INFO -      [6] ‚úì Batch fetched in 0.059s
2025-11-03 10:44:26,589 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 266.3935 (accum_step 1/4)
2025-11-03 10:44:26,868 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:44:27,461 - INFO -      [6] ‚úì Batch fetched in 0.593s
2025-11-03 10:44:27,680 - INFO -      [6] ‚úì Forward pass completed in 0.008s, loss = 262.9222 (accum_step 2/4)
2025-11-03 10:44:27,959 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:44:27,960 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:28,174 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 263.7276 (accum_step 3/4)
2025-11-03 10:44:28,453 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:44:28,453 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:28,464 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 271.3925 (accum_step 4/4)
2025-11-03 10:44:28,487 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:44:30,300 - INFO -      [7] ‚úì Batch fetched in 1.813s
2025-11-03 10:44:30,533 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 252.3390 (accum_step 1/4)
2025-11-03 10:44:30,815 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:44:30,815 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:44:31,034 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 252.2856 (accum_step 2/4)
2025-11-03 10:44:31,313 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:44:32,277 - INFO -      [7] ‚úì Batch fetched in 0.965s
2025-11-03 10:44:32,492 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 252.2984 (accum_step 3/4)
2025-11-03 10:44:46,019 - INFO - ================================================================================
2025-11-03 10:44:46,019 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 10:44:46,019 - INFO - ================================================================================
2025-11-03 10:44:46,019 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:44:46,019 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:44:46,019 - INFO - ================================================================================
2025-11-03 10:44:46,020 - INFO - Device: cuda
2025-11-03 10:44:46,020 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 10:44:46,020 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 10:44:46,020 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 10:44:46,020 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=False
2025-11-03 10:44:46,021 - INFO -   Batch size: 128, Steps: 10
2025-11-03 10:44:46,021 - INFO -   Validation interval: 20 steps
2025-11-03 10:44:46,021 - INFO -   Log interval: 5 steps
2025-11-03 10:44:46,021 - INFO - 
Initializing model...
2025-11-03 10:44:46,636 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 10:44:46,637 - INFO -   Total parameters: 44,674,663
2025-11-03 10:44:46,637 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 10:44:49,650 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 10:44:49,651 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 10:44:49,659 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 10:44:49,659 - INFO - 
Setting up datasets...
2025-11-03 10:44:49,659 - INFO -   Loading MAESTRO dataset...
2025-11-03 10:44:51,373 - INFO -   ‚úì MAESTRO train: 200 samples (cached)
2025-11-03 10:44:51,374 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 10:44:51,374 - INFO -   Loading SLAKH stems dataset...
2025-11-03 10:44:53,083 - INFO -   ‚úì SLAKH stems train: 521 samples (cached)
2025-11-03 10:44:53,610 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 10:44:53,610 - INFO -   Loading SLAKH mix dataset...
2025-11-03 10:44:55,301 - INFO -   ‚úì SLAKH mix train: 50 samples (cached)
2025-11-03 10:44:55,353 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 10:44:55,353 - INFO - 
  Creating multi-task dataset...
2025-11-03 10:44:55,353 - INFO -   ‚úì Multi-task dataset: 771 total samples
2025-11-03 10:44:55,354 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0}
2025-11-03 10:44:55,354 - INFO - 
  Setting up validation data...
2025-11-03 10:44:55,354 - INFO -   ‚úì Validation: 247 samples
2025-11-03 10:44:55,355 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 10:44:55,355 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 10:44:55,355 - INFO -   Label smoothing: 0.1
2025-11-03 10:44:55,355 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 10:44:55,356 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 10:44:55,356 - INFO - 
Starting training...
2025-11-03 10:44:55,356 - INFO -   Total steps: 10
2025-11-03 10:44:55,356 - INFO -   Batch size: 128
2025-11-03 10:44:55,356 - INFO -   Learning rate: 0.0001
2025-11-03 10:44:55,356 - INFO -   Weight decay: 0.1
2025-11-03 10:44:55,356 - INFO -   Log interval: 5 steps
2025-11-03 10:44:55,356 - INFO -   Validation interval: 20 steps
2025-11-03 10:44:55,356 - INFO -   Save interval: 100 steps
2025-11-03 10:44:55,357 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 10:44:55,413 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 10:44:55,413 - INFO - 
================================================================================
2025-11-03 10:44:55,413 - INFO - STEP-BASED TRAINING
2025-11-03 10:44:55,413 - INFO -   Starting from step: 0
2025-11-03 10:44:55,413 - INFO -   Target steps: 10
2025-11-03 10:44:55,414 - INFO -   Batch size: 128
2025-11-03 10:44:55,414 - INFO -   Gradient accumulation steps: 4
2025-11-03 10:44:55,414 - INFO -   Effective batch size: 512
2025-11-03 10:44:55,414 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 10:44:55,414 - INFO - ================================================================================
2025-11-03 10:44:55,414 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 10:44:55,414 - INFO - 
üöÄ Starting training loop...
2025-11-03 10:44:55,414 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 10:44:55,414 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:44:57,103 - INFO -      [0] ‚úì Batch fetched in 1.689s
2025-11-03 10:44:57,103 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:44:57,105 - INFO -      [0] ‚úì Data moved to device in 0.002s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:44:57,398 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.293s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:44:57,398 - INFO -      [0] Starting forward pass...
2025-11-03 10:45:00,098 - INFO -      [0] ‚úì Forward pass completed in 2.700s, loss = 291.1241 (accum_step 1/4)
2025-11-03 10:45:00,099 - INFO -      [0] Starting backward pass...
2025-11-03 10:45:00,413 - INFO -      [0] ‚úì Backward pass completed in 0.315s
2025-11-03 10:45:00,434 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:45:00,434 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:00,435 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:45:00,440 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:45:00,441 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:45:00,441 - INFO -      [0] Starting forward pass...
2025-11-03 10:45:00,654 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 293.0616 (accum_step 2/4)
2025-11-03 10:45:00,654 - INFO -      [0] Starting backward pass...
2025-11-03 10:45:00,668 - INFO -      [0] ‚úì Backward pass completed in 0.014s
2025-11-03 10:45:00,914 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:45:00,914 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:00,914 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:45:00,917 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:45:00,918 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:45:00,918 - INFO -      [0] Starting forward pass...
2025-11-03 10:45:01,130 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 293.0715 (accum_step 3/4)
2025-11-03 10:45:01,130 - INFO -      [0] Starting backward pass...
2025-11-03 10:45:01,140 - INFO -      [0] ‚úì Backward pass completed in 0.010s
2025-11-03 10:45:01,389 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:45:01,389 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:01,390 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:45:01,391 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:45:01,392 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:45:01,392 - INFO -      [0] Starting forward pass...
2025-11-03 10:45:01,604 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 290.8759 (accum_step 4/4)
2025-11-03 10:45:01,604 - INFO -      [0] Starting backward pass...
2025-11-03 10:45:01,614 - INFO -      [0] ‚úì Backward pass completed in 0.010s
2025-11-03 10:45:01,863 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 10:45:01,964 - INFO -      [0] ‚úì Optimizer step completed in 0.100s, grad_norm = 323.8849
2025-11-03 10:45:01,964 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:45:01,964 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:01,964 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:45:01,973 - INFO -      [1] ‚úì Data moved to device in 0.009s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:45:01,974 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:45:01,975 - INFO -      [1] Starting forward pass...
2025-11-03 10:45:02,188 - INFO -      [1] ‚úì Forward pass completed in 0.040s, loss = 288.4333 (accum_step 1/4)
2025-11-03 10:45:02,188 - INFO -      [1] Starting backward pass...
2025-11-03 10:45:02,202 - INFO -      [1] ‚úì Backward pass completed in 0.014s
2025-11-03 10:45:02,454 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:45:02,454 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:02,454 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:45:02,466 - INFO -      [1] ‚úì Data moved to device in 0.012s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:45:02,466 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:45:02,467 - INFO -      [1] Starting forward pass...
2025-11-03 10:45:02,680 - INFO -      [1] ‚úì Forward pass completed in 0.012s, loss = 290.6924 (accum_step 2/4)
2025-11-03 10:45:02,680 - INFO -      [1] Starting backward pass...
2025-11-03 10:45:02,696 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 10:45:02,939 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:45:02,939 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:02,939 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:45:02,940 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 10:45:02,941 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([3, 256, 512]))
2025-11-03 10:45:02,941 - INFO -      [1] Starting forward pass...
2025-11-03 10:45:05,560 - INFO -      [1] ‚úì Forward pass completed in 2.618s, loss = 278.7957 (accum_step 3/4)
2025-11-03 10:45:05,560 - INFO -      [1] Starting backward pass...
2025-11-03 10:45:05,575 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 10:45:05,577 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:45:07,484 - INFO -      [1] ‚úì Batch fetched in 1.907s
2025-11-03 10:45:07,485 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:45:07,491 - INFO -      [1] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:45:07,492 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:45:07,492 - INFO -      [1] Starting forward pass...
2025-11-03 10:45:07,724 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 291.5410 (accum_step 4/4)
2025-11-03 10:45:07,725 - INFO -      [1] Starting backward pass...
2025-11-03 10:45:07,736 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 10:45:08,011 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 10:45:08,021 - INFO -      [1] ‚úì Optimizer step completed in 0.009s, grad_norm = 321.6044
2025-11-03 10:45:08,021 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:45:08,021 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:08,021 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:45:08,026 - INFO -      [2] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:45:08,027 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:45:08,027 - INFO -      [2] Starting forward pass...
2025-11-03 10:45:08,240 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 291.2740 (accum_step 1/4)
2025-11-03 10:45:08,240 - INFO -      [2] Starting backward pass...
2025-11-03 10:45:08,249 - INFO -      [2] ‚úì Backward pass completed in 0.009s
2025-11-03 10:45:08,519 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:45:08,519 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:08,519 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:45:08,525 - INFO -      [2] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:45:08,526 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:45:08,526 - INFO -      [2] Starting forward pass...
2025-11-03 10:45:08,738 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.5377 (accum_step 2/4)
2025-11-03 10:45:08,738 - INFO -      [2] Starting backward pass...
2025-11-03 10:45:08,749 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 10:45:09,018 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:45:09,018 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:09,018 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:45:09,020 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:45:09,020 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:45:09,021 - INFO -      [2] Starting forward pass...
2025-11-03 10:45:09,233 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.1874 (accum_step 3/4)
2025-11-03 10:45:09,233 - INFO -      [2] Starting backward pass...
2025-11-03 10:45:09,243 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 10:45:09,512 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:45:09,513 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:09,513 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:45:09,519 - INFO -      [2] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:45:09,520 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:45:09,520 - INFO -      [2] Starting forward pass...
2025-11-03 10:45:09,732 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 290.8769 (accum_step 4/4)
2025-11-03 10:45:09,732 - INFO -      [2] Starting backward pass...
2025-11-03 10:45:09,743 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 10:45:10,012 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 10:45:10,020 - INFO -      [2] ‚úì Optimizer step completed in 0.008s, grad_norm = 328.5470
2025-11-03 10:45:10,020 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:45:10,020 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:10,238 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 281.3301 (accum_step 1/4)
2025-11-03 10:45:10,517 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:45:10,517 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:10,528 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 290.6562 (accum_step 2/4)
2025-11-03 10:45:10,541 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:45:12,443 - INFO -      [3] ‚úì Batch fetched in 1.902s
2025-11-03 10:45:12,671 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 287.5550 (accum_step 3/4)
2025-11-03 10:45:12,951 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:45:12,951 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:13,168 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 287.9839 (accum_step 4/4)
2025-11-03 10:45:13,456 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:45:13,456 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:13,675 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 278.7089 (accum_step 1/4)
2025-11-03 10:45:13,954 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:45:13,955 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:14,174 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 279.6735 (accum_step 2/4)
2025-11-03 10:45:14,454 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:45:14,455 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:14,673 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 275.8613 (accum_step 3/4)
2025-11-03 10:45:14,953 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:45:14,953 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:15,171 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 277.5235 (accum_step 4/4)
2025-11-03 10:45:15,459 - INFO -   Step 5/10: loss = 277.9418, avg_loss = 286.7882, lr = 0.000011, grad_norm = 329.3374
2025-11-03 10:45:15,459 - INFO -     ‚è±Ô∏è  Timing: total=2.003s (fetch=0.001s, to_device=0.022s, spec_compute=0.002s, forward=0.023s, backward=0.040s, optim=0.008s)
2025-11-03 10:45:15,459 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:45:15,459 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:15,469 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 257.0851 (accum_step 1/4)
2025-11-03 10:45:15,482 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:45:17,241 - INFO -      [5] ‚úì Batch fetched in 1.759s
2025-11-03 10:45:17,476 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 274.3901 (accum_step 2/4)
2025-11-03 10:45:17,757 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:45:17,757 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:17,975 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 268.5464 (accum_step 3/4)
2025-11-03 10:45:18,255 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:45:18,255 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:18,469 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 272.5507 (accum_step 4/4)
2025-11-03 10:45:18,758 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:45:18,758 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:18,977 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.8609 (accum_step 1/4)
2025-11-03 10:45:19,255 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:45:19,255 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:19,474 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 260.5172 (accum_step 2/4)
2025-11-03 10:45:19,753 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:45:19,754 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:19,968 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 260.0921 (accum_step 3/4)
2025-11-03 10:45:20,247 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:45:20,247 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:20,258 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 268.2286 (accum_step 4/4)
2025-11-03 10:45:20,279 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:45:22,289 - INFO -      [7] ‚úì Batch fetched in 2.009s
2025-11-03 10:45:22,527 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 251.0476 (accum_step 1/4)
2025-11-03 10:45:22,806 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:45:22,806 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:23,021 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.9977 (accum_step 2/4)
2025-11-03 10:45:23,300 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:45:23,301 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:23,520 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 250.5159 (accum_step 3/4)
2025-11-03 10:45:23,799 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:45:23,799 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:24,018 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.8857 (accum_step 4/4)
2025-11-03 10:45:24,306 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:45:24,306 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:45:24,520 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.0528 (accum_step 1/4)
2025-11-03 10:46:45,420 - INFO - ================================================================================
2025-11-03 10:46:45,420 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 10:46:45,420 - INFO - ================================================================================
2025-11-03 10:46:45,420 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:46:45,420 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:46:45,420 - INFO - ================================================================================
2025-11-03 10:46:45,421 - INFO - Device: cuda
2025-11-03 10:46:45,421 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 10:46:45,421 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 10:46:45,421 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 10:46:45,421 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=False
2025-11-03 10:46:45,422 - INFO -   Batch size: 128, Steps: 10
2025-11-03 10:46:45,422 - INFO -   Validation interval: 20 steps
2025-11-03 10:46:45,422 - INFO -   Log interval: 5 steps
2025-11-03 10:46:45,422 - INFO - 
Initializing model...
2025-11-03 10:46:46,088 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 10:46:46,089 - INFO -   Total parameters: 44,674,663
2025-11-03 10:46:46,089 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 10:46:49,265 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 10:46:49,266 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 10:46:49,274 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 10:46:49,274 - INFO - 
Setting up datasets...
2025-11-03 10:46:49,274 - INFO -   Loading MAESTRO dataset...
2025-11-03 10:46:50,981 - INFO -   ‚úì MAESTRO train: 200 samples (cached)
2025-11-03 10:46:50,982 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 10:46:50,982 - INFO -   Loading SLAKH stems dataset...
2025-11-03 10:46:52,673 - INFO -   ‚úì SLAKH stems train: 521 samples (cached)
2025-11-03 10:46:53,205 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 10:46:53,205 - INFO -   Loading SLAKH mix dataset...
2025-11-03 10:46:54,881 - INFO -   ‚úì SLAKH mix train: 50 samples (cached)
2025-11-03 10:46:54,930 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 10:46:54,930 - INFO - 
  Creating multi-task dataset...
2025-11-03 10:46:54,930 - INFO -   ‚úì Multi-task dataset: 771 total samples
2025-11-03 10:46:54,930 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0}
2025-11-03 10:46:54,931 - INFO - 
  Setting up validation data...
2025-11-03 10:46:54,931 - INFO -   ‚úì Validation: 247 samples
2025-11-03 10:46:54,932 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 10:46:54,932 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 10:46:54,932 - INFO -   Label smoothing: 0.1
2025-11-03 10:46:54,932 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 10:46:54,932 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 10:46:54,932 - INFO - 
Starting training...
2025-11-03 10:46:54,933 - INFO -   Total steps: 10
2025-11-03 10:46:54,933 - INFO -   Batch size: 128
2025-11-03 10:46:54,933 - INFO -   Learning rate: 0.0001
2025-11-03 10:46:54,933 - INFO -   Weight decay: 0.1
2025-11-03 10:46:54,933 - INFO -   Log interval: 5 steps
2025-11-03 10:46:54,933 - INFO -   Validation interval: 20 steps
2025-11-03 10:46:54,933 - INFO -   Save interval: 100 steps
2025-11-03 10:46:54,934 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 10:46:54,992 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 10:46:54,992 - INFO - 
================================================================================
2025-11-03 10:46:54,992 - INFO - STEP-BASED TRAINING
2025-11-03 10:46:54,992 - INFO -   Starting from step: 0
2025-11-03 10:46:54,992 - INFO -   Target steps: 10
2025-11-03 10:46:54,992 - INFO -   Batch size: 128
2025-11-03 10:46:54,992 - INFO -   Gradient accumulation steps: 4
2025-11-03 10:46:54,992 - INFO -   Effective batch size: 512
2025-11-03 10:46:54,993 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 10:46:54,993 - INFO - ================================================================================
2025-11-03 10:46:54,993 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 10:46:54,993 - INFO - 
üöÄ Starting training loop...
2025-11-03 10:46:54,993 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 10:46:54,993 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:46:57,109 - INFO -      [0] ‚úì Batch fetched in 2.116s
2025-11-03 10:46:57,110 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:46:57,125 - INFO -      [0] ‚úì Data moved to device in 0.015s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:46:57,422 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.297s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:46:57,423 - INFO -      [0] Starting forward pass...
2025-11-03 10:47:00,072 - INFO -      [0] ‚úì Forward pass completed in 2.649s, loss = 291.1241 (accum_step 1/4)
2025-11-03 10:47:00,073 - INFO -      [0] Starting backward pass...
2025-11-03 10:47:00,387 - INFO -      [0] ‚úì Backward pass completed in 0.315s
2025-11-03 10:47:00,408 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:47:00,409 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:00,409 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:47:00,410 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:47:00,411 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:47:00,411 - INFO -      [0] Starting forward pass...
2025-11-03 10:47:00,623 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 293.0616 (accum_step 2/4)
2025-11-03 10:47:00,623 - INFO -      [0] Starting backward pass...
2025-11-03 10:47:00,638 - INFO -      [0] ‚úì Backward pass completed in 0.015s
2025-11-03 10:47:00,883 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:47:00,883 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:00,883 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:47:00,889 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:47:00,890 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:47:00,890 - INFO -      [0] Starting forward pass...
2025-11-03 10:47:01,102 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 293.0716 (accum_step 3/4)
2025-11-03 10:47:01,103 - INFO -      [0] Starting backward pass...
2025-11-03 10:47:01,113 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:47:01,362 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:47:01,362 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:01,362 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:47:01,368 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:47:01,368 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:47:01,368 - INFO -      [0] Starting forward pass...
2025-11-03 10:47:01,581 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 290.8759 (accum_step 4/4)
2025-11-03 10:47:01,581 - INFO -      [0] Starting backward pass...
2025-11-03 10:47:01,591 - INFO -      [0] ‚úì Backward pass completed in 0.010s
2025-11-03 10:47:01,840 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 10:47:01,942 - INFO -      [0] ‚úì Optimizer step completed in 0.102s, grad_norm = 323.8850
2025-11-03 10:47:01,943 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:47:01,943 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:01,943 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:47:01,954 - INFO -      [1] ‚úì Data moved to device in 0.011s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:47:01,956 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:47:01,956 - INFO -      [1] Starting forward pass...
2025-11-03 10:47:02,169 - INFO -      [1] ‚úì Forward pass completed in 0.040s, loss = 289.7845 (accum_step 1/4)
2025-11-03 10:47:02,169 - INFO -      [1] Starting backward pass...
2025-11-03 10:47:02,186 - INFO -      [1] ‚úì Backward pass completed in 0.017s
2025-11-03 10:47:02,436 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:47:02,437 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:02,437 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:47:02,439 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:47:02,440 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:47:02,440 - INFO -      [1] Starting forward pass...
2025-11-03 10:47:02,653 - INFO -      [1] ‚úì Forward pass completed in 0.012s, loss = 290.7374 (accum_step 2/4)
2025-11-03 10:47:02,653 - INFO -      [1] Starting backward pass...
2025-11-03 10:47:02,669 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 10:47:02,912 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:47:02,912 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:02,912 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:47:02,913 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 10:47:02,914 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.002s (shape: torch.Size([3, 256, 512]))
2025-11-03 10:47:02,915 - INFO -      [1] Starting forward pass...
2025-11-03 10:47:05,530 - INFO -      [1] ‚úì Forward pass completed in 2.614s, loss = 296.0802 (accum_step 3/4)
2025-11-03 10:47:05,530 - INFO -      [1] Starting backward pass...
2025-11-03 10:47:05,545 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 10:47:05,548 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:47:07,047 - INFO -      [1] ‚úì Batch fetched in 1.499s
2025-11-03 10:47:07,047 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:47:07,053 - INFO -      [1] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:47:07,055 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:47:07,055 - INFO -      [1] Starting forward pass...
2025-11-03 10:47:07,287 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 288.2697 (accum_step 4/4)
2025-11-03 10:47:07,287 - INFO -      [1] Starting backward pass...
2025-11-03 10:47:07,300 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 10:47:07,574 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 10:47:07,584 - INFO -      [1] ‚úì Optimizer step completed in 0.010s, grad_norm = 327.2297
2025-11-03 10:47:07,584 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:47:07,584 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:07,584 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:47:07,590 - INFO -      [2] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:47:07,591 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:47:07,591 - INFO -      [2] Starting forward pass...
2025-11-03 10:47:07,804 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.1777 (accum_step 1/4)
2025-11-03 10:47:07,804 - INFO -      [2] Starting backward pass...
2025-11-03 10:47:07,815 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:47:08,083 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:47:08,083 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:08,083 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:47:08,086 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:47:08,087 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:47:08,087 - INFO -      [2] Starting forward pass...
2025-11-03 10:47:08,299 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.3394 (accum_step 2/4)
2025-11-03 10:47:08,299 - INFO -      [2] Starting backward pass...
2025-11-03 10:47:08,311 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 10:47:08,579 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:47:08,579 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:08,579 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:47:08,586 - INFO -      [2] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:47:08,587 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:47:08,587 - INFO -      [2] Starting forward pass...
2025-11-03 10:47:08,799 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.1928 (accum_step 3/4)
2025-11-03 10:47:08,799 - INFO -      [2] Starting backward pass...
2025-11-03 10:47:08,810 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 10:47:09,079 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:47:09,079 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:09,079 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:47:09,080 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:47:09,080 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:47:09,080 - INFO -      [2] Starting forward pass...
2025-11-03 10:47:09,293 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 291.7757 (accum_step 4/4)
2025-11-03 10:47:09,293 - INFO -      [2] Starting backward pass...
2025-11-03 10:47:09,304 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:47:09,573 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 10:47:09,583 - INFO -      [2] ‚úì Optimizer step completed in 0.010s, grad_norm = 327.2442
2025-11-03 10:47:09,583 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:47:09,583 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:09,801 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 286.3654 (accum_step 1/4)
2025-11-03 10:47:10,080 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:47:10,081 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:10,091 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 292.0156 (accum_step 2/4)
2025-11-03 10:47:10,105 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:47:11,873 - INFO -      [3] ‚úì Batch fetched in 1.768s
2025-11-03 10:47:12,107 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 284.7546 (accum_step 3/4)
2025-11-03 10:47:12,390 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:47:12,390 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:12,610 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 286.8998 (accum_step 4/4)
2025-11-03 10:47:12,899 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:47:12,899 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:13,113 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 279.0456 (accum_step 1/4)
2025-11-03 10:47:13,414 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:47:13,414 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:13,630 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 279.6485 (accum_step 2/4)
2025-11-03 10:47:13,911 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:47:13,911 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:14,125 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 280.6212 (accum_step 3/4)
2025-11-03 10:47:14,405 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:47:14,405 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:14,623 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 281.8135 (accum_step 4/4)
2025-11-03 10:47:14,913 - INFO -   Step 5/10: loss = 280.2822, avg_loss = 288.0327, lr = 0.000011, grad_norm = 331.7499
2025-11-03 10:47:14,913 - INFO -     ‚è±Ô∏è  Timing: total=2.014s (fetch=0.001s, to_device=0.010s, spec_compute=0.002s, forward=0.026s, backward=0.044s, optim=0.009s)
2025-11-03 10:47:14,913 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:47:14,913 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:14,923 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 285.3745 (accum_step 1/4)
2025-11-03 10:47:14,937 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:47:16,592 - INFO -      [5] ‚úì Batch fetched in 1.655s
2025-11-03 10:47:16,807 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 272.3882 (accum_step 2/4)
2025-11-03 10:47:17,087 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:47:17,087 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:17,301 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 267.7397 (accum_step 3/4)
2025-11-03 10:47:17,581 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:47:17,581 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:17,800 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 271.6117 (accum_step 4/4)
2025-11-03 10:47:18,089 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:47:18,090 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:18,308 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.7931 (accum_step 1/4)
2025-11-03 10:47:18,587 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:47:18,588 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:18,806 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.7072 (accum_step 2/4)
2025-11-03 10:47:19,085 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:47:19,086 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:19,299 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.3290 (accum_step 3/4)
2025-11-03 10:47:19,578 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:47:19,579 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:19,589 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 274.5590 (accum_step 4/4)
2025-11-03 10:47:19,611 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:47:21,388 - INFO -      [7] ‚úì Batch fetched in 1.776s
2025-11-03 10:47:21,626 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 252.8150 (accum_step 1/4)
2025-11-03 10:47:21,908 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:47:21,908 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:22,127 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 253.2112 (accum_step 2/4)
2025-11-03 10:47:22,407 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:47:22,407 - INFO -      [7] ‚úì Batch fetched in 0.001s
2025-11-03 10:47:22,621 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 251.0071 (accum_step 3/4)
2025-11-03 10:47:22,901 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:47:22,902 - INFO -      [7] ‚úì Batch fetched in 0.001s
2025-11-03 10:47:23,121 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 249.7381 (accum_step 4/4)
2025-11-03 10:47:23,410 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:47:23,411 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:23,629 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.2992 (accum_step 1/4)
2025-11-03 10:47:23,909 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:47:23,909 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:24,128 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.2614 (accum_step 2/4)
2025-11-03 10:47:24,408 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:47:24,408 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:24,418 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 234.9922 (accum_step 3/4)
2025-11-03 10:47:24,432 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:47:26,133 - INFO -      [8] ‚úì Batch fetched in 1.701s
2025-11-03 10:47:26,347 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 236.0594 (accum_step 4/4)
2025-11-03 10:47:26,636 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:47:26,636 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:26,855 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 224.6679 (accum_step 1/4)
2025-11-03 10:47:27,134 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:47:27,134 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:47:27,353 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 226.2681 (accum_step 2/4)
2025-11-03 10:47:27,633 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:47:27,634 - INFO -      [9] ‚úì Batch fetched in 0.001s
2025-11-03 10:47:27,853 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.2915 (accum_step 3/4)
2025-11-03 10:47:28,133 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:47:28,136 - INFO -      [9] ‚úì Batch fetched in 0.004s
2025-11-03 10:47:28,352 - INFO -      [9] ‚úì Forward pass completed in 0.014s, loss = 225.2049 (accum_step 4/4)
2025-11-03 10:47:28,643 - INFO -   Step 10/10: loss = 225.6081, avg_loss = 269.4493, lr = 0.000021, grad_norm = 277.8608
2025-11-03 10:47:28,643 - INFO -     ‚è±Ô∏è  Timing: total=2.007s (fetch=0.005s, to_device=0.018s, spec_compute=0.004s, forward=0.033s, backward=0.047s, optim=0.011s)
2025-11-03 10:47:28,643 - INFO - 
================================================================================
2025-11-03 10:47:28,643 - INFO - TRAINING SUMMARY:
2025-11-03 10:47:28,643 - INFO -   Steps Completed: 10
2025-11-03 10:47:28,644 - INFO -   Average Loss: 269.4493
2025-11-03 10:47:28,644 - INFO -   Best Validation Loss: inf
2025-11-03 10:47:28,644 - INFO - ================================================================================
2025-11-03 10:47:28,644 - INFO - 
================================================================================
2025-11-03 10:47:28,644 - INFO - TRAINING COMPLETED
2025-11-03 10:47:28,644 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:47:28,644 - INFO - Final step: 10
2025-11-03 10:47:28,644 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 10:47:28,644 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:47:28,644 - INFO - ================================================================================
2025-11-03 10:50:17,624 - INFO - ================================================================================
2025-11-03 10:50:17,624 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 10:50:17,624 - INFO - ================================================================================
2025-11-03 10:50:17,624 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:50:17,624 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:50:17,624 - INFO - ================================================================================
2025-11-03 10:50:17,625 - INFO - Device: cuda
2025-11-03 10:50:17,625 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 10:50:17,625 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 10:50:17,625 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 10:50:17,625 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=False
2025-11-03 10:50:17,625 - INFO -   Batch size: 128, Steps: 10
2025-11-03 10:50:17,625 - INFO -   Validation interval: 20 steps
2025-11-03 10:50:17,625 - INFO -   Log interval: 5 steps
2025-11-03 10:50:17,625 - INFO - 
Initializing model...
2025-11-03 10:50:18,109 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 10:50:18,110 - INFO -   Total parameters: 44,674,663
2025-11-03 10:50:18,110 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 10:50:21,197 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 10:50:21,197 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 10:50:21,213 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 10:50:21,213 - INFO - 
Setting up datasets...
2025-11-03 10:50:21,213 - INFO -   Loading MAESTRO dataset...
2025-11-03 10:50:23,023 - INFO -   ‚úì MAESTRO train: 200 samples (cached)
2025-11-03 10:50:23,024 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 10:50:23,024 - INFO -   Loading SLAKH stems dataset...
2025-11-03 10:50:24,779 - INFO -   ‚úì SLAKH stems train: 521 samples (cached)
2025-11-03 10:50:25,319 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 10:50:25,319 - INFO -   Loading SLAKH mix dataset...
2025-11-03 10:50:27,062 - INFO -   ‚úì SLAKH mix train: 50 samples (cached)
2025-11-03 10:50:27,115 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 10:50:27,115 - INFO - 
  Creating multi-task dataset...
2025-11-03 10:50:27,116 - INFO -   ‚úì Multi-task dataset: 771 total samples
2025-11-03 10:50:27,116 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0}
2025-11-03 10:50:27,116 - INFO - 
  Setting up validation data...
2025-11-03 10:50:27,116 - INFO -   ‚úì Validation: 247 samples
2025-11-03 10:50:27,118 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 10:50:27,118 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 10:50:27,118 - INFO -   Label smoothing: 0.1
2025-11-03 10:50:27,118 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 10:50:27,118 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 10:50:27,118 - INFO - 
Starting training...
2025-11-03 10:50:27,118 - INFO -   Total steps: 10
2025-11-03 10:50:27,118 - INFO -   Batch size: 128
2025-11-03 10:50:27,118 - INFO -   Learning rate: 0.0001
2025-11-03 10:50:27,118 - INFO -   Weight decay: 0.1
2025-11-03 10:50:27,118 - INFO -   Log interval: 5 steps
2025-11-03 10:50:27,118 - INFO -   Validation interval: 20 steps
2025-11-03 10:50:27,118 - INFO -   Save interval: 100 steps
2025-11-03 10:50:27,119 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 10:50:27,193 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 10:50:27,193 - INFO - 
================================================================================
2025-11-03 10:50:27,193 - INFO - STEP-BASED TRAINING
2025-11-03 10:50:27,193 - INFO -   Starting from step: 0
2025-11-03 10:50:27,193 - INFO -   Target steps: 10
2025-11-03 10:50:27,193 - INFO -   Batch size: 128
2025-11-03 10:50:27,193 - INFO -   Gradient accumulation steps: 4
2025-11-03 10:50:27,193 - INFO -   Effective batch size: 512
2025-11-03 10:50:27,193 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 10:50:27,193 - INFO - ================================================================================
2025-11-03 10:50:27,193 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 10:50:27,193 - INFO - 
üöÄ Starting training loop...
2025-11-03 10:50:27,193 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 10:50:27,193 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:50:29,224 - INFO -      [0] ‚úì Batch fetched in 2.030s
2025-11-03 10:50:29,224 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:50:29,231 - INFO -      [0] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:50:29,523 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.292s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:50:29,523 - INFO -      [0] Starting forward pass...
2025-11-03 10:50:32,091 - INFO -      [0] ‚úì Forward pass completed in 2.567s, loss = 290.0146 (accum_step 1/4)
2025-11-03 10:50:32,091 - INFO -      [0] Starting backward pass...
2025-11-03 10:50:32,406 - INFO -      [0] ‚úì Backward pass completed in 0.315s
2025-11-03 10:50:32,427 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:50:33,933 - INFO -      [0] ‚úì Batch fetched in 1.506s
2025-11-03 10:50:33,933 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:50:33,936 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:50:33,937 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:50:33,937 - INFO -      [0] Starting forward pass...
2025-11-03 10:50:34,150 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 292.4608 (accum_step 2/4)
2025-11-03 10:50:34,150 - INFO -      [0] Starting backward pass...
2025-11-03 10:50:34,165 - INFO -      [0] ‚úì Backward pass completed in 0.015s
2025-11-03 10:50:34,410 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:50:36,176 - INFO -      [0] ‚úì Batch fetched in 1.766s
2025-11-03 10:50:36,176 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:50:36,183 - INFO -      [0] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:50:36,184 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:50:36,184 - INFO -      [0] Starting forward pass...
2025-11-03 10:50:36,411 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 292.8611 (accum_step 3/4)
2025-11-03 10:50:36,411 - INFO -      [0] Starting backward pass...
2025-11-03 10:50:36,422 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:50:36,670 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:50:38,562 - INFO -      [0] ‚úì Batch fetched in 1.892s
2025-11-03 10:50:38,562 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:50:38,570 - INFO -      [0] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:50:38,570 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:50:38,571 - INFO -      [0] Starting forward pass...
2025-11-03 10:50:38,800 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 293.0827 (accum_step 4/4)
2025-11-03 10:50:38,800 - INFO -      [0] Starting backward pass...
2025-11-03 10:50:38,811 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:50:39,060 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 10:50:39,159 - INFO -      [0] ‚úì Optimizer step completed in 0.099s, grad_norm = 325.3829
2025-11-03 10:50:39,159 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:50:41,196 - INFO -      [1] ‚úì Batch fetched in 2.037s
2025-11-03 10:50:41,196 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:50:41,198 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:50:41,207 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.009s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:50:41,207 - INFO -      [1] Starting forward pass...
2025-11-03 10:50:41,420 - INFO -      [1] ‚úì Forward pass completed in 0.038s, loss = 295.7597 (accum_step 1/4)
2025-11-03 10:50:41,420 - INFO -      [1] Starting backward pass...
2025-11-03 10:50:41,435 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 10:50:41,680 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:50:43,116 - INFO -      [1] ‚úì Batch fetched in 1.437s
2025-11-03 10:50:43,117 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:50:43,123 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:50:43,124 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:50:43,124 - INFO -      [1] Starting forward pass...
2025-11-03 10:50:43,337 - INFO -      [1] ‚úì Forward pass completed in 0.010s, loss = 291.2143 (accum_step 2/4)
2025-11-03 10:50:43,337 - INFO -      [1] Starting backward pass...
2025-11-03 10:50:43,352 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 10:50:43,596 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:50:43,767 - INFO -      [1] ‚úì Batch fetched in 0.172s
2025-11-03 10:50:43,768 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:50:43,768 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 10:50:43,769 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([3, 256, 512]))
2025-11-03 10:50:43,770 - INFO -      [1] Starting forward pass...
2025-11-03 10:50:46,371 - INFO -      [1] ‚úì Forward pass completed in 2.600s, loss = 295.1024 (accum_step 3/4)
2025-11-03 10:50:46,371 - INFO -      [1] Starting backward pass...
2025-11-03 10:50:46,387 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 10:50:46,389 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:50:48,031 - INFO -      [1] ‚úì Batch fetched in 1.642s
2025-11-03 10:50:48,032 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:50:48,039 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:50:48,040 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:50:48,040 - INFO -      [1] Starting forward pass...
2025-11-03 10:50:48,268 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 291.7719 (accum_step 4/4)
2025-11-03 10:50:48,268 - INFO -      [1] Starting backward pass...
2025-11-03 10:50:48,279 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 10:50:48,547 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 10:50:48,557 - INFO -      [1] ‚úì Optimizer step completed in 0.010s, grad_norm = 331.4433
2025-11-03 10:50:48,557 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:50:49,974 - INFO -      [2] ‚úì Batch fetched in 1.417s
2025-11-03 10:50:49,974 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:50:49,981 - INFO -      [2] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:50:49,982 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:50:49,982 - INFO -      [2] Starting forward pass...
2025-11-03 10:50:50,194 - INFO -      [2] ‚úì Forward pass completed in 0.008s, loss = 287.6535 (accum_step 1/4)
2025-11-03 10:50:50,194 - INFO -      [2] Starting backward pass...
2025-11-03 10:50:50,205 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:50:50,473 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:50:52,135 - INFO -      [2] ‚úì Batch fetched in 1.662s
2025-11-03 10:50:52,135 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:50:52,136 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:50:52,137 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:50:52,137 - INFO -      [2] Starting forward pass...
2025-11-03 10:50:52,349 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 287.3639 (accum_step 2/4)
2025-11-03 10:50:52,350 - INFO -      [2] Starting backward pass...
2025-11-03 10:50:52,361 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 10:50:52,634 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:50:54,531 - INFO -      [2] ‚úì Batch fetched in 1.897s
2025-11-03 10:50:54,531 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:50:54,538 - INFO -      [2] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:50:54,539 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:50:54,539 - INFO -      [2] Starting forward pass...
2025-11-03 10:50:54,762 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 290.7713 (accum_step 3/4)
2025-11-03 10:50:54,762 - INFO -      [2] Starting backward pass...
2025-11-03 10:50:54,774 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 10:50:55,042 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:50:56,441 - INFO -      [2] ‚úì Batch fetched in 1.399s
2025-11-03 10:50:56,442 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:50:56,449 - INFO -      [2] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:50:56,449 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:50:56,449 - INFO -      [2] Starting forward pass...
2025-11-03 10:50:56,662 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 291.8636 (accum_step 4/4)
2025-11-03 10:50:56,662 - INFO -      [2] Starting backward pass...
2025-11-03 10:50:56,674 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 10:50:56,942 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 10:50:56,951 - INFO -      [2] ‚úì Optimizer step completed in 0.010s, grad_norm = 326.9391
2025-11-03 10:50:56,952 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:50:58,938 - INFO -      [3] ‚úì Batch fetched in 1.987s
2025-11-03 10:50:59,171 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 286.0807 (accum_step 1/4)
2025-11-03 10:50:59,450 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:50:59,518 - INFO -      [3] ‚úì Batch fetched in 0.068s
2025-11-03 10:50:59,529 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 272.4683 (accum_step 2/4)
2025-11-03 10:50:59,542 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:51:01,392 - INFO -      [3] ‚úì Batch fetched in 1.850s
2025-11-03 10:51:01,621 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 282.6570 (accum_step 3/4)
2025-11-03 10:51:01,901 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:51:03,228 - INFO -      [3] ‚úì Batch fetched in 1.327s
2025-11-03 10:51:03,448 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 285.4397 (accum_step 4/4)
2025-11-03 10:51:03,737 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:51:05,059 - INFO -      [4] ‚úì Batch fetched in 1.321s
2025-11-03 10:51:05,274 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 278.2821 (accum_step 1/4)
2025-11-03 10:51:05,554 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:51:06,956 - INFO -      [4] ‚úì Batch fetched in 1.403s
2025-11-03 10:51:07,176 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 278.3765 (accum_step 2/4)
2025-11-03 10:51:07,456 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:51:09,035 - INFO -      [4] ‚úì Batch fetched in 1.578s
2025-11-03 10:51:09,255 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 277.2017 (accum_step 3/4)
2025-11-03 10:51:09,535 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:51:11,271 - INFO -      [4] ‚úì Batch fetched in 1.736s
2025-11-03 10:51:11,486 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 276.2232 (accum_step 4/4)
2025-11-03 10:51:11,774 - INFO -   Step 5/10: loss = 277.5209, avg_loss = 286.8325, lr = 0.000011, grad_norm = 327.9409
2025-11-03 10:51:11,775 - INFO -     ‚è±Ô∏è  Timing: total=8.037s (fetch=6.038s, to_device=0.017s, spec_compute=0.003s, forward=0.026s, backward=0.047s, optim=0.009s)
2025-11-03 10:51:11,775 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:51:11,813 - INFO -      [5] ‚úì Batch fetched in 0.038s
2025-11-03 10:51:11,823 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 278.1201 (accum_step 1/4)
2025-11-03 10:51:11,837 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:51:13,183 - INFO -      [5] ‚úì Batch fetched in 1.346s
2025-11-03 10:51:13,403 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 275.3315 (accum_step 2/4)
2025-11-03 10:51:13,682 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:51:14,757 - INFO -      [5] ‚úì Batch fetched in 1.075s
2025-11-03 10:51:14,977 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 272.9301 (accum_step 3/4)
2025-11-03 10:51:15,256 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:51:17,077 - INFO -      [5] ‚úì Batch fetched in 1.820s
2025-11-03 10:51:17,307 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 270.2318 (accum_step 4/4)
2025-11-03 10:51:17,596 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:51:19,001 - INFO -      [6] ‚úì Batch fetched in 1.405s
2025-11-03 10:51:19,221 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 260.5970 (accum_step 1/4)
2025-11-03 10:51:19,500 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:51:20,962 - INFO -      [6] ‚úì Batch fetched in 1.461s
2025-11-03 10:51:21,182 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 261.6462 (accum_step 2/4)
2025-11-03 10:51:21,462 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:51:23,081 - INFO -      [6] ‚úì Batch fetched in 1.619s
2025-11-03 10:51:23,301 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 263.5597 (accum_step 3/4)
2025-11-03 10:51:23,581 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:51:23,657 - INFO -      [6] ‚úì Batch fetched in 0.077s
2025-11-03 10:51:23,668 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 265.0888 (accum_step 4/4)
2025-11-03 10:51:23,692 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:51:25,186 - INFO -      [7] ‚úì Batch fetched in 1.494s
2025-11-03 10:51:25,406 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 248.2045 (accum_step 1/4)
2025-11-03 10:51:25,685 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:51:27,289 - INFO -      [7] ‚úì Batch fetched in 1.603s
2025-11-03 10:51:27,503 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.4247 (accum_step 2/4)
2025-11-03 10:51:27,783 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:51:29,252 - INFO -      [7] ‚úì Batch fetched in 1.469s
2025-11-03 10:51:29,466 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 251.9812 (accum_step 3/4)
2025-11-03 10:51:29,746 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:51:31,763 - INFO -      [7] ‚úì Batch fetched in 2.017s
2025-11-03 10:51:31,994 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 251.2314 (accum_step 4/4)
2025-11-03 10:51:32,284 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:51:34,006 - INFO -      [8] ‚úì Batch fetched in 1.722s
2025-11-03 10:51:34,226 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 241.6590 (accum_step 1/4)
2025-11-03 10:51:34,506 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:51:36,360 - INFO -      [8] ‚úì Batch fetched in 1.854s
2025-11-03 10:51:36,594 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 241.0665 (accum_step 2/4)
2025-11-03 10:51:36,874 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:51:36,931 - INFO -      [8] ‚úì Batch fetched in 0.057s
2025-11-03 10:51:36,942 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 234.7750 (accum_step 3/4)
2025-11-03 10:51:36,955 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:51:38,787 - INFO -      [8] ‚úì Batch fetched in 1.831s
2025-11-03 10:51:39,020 - INFO -      [8] ‚úì Forward pass completed in 0.008s, loss = 237.4151 (accum_step 4/4)
2025-11-03 10:51:39,310 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:51:40,545 - INFO -      [9] ‚úì Batch fetched in 1.234s
2025-11-03 10:51:40,765 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 227.9187 (accum_step 1/4)
2025-11-03 10:51:41,044 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:51:42,949 - INFO -      [9] ‚úì Batch fetched in 1.906s
2025-11-03 10:51:43,187 - INFO -      [9] ‚úì Forward pass completed in 0.008s, loss = 224.5947 (accum_step 2/4)
2025-11-03 10:51:43,467 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:51:44,717 - INFO -      [9] ‚úì Batch fetched in 1.250s
2025-11-03 10:51:44,937 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 225.4283 (accum_step 3/4)
2025-11-03 10:51:45,217 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:51:46,411 - INFO -      [9] ‚úì Batch fetched in 1.194s
2025-11-03 10:51:46,631 - INFO -      [9] ‚úì Forward pass completed in 0.008s, loss = 223.7738 (accum_step 4/4)
2025-11-03 10:51:46,921 - INFO -   Step 10/10: loss = 225.4289, avg_loss = 268.5907, lr = 0.000021, grad_norm = 278.4678
2025-11-03 10:51:46,921 - INFO -     ‚è±Ô∏è  Timing: total=7.610s (fetch=5.584s, to_device=0.026s, spec_compute=0.003s, forward=0.029s, backward=0.046s, optim=0.010s)
2025-11-03 10:51:46,921 - INFO - 
================================================================================
2025-11-03 10:51:46,921 - INFO - TRAINING SUMMARY:
2025-11-03 10:51:46,921 - INFO -   Steps Completed: 10
2025-11-03 10:51:46,921 - INFO -   Average Loss: 268.5907
2025-11-03 10:51:46,921 - INFO -   Best Validation Loss: inf
2025-11-03 10:51:46,921 - INFO - ================================================================================
2025-11-03 10:51:46,921 - INFO - 
================================================================================
2025-11-03 10:51:46,921 - INFO - TRAINING COMPLETED
2025-11-03 10:51:46,921 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:51:46,921 - INFO - Final step: 10
2025-11-03 10:51:46,921 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 10:51:46,922 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:51:46,922 - INFO - ================================================================================
2025-11-03 10:52:12,464 - INFO - ================================================================================
2025-11-03 10:52:12,464 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 10:52:12,464 - INFO - ================================================================================
2025-11-03 10:52:12,464 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:52:12,464 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:52:12,464 - INFO - ================================================================================
2025-11-03 10:52:12,465 - INFO - Device: cuda
2025-11-03 10:52:12,466 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 10:52:12,466 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 10:52:12,466 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 10:52:12,466 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=False
2025-11-03 10:52:12,466 - INFO -   Batch size: 128, Steps: 10
2025-11-03 10:52:12,466 - INFO -   Validation interval: 20 steps
2025-11-03 10:52:12,466 - INFO -   Log interval: 5 steps
2025-11-03 10:52:12,466 - INFO - 
Initializing model...
2025-11-03 10:52:13,072 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 10:52:13,073 - INFO -   Total parameters: 44,674,663
2025-11-03 10:52:13,073 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 10:52:16,170 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 10:52:16,170 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 10:52:16,179 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 10:52:16,179 - INFO - 
Setting up datasets...
2025-11-03 10:52:16,179 - INFO -   Loading MAESTRO dataset...
2025-11-03 10:52:17,938 - INFO -   ‚úì MAESTRO train: 200 samples (cached)
2025-11-03 10:52:17,940 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 10:52:17,940 - INFO -   Loading SLAKH stems dataset...
2025-11-03 10:52:19,660 - INFO -   ‚úì SLAKH stems train: 521 samples (cached)
2025-11-03 10:52:20,217 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 10:52:20,217 - INFO -   Loading SLAKH mix dataset...
2025-11-03 10:52:21,932 - INFO -   ‚úì SLAKH mix train: 50 samples (cached)
2025-11-03 10:52:22,000 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 10:52:22,000 - INFO - 
  Creating multi-task dataset...
2025-11-03 10:52:22,000 - INFO -   ‚úì Multi-task dataset: 771 total samples
2025-11-03 10:52:22,001 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0}
2025-11-03 10:52:22,001 - INFO - 
  Setting up validation data...
2025-11-03 10:52:22,001 - INFO -   ‚úì Validation: 247 samples
2025-11-03 10:52:22,002 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 10:52:22,002 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 10:52:22,002 - INFO -   Label smoothing: 0.1
2025-11-03 10:52:22,002 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 10:52:22,002 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 10:52:22,002 - INFO - 
Starting training...
2025-11-03 10:52:22,003 - INFO -   Total steps: 10
2025-11-03 10:52:22,003 - INFO -   Batch size: 128
2025-11-03 10:52:22,003 - INFO -   Learning rate: 0.0001
2025-11-03 10:52:22,003 - INFO -   Weight decay: 0.1
2025-11-03 10:52:22,003 - INFO -   Log interval: 5 steps
2025-11-03 10:52:22,003 - INFO -   Validation interval: 20 steps
2025-11-03 10:52:22,003 - INFO -   Save interval: 100 steps
2025-11-03 10:52:22,003 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 10:52:22,075 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 10:52:22,075 - INFO - 
================================================================================
2025-11-03 10:52:22,075 - INFO - STEP-BASED TRAINING
2025-11-03 10:52:22,075 - INFO -   Starting from step: 0
2025-11-03 10:52:22,075 - INFO -   Target steps: 10
2025-11-03 10:52:22,075 - INFO -   Batch size: 128
2025-11-03 10:52:22,075 - INFO -   Gradient accumulation steps: 4
2025-11-03 10:52:22,075 - INFO -   Effective batch size: 512
2025-11-03 10:52:22,075 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 10:52:22,075 - INFO - ================================================================================
2025-11-03 10:52:22,076 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 10:52:22,076 - INFO - 
üöÄ Starting training loop...
2025-11-03 10:52:22,076 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 10:52:22,076 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:52:23,742 - INFO -      [0] ‚úì Batch fetched in 1.666s
2025-11-03 10:52:23,742 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:52:23,748 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:52:24,048 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.300s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:52:24,049 - INFO -      [0] Starting forward pass...
2025-11-03 10:52:26,717 - INFO -      [0] ‚úì Forward pass completed in 2.668s, loss = 291.1241 (accum_step 1/4)
2025-11-03 10:52:26,717 - INFO -      [0] Starting backward pass...
2025-11-03 10:52:27,036 - INFO -      [0] ‚úì Backward pass completed in 0.319s
2025-11-03 10:52:27,057 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:52:27,057 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:27,057 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:52:27,061 - INFO -      [0] ‚úì Data moved to device in 0.004s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:52:27,062 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:52:27,062 - INFO -      [0] Starting forward pass...
2025-11-03 10:52:27,274 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 293.0616 (accum_step 2/4)
2025-11-03 10:52:27,274 - INFO -      [0] Starting backward pass...
2025-11-03 10:52:27,289 - INFO -      [0] ‚úì Backward pass completed in 0.015s
2025-11-03 10:52:27,534 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:52:27,534 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:27,534 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:52:27,535 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:52:27,536 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:52:27,536 - INFO -      [0] Starting forward pass...
2025-11-03 10:52:27,748 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 293.0715 (accum_step 3/4)
2025-11-03 10:52:27,748 - INFO -      [0] Starting backward pass...
2025-11-03 10:52:27,759 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:52:28,007 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:52:28,007 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:28,008 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:52:28,008 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:52:28,009 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:52:28,009 - INFO -      [0] Starting forward pass...
2025-11-03 10:52:28,221 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 290.8759 (accum_step 4/4)
2025-11-03 10:52:28,221 - INFO -      [0] Starting backward pass...
2025-11-03 10:52:28,232 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:52:28,481 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 10:52:28,584 - INFO -      [0] ‚úì Optimizer step completed in 0.102s, grad_norm = 323.8849
2025-11-03 10:52:28,584 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:52:28,584 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:28,584 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:52:28,591 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:52:28,592 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:52:28,592 - INFO -      [1] Starting forward pass...
2025-11-03 10:52:28,806 - INFO -      [1] ‚úì Forward pass completed in 0.040s, loss = 288.4333 (accum_step 1/4)
2025-11-03 10:52:28,806 - INFO -      [1] Starting backward pass...
2025-11-03 10:52:28,821 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 10:52:29,072 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:52:29,072 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:29,073 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:52:29,081 - INFO -      [1] ‚úì Data moved to device in 0.009s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:52:29,082 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:52:29,082 - INFO -      [1] Starting forward pass...
2025-11-03 10:52:29,295 - INFO -      [1] ‚úì Forward pass completed in 0.013s, loss = 290.6924 (accum_step 2/4)
2025-11-03 10:52:29,295 - INFO -      [1] Starting backward pass...
2025-11-03 10:52:29,311 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 10:52:29,554 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:52:29,555 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:29,555 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:52:29,555 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 10:52:29,556 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([3, 256, 512]))
2025-11-03 10:52:29,556 - INFO -      [1] Starting forward pass...
2025-11-03 10:52:32,177 - INFO -      [1] ‚úì Forward pass completed in 2.620s, loss = 278.7946 (accum_step 3/4)
2025-11-03 10:52:32,177 - INFO -      [1] Starting backward pass...
2025-11-03 10:52:32,192 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 10:52:32,194 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:52:34,077 - INFO -      [1] ‚úì Batch fetched in 1.883s
2025-11-03 10:52:34,078 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:52:34,083 - INFO -      [1] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:52:34,084 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:52:34,084 - INFO -      [1] Starting forward pass...
2025-11-03 10:52:34,309 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 291.5408 (accum_step 4/4)
2025-11-03 10:52:34,309 - INFO -      [1] Starting backward pass...
2025-11-03 10:52:34,321 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 10:52:34,589 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 10:52:34,599 - INFO -      [1] ‚úì Optimizer step completed in 0.009s, grad_norm = 321.6044
2025-11-03 10:52:34,599 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:52:34,599 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:34,599 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:52:34,602 - INFO -      [2] ‚úì Data moved to device in 0.004s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:52:34,603 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:52:34,603 - INFO -      [2] Starting forward pass...
2025-11-03 10:52:34,815 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 291.2738 (accum_step 1/4)
2025-11-03 10:52:34,816 - INFO -      [2] Starting backward pass...
2025-11-03 10:52:34,826 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:52:35,095 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:52:35,095 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:35,095 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:52:35,096 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:52:35,097 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:52:35,097 - INFO -      [2] Starting forward pass...
2025-11-03 10:52:35,309 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.5378 (accum_step 2/4)
2025-11-03 10:52:35,309 - INFO -      [2] Starting backward pass...
2025-11-03 10:52:35,320 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 10:52:35,589 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:52:35,589 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:35,589 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:52:35,593 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:52:35,593 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:52:35,593 - INFO -      [2] Starting forward pass...
2025-11-03 10:52:35,806 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.1874 (accum_step 3/4)
2025-11-03 10:52:35,806 - INFO -      [2] Starting backward pass...
2025-11-03 10:52:35,816 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:52:36,085 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:52:36,086 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:36,086 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:52:36,087 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:52:36,088 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:52:36,088 - INFO -      [2] Starting forward pass...
2025-11-03 10:52:36,300 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 290.8770 (accum_step 4/4)
2025-11-03 10:52:36,300 - INFO -      [2] Starting backward pass...
2025-11-03 10:52:36,311 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 10:52:36,580 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 10:52:36,590 - INFO -      [2] ‚úì Optimizer step completed in 0.009s, grad_norm = 328.5470
2025-11-03 10:52:36,590 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:52:36,590 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:36,806 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 281.3300 (accum_step 1/4)
2025-11-03 10:52:37,085 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:52:37,086 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:37,096 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 290.6568 (accum_step 2/4)
2025-11-03 10:52:37,109 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:52:38,975 - INFO -      [3] ‚úì Batch fetched in 1.866s
2025-11-03 10:52:39,215 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 287.5552 (accum_step 3/4)
2025-11-03 10:52:39,500 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:52:39,501 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:39,716 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 287.9840 (accum_step 4/4)
2025-11-03 10:52:40,005 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:52:40,005 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:40,219 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 278.7088 (accum_step 1/4)
2025-11-03 10:52:40,499 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:52:40,499 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:40,715 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 279.6737 (accum_step 2/4)
2025-11-03 10:52:40,995 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:52:40,996 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:41,214 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 275.8615 (accum_step 3/4)
2025-11-03 10:52:41,494 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:52:41,495 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:41,711 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 277.5234 (accum_step 4/4)
2025-11-03 10:52:41,999 - INFO -   Step 5/10: loss = 277.9418, avg_loss = 286.7882, lr = 0.000011, grad_norm = 329.3373
2025-11-03 10:52:42,000 - INFO -     ‚è±Ô∏è  Timing: total=1.994s (fetch=0.001s, to_device=0.013s, spec_compute=0.002s, forward=0.025s, backward=0.042s, optim=0.009s)
2025-11-03 10:52:42,000 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:52:42,000 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:42,010 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 257.0849 (accum_step 1/4)
2025-11-03 10:52:42,023 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:52:43,732 - INFO -      [5] ‚úì Batch fetched in 1.709s
2025-11-03 10:52:43,948 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 274.3901 (accum_step 2/4)
2025-11-03 10:52:44,228 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:52:44,229 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:44,443 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 268.5466 (accum_step 3/4)
2025-11-03 10:52:44,723 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:52:44,723 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:44,939 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 272.5507 (accum_step 4/4)
2025-11-03 10:52:45,229 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:52:45,229 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:45,448 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.8611 (accum_step 1/4)
2025-11-03 10:52:45,727 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:52:45,727 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:45,943 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 260.5174 (accum_step 2/4)
2025-11-03 10:52:46,222 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:52:46,222 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:46,439 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 260.0919 (accum_step 3/4)
2025-11-03 10:52:46,717 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:52:46,718 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:46,728 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 268.2295 (accum_step 4/4)
2025-11-03 10:52:46,750 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:52:48,702 - INFO -      [7] ‚úì Batch fetched in 1.953s
2025-11-03 10:52:48,939 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 251.0477 (accum_step 1/4)
2025-11-03 10:52:49,219 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:52:49,219 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:49,435 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.9975 (accum_step 2/4)
2025-11-03 10:52:49,714 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:52:49,715 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:49,928 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 250.5160 (accum_step 3/4)
2025-11-03 10:52:50,207 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:52:50,207 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:50,426 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.8857 (accum_step 4/4)
2025-11-03 10:52:50,715 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:52:50,716 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:50,933 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.0529 (accum_step 1/4)
2025-11-03 10:52:51,211 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:52:51,212 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:51,428 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 235.1859 (accum_step 2/4)
2025-11-03 10:52:51,707 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:52:51,707 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:51,717 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 217.0584 (accum_step 3/4)
2025-11-03 10:52:51,730 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:52:53,059 - INFO -      [8] ‚úì Batch fetched in 1.329s
2025-11-03 10:52:53,274 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 238.5421 (accum_step 4/4)
2025-11-03 10:52:53,564 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:52:53,965 - INFO -      [9] ‚úì Batch fetched in 0.400s
2025-11-03 10:52:54,183 - INFO -      [9] ‚úì Forward pass completed in 0.008s, loss = 229.8923 (accum_step 1/4)
2025-11-03 10:52:54,462 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:52:54,463 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:54,682 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 226.7854 (accum_step 2/4)
2025-11-03 10:52:54,961 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:52:54,962 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:55,178 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.5408 (accum_step 3/4)
2025-11-03 10:52:55,457 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:52:55,458 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:52:55,674 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.7862 (accum_step 4/4)
2025-11-03 10:52:55,963 - INFO -   Step 10/10: loss = 227.5012, avg_loss = 267.5332, lr = 0.000021, grad_norm = 280.5563
2025-11-03 10:52:55,963 - INFO -     ‚è±Ô∏è  Timing: total=2.399s (fetch=0.402s, to_device=0.017s, spec_compute=0.003s, forward=0.028s, backward=0.045s, optim=0.009s)
2025-11-03 10:52:55,963 - INFO - 
================================================================================
2025-11-03 10:52:55,963 - INFO - TRAINING SUMMARY:
2025-11-03 10:52:55,963 - INFO -   Steps Completed: 10
2025-11-03 10:52:55,963 - INFO -   Average Loss: 267.5332
2025-11-03 10:52:55,963 - INFO -   Best Validation Loss: inf
2025-11-03 10:52:55,964 - INFO - ================================================================================
2025-11-03 10:52:55,964 - INFO - 
================================================================================
2025-11-03 10:52:55,964 - INFO - TRAINING COMPLETED
2025-11-03 10:52:55,964 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:52:55,964 - INFO - Final step: 10
2025-11-03 10:52:55,964 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 10:52:55,964 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:52:55,964 - INFO - ================================================================================
2025-11-03 10:53:06,339 - INFO - ================================================================================
2025-11-03 10:53:06,339 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 10:53:06,339 - INFO - ================================================================================
2025-11-03 10:53:06,339 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:53:06,339 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:53:06,339 - INFO - ================================================================================
2025-11-03 10:53:06,340 - INFO - Device: cuda
2025-11-03 10:53:06,340 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 10:53:06,340 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 10:53:06,340 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 10:53:06,340 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=False
2025-11-03 10:53:06,340 - INFO -   Batch size: 128, Steps: 10
2025-11-03 10:53:06,341 - INFO -   Validation interval: 20 steps
2025-11-03 10:53:06,341 - INFO -   Log interval: 5 steps
2025-11-03 10:53:06,341 - INFO - 
Initializing model...
2025-11-03 10:53:06,954 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 10:53:06,955 - INFO -   Total parameters: 44,674,663
2025-11-03 10:53:06,955 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 10:53:10,070 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 10:53:10,070 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 10:53:10,079 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 10:53:10,079 - INFO - 
Setting up datasets...
2025-11-03 10:53:10,079 - INFO -   Loading MAESTRO dataset...
2025-11-03 10:53:11,793 - INFO -   ‚úì MAESTRO train: 200 samples (cached)
2025-11-03 10:53:11,794 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 10:53:11,795 - INFO -   Loading SLAKH stems dataset...
2025-11-03 10:53:13,483 - INFO -   ‚úì SLAKH stems train: 521 samples (cached)
2025-11-03 10:53:14,021 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 10:53:14,021 - INFO -   Loading SLAKH mix dataset...
2025-11-03 10:53:15,710 - INFO -   ‚úì SLAKH mix train: 50 samples (cached)
2025-11-03 10:53:15,771 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 10:53:15,771 - INFO - 
  Creating multi-task dataset...
2025-11-03 10:53:15,771 - INFO -   ‚úì Multi-task dataset: 771 total samples
2025-11-03 10:53:15,771 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0}
2025-11-03 10:53:15,771 - INFO - 
  Setting up validation data...
2025-11-03 10:53:15,772 - INFO -   ‚úì Validation: 247 samples
2025-11-03 10:53:15,773 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 10:53:15,773 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 10:53:15,773 - INFO -   Label smoothing: 0.1
2025-11-03 10:53:15,773 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 10:53:15,773 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 10:53:15,773 - INFO - 
Starting training...
2025-11-03 10:53:15,773 - INFO -   Total steps: 10
2025-11-03 10:53:15,774 - INFO -   Batch size: 128
2025-11-03 10:53:15,774 - INFO -   Learning rate: 0.0001
2025-11-03 10:53:15,774 - INFO -   Weight decay: 0.1
2025-11-03 10:53:15,774 - INFO -   Log interval: 5 steps
2025-11-03 10:53:15,774 - INFO -   Validation interval: 20 steps
2025-11-03 10:53:15,774 - INFO -   Save interval: 100 steps
2025-11-03 10:53:15,774 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 10:53:15,836 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 10:53:15,836 - INFO - 
================================================================================
2025-11-03 10:53:15,836 - INFO - STEP-BASED TRAINING
2025-11-03 10:53:15,836 - INFO -   Starting from step: 0
2025-11-03 10:53:15,836 - INFO -   Target steps: 10
2025-11-03 10:53:15,836 - INFO -   Batch size: 128
2025-11-03 10:53:15,836 - INFO -   Gradient accumulation steps: 4
2025-11-03 10:53:15,836 - INFO -   Effective batch size: 512
2025-11-03 10:53:15,836 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 10:53:15,836 - INFO - ================================================================================
2025-11-03 10:53:15,836 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 10:53:15,837 - INFO - 
üöÄ Starting training loop...
2025-11-03 10:53:15,837 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 10:53:15,837 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:53:17,605 - INFO -      [0] ‚úì Batch fetched in 1.769s
2025-11-03 10:53:17,606 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:53:17,612 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:53:17,917 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.305s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:53:17,918 - INFO -      [0] Starting forward pass...
2025-11-03 10:53:20,540 - INFO -      [0] ‚úì Forward pass completed in 2.622s, loss = 291.1241 (accum_step 1/4)
2025-11-03 10:53:20,540 - INFO -      [0] Starting backward pass...
2025-11-03 10:53:20,855 - INFO -      [0] ‚úì Backward pass completed in 0.315s
2025-11-03 10:53:20,876 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:53:20,876 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:20,876 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:53:20,882 - INFO -      [0] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:53:20,882 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:53:20,883 - INFO -      [0] Starting forward pass...
2025-11-03 10:53:21,095 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 293.0616 (accum_step 2/4)
2025-11-03 10:53:21,095 - INFO -      [0] Starting backward pass...
2025-11-03 10:53:21,110 - INFO -      [0] ‚úì Backward pass completed in 0.014s
2025-11-03 10:53:21,355 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:53:21,356 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:21,356 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:53:21,356 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:53:21,357 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:53:21,357 - INFO -      [0] Starting forward pass...
2025-11-03 10:53:21,570 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 293.0716 (accum_step 3/4)
2025-11-03 10:53:21,570 - INFO -      [0] Starting backward pass...
2025-11-03 10:53:21,581 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:53:21,830 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:53:21,830 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:21,830 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:53:21,834 - INFO -      [0] ‚úì Data moved to device in 0.004s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:53:21,834 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:53:21,834 - INFO -      [0] Starting forward pass...
2025-11-03 10:53:22,047 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 290.8759 (accum_step 4/4)
2025-11-03 10:53:22,047 - INFO -      [0] Starting backward pass...
2025-11-03 10:53:22,058 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:53:22,306 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 10:53:22,408 - INFO -      [0] ‚úì Optimizer step completed in 0.102s, grad_norm = 323.8849
2025-11-03 10:53:22,409 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:53:22,409 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:22,409 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:53:22,421 - INFO -      [1] ‚úì Data moved to device in 0.012s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:53:22,422 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:53:22,422 - INFO -      [1] Starting forward pass...
2025-11-03 10:53:22,635 - INFO -      [1] ‚úì Forward pass completed in 0.041s, loss = 289.7845 (accum_step 1/4)
2025-11-03 10:53:22,636 - INFO -      [1] Starting backward pass...
2025-11-03 10:53:22,653 - INFO -      [1] ‚úì Backward pass completed in 0.017s
2025-11-03 10:53:22,903 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:53:22,904 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:22,904 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:53:22,906 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:53:22,907 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:53:22,907 - INFO -      [1] Starting forward pass...
2025-11-03 10:53:23,120 - INFO -      [1] ‚úì Forward pass completed in 0.012s, loss = 290.7374 (accum_step 2/4)
2025-11-03 10:53:23,120 - INFO -      [1] Starting backward pass...
2025-11-03 10:53:23,137 - INFO -      [1] ‚úì Backward pass completed in 0.017s
2025-11-03 10:53:23,380 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:53:23,380 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:23,380 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:53:23,380 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 10:53:23,382 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.002s (shape: torch.Size([3, 256, 512]))
2025-11-03 10:53:23,382 - INFO -      [1] Starting forward pass...
2025-11-03 10:53:25,976 - INFO -      [1] ‚úì Forward pass completed in 2.594s, loss = 296.0802 (accum_step 3/4)
2025-11-03 10:53:25,977 - INFO -      [1] Starting backward pass...
2025-11-03 10:53:25,992 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 10:53:25,994 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:53:27,538 - INFO -      [1] ‚úì Batch fetched in 1.544s
2025-11-03 10:53:27,539 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:53:27,545 - INFO -      [1] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:53:27,545 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:53:27,546 - INFO -      [1] Starting forward pass...
2025-11-03 10:53:27,777 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 288.2697 (accum_step 4/4)
2025-11-03 10:53:27,777 - INFO -      [1] Starting backward pass...
2025-11-03 10:53:27,789 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 10:53:28,058 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 10:53:28,067 - INFO -      [1] ‚úì Optimizer step completed in 0.009s, grad_norm = 327.2296
2025-11-03 10:53:28,067 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:53:28,067 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:28,067 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:53:28,068 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:53:28,069 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:53:28,069 - INFO -      [2] Starting forward pass...
2025-11-03 10:53:28,281 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.1778 (accum_step 1/4)
2025-11-03 10:53:28,282 - INFO -      [2] Starting backward pass...
2025-11-03 10:53:28,291 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 10:53:28,561 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:53:28,561 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:28,561 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:53:28,566 - INFO -      [2] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:53:28,567 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:53:28,567 - INFO -      [2] Starting forward pass...
2025-11-03 10:53:28,780 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.3394 (accum_step 2/4)
2025-11-03 10:53:28,780 - INFO -      [2] Starting backward pass...
2025-11-03 10:53:28,790 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 10:53:29,060 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:53:29,060 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:29,061 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:53:29,064 - INFO -      [2] ‚úì Data moved to device in 0.004s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:53:29,065 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:53:29,065 - INFO -      [2] Starting forward pass...
2025-11-03 10:53:29,277 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.1925 (accum_step 3/4)
2025-11-03 10:53:29,277 - INFO -      [2] Starting backward pass...
2025-11-03 10:53:29,287 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 10:53:29,557 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:53:29,557 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:29,557 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:53:29,563 - INFO -      [2] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:53:29,563 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:53:29,563 - INFO -      [2] Starting forward pass...
2025-11-03 10:53:29,775 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 291.7756 (accum_step 4/4)
2025-11-03 10:53:29,776 - INFO -      [2] Starting backward pass...
2025-11-03 10:53:29,787 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:53:30,056 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 10:53:30,063 - INFO -      [2] ‚úì Optimizer step completed in 0.008s, grad_norm = 327.2442
2025-11-03 10:53:30,064 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:53:30,064 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:30,278 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 286.3654 (accum_step 1/4)
2025-11-03 10:53:30,558 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:53:30,558 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:30,569 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 292.0167 (accum_step 2/4)
2025-11-03 10:53:30,583 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:53:32,388 - INFO -      [3] ‚úì Batch fetched in 1.805s
2025-11-03 10:53:32,616 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 284.7546 (accum_step 3/4)
2025-11-03 10:53:32,897 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:53:32,897 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:33,116 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 286.9001 (accum_step 4/4)
2025-11-03 10:53:33,405 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:53:33,405 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:33,624 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 279.0455 (accum_step 1/4)
2025-11-03 10:53:33,903 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:53:33,903 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:34,117 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 279.6483 (accum_step 2/4)
2025-11-03 10:53:34,397 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:53:34,397 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:34,616 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 280.6212 (accum_step 3/4)
2025-11-03 10:53:34,896 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:53:34,897 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:35,113 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 281.8134 (accum_step 4/4)
2025-11-03 10:53:35,401 - INFO -   Step 5/10: loss = 280.2821, avg_loss = 288.0328, lr = 0.000011, grad_norm = 331.7499
2025-11-03 10:53:35,401 - INFO -     ‚è±Ô∏è  Timing: total=1.996s (fetch=0.001s, to_device=0.016s, spec_compute=0.002s, forward=0.023s, backward=0.042s, optim=0.008s)
2025-11-03 10:53:35,402 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:53:35,402 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:35,412 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 285.3736 (accum_step 1/4)
2025-11-03 10:53:35,424 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:53:37,138 - INFO -      [5] ‚úì Batch fetched in 1.713s
2025-11-03 10:53:37,375 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 272.3881 (accum_step 2/4)
2025-11-03 10:53:37,659 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:53:37,659 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:37,878 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 267.7397 (accum_step 3/4)
2025-11-03 10:53:38,158 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:53:38,158 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:38,374 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 271.6113 (accum_step 4/4)
2025-11-03 10:53:38,663 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:53:38,663 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:38,882 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.7928 (accum_step 1/4)
2025-11-03 10:53:39,161 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:53:39,161 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:39,380 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.7071 (accum_step 2/4)
2025-11-03 10:53:39,659 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:53:39,659 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:39,878 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.3292 (accum_step 3/4)
2025-11-03 10:53:40,157 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:53:40,157 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:40,168 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 274.5581 (accum_step 4/4)
2025-11-03 10:53:40,190 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:53:42,019 - INFO -      [7] ‚úì Batch fetched in 1.830s
2025-11-03 10:53:42,259 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 252.8150 (accum_step 1/4)
2025-11-03 10:53:42,538 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:53:42,538 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:42,758 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 253.2111 (accum_step 2/4)
2025-11-03 10:53:43,037 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:53:43,037 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:43,251 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.0072 (accum_step 3/4)
2025-11-03 10:53:43,530 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:53:43,530 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:43,744 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.7380 (accum_step 4/4)
2025-11-03 10:53:44,032 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:53:44,032 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:44,251 - INFO -      [8] ‚úì Forward pass completed in 0.005s, loss = 240.2991 (accum_step 1/4)
2025-11-03 10:53:44,531 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:53:44,531 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:44,750 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.2614 (accum_step 2/4)
2025-11-03 10:53:45,029 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:53:45,029 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:45,040 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 234.9922 (accum_step 3/4)
2025-11-03 10:53:45,053 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:53:46,809 - INFO -      [8] ‚úì Batch fetched in 1.756s
2025-11-03 10:53:47,049 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 236.0594 (accum_step 4/4)
2025-11-03 10:53:47,339 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:53:47,340 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:47,558 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 224.6680 (accum_step 1/4)
2025-11-03 10:53:47,837 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:53:47,837 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:48,051 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 226.2681 (accum_step 2/4)
2025-11-03 10:53:48,331 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:53:48,331 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:53:48,550 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 226.2916 (accum_step 3/4)
2025-11-03 10:53:48,830 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:53:48,830 - INFO -      [9] ‚úì Batch fetched in 0.001s
2025-11-03 10:53:49,049 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 225.2047 (accum_step 4/4)
2025-11-03 10:53:49,336 - INFO -   Step 10/10: loss = 225.6081, avg_loss = 269.4493, lr = 0.000021, grad_norm = 277.8607
2025-11-03 10:53:49,336 - INFO -     ‚è±Ô∏è  Timing: total=1.997s (fetch=0.001s, to_device=0.018s, spec_compute=0.002s, forward=0.023s, backward=0.040s, optim=0.008s)
2025-11-03 10:53:49,336 - INFO - 
================================================================================
2025-11-03 10:53:49,336 - INFO - TRAINING SUMMARY:
2025-11-03 10:53:49,337 - INFO -   Steps Completed: 10
2025-11-03 10:53:49,337 - INFO -   Average Loss: 269.4493
2025-11-03 10:53:49,337 - INFO -   Best Validation Loss: inf
2025-11-03 10:53:49,337 - INFO - ================================================================================
2025-11-03 10:53:49,337 - INFO - 
================================================================================
2025-11-03 10:53:49,337 - INFO - TRAINING COMPLETED
2025-11-03 10:53:49,337 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:53:49,337 - INFO - Final step: 10
2025-11-03 10:53:49,337 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 10:53:49,337 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:53:49,337 - INFO - ================================================================================
2025-11-03 10:54:01,642 - INFO - ================================================================================
2025-11-03 10:54:01,642 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 10:54:01,642 - INFO - ================================================================================
2025-11-03 10:54:01,642 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:54:01,642 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:54:01,642 - INFO - ================================================================================
2025-11-03 10:54:01,643 - INFO - Device: cuda
2025-11-03 10:54:01,643 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 10:54:01,643 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 10:54:01,643 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 10:54:01,643 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=False
2025-11-03 10:54:01,643 - INFO -   Batch size: 128, Steps: 10
2025-11-03 10:54:01,644 - INFO -   Validation interval: 20 steps
2025-11-03 10:54:01,644 - INFO -   Log interval: 5 steps
2025-11-03 10:54:01,644 - INFO - 
Initializing model...
2025-11-03 10:54:02,244 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 10:54:02,245 - INFO -   Total parameters: 44,674,663
2025-11-03 10:54:02,245 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 10:54:05,293 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 10:54:05,293 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 10:54:05,301 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 10:54:05,302 - INFO - 
Setting up datasets...
2025-11-03 10:54:05,302 - INFO -   Loading MAESTRO dataset...
2025-11-03 10:54:07,009 - INFO -   ‚úì MAESTRO train: 200 samples (cached)
2025-11-03 10:54:07,010 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 10:54:07,010 - INFO -   Loading SLAKH stems dataset...
2025-11-03 10:54:08,693 - INFO -   ‚úì SLAKH stems train: 521 samples (cached)
2025-11-03 10:54:09,224 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 10:54:09,224 - INFO -   Loading SLAKH mix dataset...
2025-11-03 10:54:10,925 - INFO -   ‚úì SLAKH mix train: 50 samples (cached)
2025-11-03 10:54:10,987 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 10:54:10,988 - INFO - 
  Creating multi-task dataset...
2025-11-03 10:54:10,988 - INFO -   ‚úì Multi-task dataset: 771 total samples
2025-11-03 10:54:10,988 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0}
2025-11-03 10:54:10,988 - INFO - 
  Setting up validation data...
2025-11-03 10:54:10,988 - INFO -   ‚úì Validation: 247 samples
2025-11-03 10:54:10,989 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 10:54:10,989 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 10:54:10,989 - INFO -   Label smoothing: 0.1
2025-11-03 10:54:10,989 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 10:54:10,989 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 10:54:10,989 - INFO - 
Starting training...
2025-11-03 10:54:10,989 - INFO -   Total steps: 10
2025-11-03 10:54:10,989 - INFO -   Batch size: 128
2025-11-03 10:54:10,990 - INFO -   Learning rate: 0.0001
2025-11-03 10:54:10,990 - INFO -   Weight decay: 0.1
2025-11-03 10:54:10,990 - INFO -   Log interval: 5 steps
2025-11-03 10:54:10,990 - INFO -   Validation interval: 20 steps
2025-11-03 10:54:10,990 - INFO -   Save interval: 100 steps
2025-11-03 10:54:10,990 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 10:54:11,057 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 10:54:11,057 - INFO - 
================================================================================
2025-11-03 10:54:11,057 - INFO - STEP-BASED TRAINING
2025-11-03 10:54:11,057 - INFO -   Starting from step: 0
2025-11-03 10:54:11,057 - INFO -   Target steps: 10
2025-11-03 10:54:11,058 - INFO -   Batch size: 128
2025-11-03 10:54:11,058 - INFO -   Gradient accumulation steps: 4
2025-11-03 10:54:11,058 - INFO -   Effective batch size: 512
2025-11-03 10:54:11,058 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 10:54:11,058 - INFO - ================================================================================
2025-11-03 10:54:11,058 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 10:54:11,058 - INFO - 
üöÄ Starting training loop...
2025-11-03 10:54:11,058 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 10:54:11,058 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:54:13,219 - INFO -      [0] ‚úì Batch fetched in 2.161s
2025-11-03 10:54:13,219 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:54:13,225 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:54:13,529 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.304s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:54:13,529 - INFO -      [0] Starting forward pass...
2025-11-03 10:54:16,160 - INFO -      [0] ‚úì Forward pass completed in 2.630s, loss = 291.1241 (accum_step 1/4)
2025-11-03 10:54:16,160 - INFO -      [0] Starting backward pass...
2025-11-03 10:54:16,475 - INFO -      [0] ‚úì Backward pass completed in 0.315s
2025-11-03 10:54:16,496 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:54:16,496 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:16,496 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:54:16,503 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:54:16,503 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:54:16,504 - INFO -      [0] Starting forward pass...
2025-11-03 10:54:16,716 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 293.0616 (accum_step 2/4)
2025-11-03 10:54:16,716 - INFO -      [0] Starting backward pass...
2025-11-03 10:54:16,731 - INFO -      [0] ‚úì Backward pass completed in 0.015s
2025-11-03 10:54:16,976 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:54:16,976 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:16,976 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:54:16,980 - INFO -      [0] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:54:16,981 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:54:16,981 - INFO -      [0] Starting forward pass...
2025-11-03 10:54:17,193 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 293.0715 (accum_step 3/4)
2025-11-03 10:54:17,194 - INFO -      [0] Starting backward pass...
2025-11-03 10:54:17,205 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:54:17,453 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:54:17,453 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:17,453 - INFO -      [0] Moving data to device cuda...
2025-11-03 10:54:17,454 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:54:17,455 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:54:17,455 - INFO -      [0] Starting forward pass...
2025-11-03 10:54:17,667 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 290.8759 (accum_step 4/4)
2025-11-03 10:54:17,667 - INFO -      [0] Starting backward pass...
2025-11-03 10:54:17,678 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 10:54:17,927 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 10:54:18,028 - INFO -      [0] ‚úì Optimizer step completed in 0.101s, grad_norm = 323.8849
2025-11-03 10:54:18,029 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:54:18,029 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:18,029 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:54:18,041 - INFO -      [1] ‚úì Data moved to device in 0.012s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:54:18,042 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:54:18,042 - INFO -      [1] Starting forward pass...
2025-11-03 10:54:18,256 - INFO -      [1] ‚úì Forward pass completed in 0.040s, loss = 289.7846 (accum_step 1/4)
2025-11-03 10:54:18,256 - INFO -      [1] Starting backward pass...
2025-11-03 10:54:18,271 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 10:54:18,523 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:54:18,523 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:18,523 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:54:18,536 - INFO -      [1] ‚úì Data moved to device in 0.013s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:54:18,537 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:54:18,537 - INFO -      [1] Starting forward pass...
2025-11-03 10:54:18,750 - INFO -      [1] ‚úì Forward pass completed in 0.012s, loss = 290.7375 (accum_step 2/4)
2025-11-03 10:54:18,750 - INFO -      [1] Starting backward pass...
2025-11-03 10:54:18,767 - INFO -      [1] ‚úì Backward pass completed in 0.017s
2025-11-03 10:54:19,010 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:54:19,010 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:19,010 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:54:19,010 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([3, 256, 128]), targets: torch.Size([3, 1024]))
2025-11-03 10:54:19,012 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([3, 256, 512]))
2025-11-03 10:54:19,012 - INFO -      [1] Starting forward pass...
2025-11-03 10:54:21,632 - INFO -      [1] ‚úì Forward pass completed in 2.620s, loss = 296.0805 (accum_step 3/4)
2025-11-03 10:54:21,633 - INFO -      [1] Starting backward pass...
2025-11-03 10:54:21,648 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 10:54:21,650 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:54:23,152 - INFO -      [1] ‚úì Batch fetched in 1.502s
2025-11-03 10:54:23,152 - INFO -      [1] Moving data to device cuda...
2025-11-03 10:54:23,158 - INFO -      [1] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:54:23,159 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:54:23,159 - INFO -      [1] Starting forward pass...
2025-11-03 10:54:23,392 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 288.2697 (accum_step 4/4)
2025-11-03 10:54:23,392 - INFO -      [1] Starting backward pass...
2025-11-03 10:54:23,404 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 10:54:23,678 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 10:54:23,689 - INFO -      [1] ‚úì Optimizer step completed in 0.010s, grad_norm = 327.2297
2025-11-03 10:54:23,689 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:54:23,689 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:23,689 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:54:23,692 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:54:23,693 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:54:23,693 - INFO -      [2] Starting forward pass...
2025-11-03 10:54:23,905 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.1778 (accum_step 1/4)
2025-11-03 10:54:23,905 - INFO -      [2] Starting backward pass...
2025-11-03 10:54:23,916 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 10:54:24,184 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:54:24,184 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:24,184 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:54:24,185 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:54:24,186 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:54:24,186 - INFO -      [2] Starting forward pass...
2025-11-03 10:54:24,398 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.3392 (accum_step 2/4)
2025-11-03 10:54:24,398 - INFO -      [2] Starting backward pass...
2025-11-03 10:54:24,409 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:54:24,678 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:54:24,678 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:24,678 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:54:24,684 - INFO -      [2] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:54:24,685 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:54:24,685 - INFO -      [2] Starting forward pass...
2025-11-03 10:54:24,897 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.1927 (accum_step 3/4)
2025-11-03 10:54:24,898 - INFO -      [2] Starting backward pass...
2025-11-03 10:54:24,909 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:54:25,177 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:54:25,178 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:25,178 - INFO -      [2] Moving data to device cuda...
2025-11-03 10:54:25,183 - INFO -      [2] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 10:54:25,183 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 10:54:25,183 - INFO -      [2] Starting forward pass...
2025-11-03 10:54:25,396 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 291.7757 (accum_step 4/4)
2025-11-03 10:54:25,396 - INFO -      [2] Starting backward pass...
2025-11-03 10:54:25,407 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 10:54:25,676 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 10:54:25,685 - INFO -      [2] ‚úì Optimizer step completed in 0.009s, grad_norm = 327.2442
2025-11-03 10:54:25,685 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:54:25,685 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:25,904 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 286.3654 (accum_step 1/4)
2025-11-03 10:54:26,184 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:54:26,184 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:26,194 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 292.0154 (accum_step 2/4)
2025-11-03 10:54:26,208 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:54:27,989 - INFO -      [3] ‚úì Batch fetched in 1.781s
2025-11-03 10:54:28,209 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 284.7547 (accum_step 3/4)
2025-11-03 10:54:28,489 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:54:28,489 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:28,703 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 286.8998 (accum_step 4/4)
2025-11-03 10:54:28,992 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:54:28,993 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:29,210 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 279.0454 (accum_step 1/4)
2025-11-03 10:54:29,490 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:54:29,490 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:29,710 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 279.6483 (accum_step 2/4)
2025-11-03 10:54:29,990 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:54:29,990 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:30,208 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 280.6208 (accum_step 3/4)
2025-11-03 10:54:30,488 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:54:30,488 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:30,702 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 281.8132 (accum_step 4/4)
2025-11-03 10:54:30,991 - INFO -   Step 5/10: loss = 280.2819, avg_loss = 288.0327, lr = 0.000011, grad_norm = 331.7499
2025-11-03 10:54:30,991 - INFO -     ‚è±Ô∏è  Timing: total=1.998s (fetch=0.001s, to_device=0.016s, spec_compute=0.002s, forward=0.024s, backward=0.044s, optim=0.009s)
2025-11-03 10:54:30,991 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:54:30,991 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:31,001 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 285.3749 (accum_step 1/4)
2025-11-03 10:54:31,014 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:54:32,689 - INFO -      [5] ‚úì Batch fetched in 1.675s
2025-11-03 10:54:32,904 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 272.3883 (accum_step 2/4)
2025-11-03 10:54:33,184 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:54:33,184 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:33,398 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 267.7396 (accum_step 3/4)
2025-11-03 10:54:33,678 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:54:33,678 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:33,898 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 271.6114 (accum_step 4/4)
2025-11-03 10:54:34,186 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:54:34,186 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:34,403 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.7929 (accum_step 1/4)
2025-11-03 10:54:34,682 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:54:34,682 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:34,901 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.7072 (accum_step 2/4)
2025-11-03 10:54:35,180 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:54:35,180 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:35,394 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.3290 (accum_step 3/4)
2025-11-03 10:54:35,673 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:54:35,673 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:35,683 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 274.5592 (accum_step 4/4)
2025-11-03 10:54:35,705 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:54:37,496 - INFO -      [7] ‚úì Batch fetched in 1.791s
2025-11-03 10:54:37,729 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 252.8150 (accum_step 1/4)
2025-11-03 10:54:38,011 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:54:38,011 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:38,228 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 253.2111 (accum_step 2/4)
2025-11-03 10:54:38,507 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:54:38,507 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:38,726 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.0072 (accum_step 3/4)
2025-11-03 10:54:39,005 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:54:39,005 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:39,221 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.7381 (accum_step 4/4)
2025-11-03 10:54:39,509 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:54:39,509 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:39,722 - INFO -      [8] ‚úì Forward pass completed in 0.005s, loss = 240.2993 (accum_step 1/4)
2025-11-03 10:54:40,002 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:54:40,002 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:40,221 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.2613 (accum_step 2/4)
2025-11-03 10:54:40,500 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:54:40,500 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:40,510 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 234.9916 (accum_step 3/4)
2025-11-03 10:54:40,524 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:54:42,232 - INFO -      [8] ‚úì Batch fetched in 1.709s
2025-11-03 10:54:42,452 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 236.0593 (accum_step 4/4)
2025-11-03 10:54:42,740 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 10:54:42,740 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:42,954 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 224.6680 (accum_step 1/4)
2025-11-03 10:54:43,233 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 10:54:43,233 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:43,452 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 226.2681 (accum_step 2/4)
2025-11-03 10:54:43,730 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 10:54:43,731 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:43,947 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 226.2918 (accum_step 3/4)
2025-11-03 10:54:44,226 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 10:54:44,226 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 10:54:44,441 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 225.2049 (accum_step 4/4)
2025-11-03 10:54:44,728 - INFO -   Step 10/10: loss = 225.6082, avg_loss = 269.4493, lr = 0.000021, grad_norm = 277.8608
2025-11-03 10:54:44,728 - INFO -     ‚è±Ô∏è  Timing: total=1.988s (fetch=0.001s, to_device=0.012s, spec_compute=0.002s, forward=0.023s, backward=0.040s, optim=0.008s)
2025-11-03 10:54:44,728 - INFO - 
================================================================================
2025-11-03 10:54:44,728 - INFO - TRAINING SUMMARY:
2025-11-03 10:54:44,728 - INFO -   Steps Completed: 10
2025-11-03 10:54:44,728 - INFO -   Average Loss: 269.4493
2025-11-03 10:54:44,728 - INFO -   Best Validation Loss: inf
2025-11-03 10:54:44,728 - INFO - ================================================================================
2025-11-03 10:54:44,728 - INFO - 
================================================================================
2025-11-03 10:54:44,728 - INFO - TRAINING COMPLETED
2025-11-03 10:54:44,728 - INFO - Configuration: A100_pretraining_test
2025-11-03 10:54:44,728 - INFO - Final step: 10
2025-11-03 10:54:44,728 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 10:54:44,728 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 10:54:44,728 - INFO - ================================================================================
2025-11-03 14:23:19,986 - INFO - ================================================================================
2025-11-03 14:23:19,987 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 14:23:19,987 - INFO - ================================================================================
2025-11-03 14:23:19,987 - INFO - Configuration: A100_pretraining_test
2025-11-03 14:23:19,987 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 14:23:19,987 - INFO - ================================================================================
2025-11-03 14:23:19,988 - INFO - Device: cuda
2025-11-03 14:23:20,008 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 14:23:20,017 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 14:23:20,017 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 14:23:20,017 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 14:23:20,017 - INFO -   Batch size: 128, Steps: 10
2025-11-03 14:23:20,017 - INFO -   Validation interval: 20 steps
2025-11-03 14:23:20,017 - INFO -   Log interval: 5 steps
2025-11-03 14:23:20,017 - INFO - 
Initializing model...
2025-11-03 14:23:21,253 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 14:23:21,254 - INFO -   Total parameters: 44,674,663
2025-11-03 14:23:21,254 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 14:23:55,180 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 14:23:55,180 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 14:23:55,191 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 14:23:55,191 - INFO - 
Setting up datasets...
2025-11-03 14:23:55,191 - INFO -   Loading MAESTRO dataset...
2025-11-03 14:23:55,875 - INFO -   ‚úì MAESTRO train: 50 samples (cached)
2025-11-03 14:23:55,876 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 14:23:55,876 - INFO -   Loading SLAKH stems dataset...
2025-11-03 14:23:57,629 - INFO -   ‚úì SLAKH stems train: 521 samples (cached)
2025-11-03 14:23:58,163 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 14:23:58,163 - INFO -   Loading SLAKH mix dataset...
2025-11-03 14:23:59,903 - INFO -   ‚úì SLAKH mix train: 50 samples (cached)
2025-11-03 14:23:59,972 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 14:23:59,972 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 14:24:01,805 - INFO -   ‚úì SLAKH mixed train: 50 samples (cached)
2025-11-03 14:24:01,869 - INFO -   ‚úì SLAKH mixed val: 20 samples (cached)
2025-11-03 14:24:01,869 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 14:24:01,869 - INFO -   Warming train cache for maestro dataset before forking workers...
2025-11-03 14:24:01,869 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 14:24:01,869 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 14:24:01,869 - INFO -   Warming validation cache for maestro dataset before forking workers...
2025-11-03 14:24:03,784 - INFO -   Warming validation cache for slakh_stems dataset before forking workers...
2025-11-03 14:24:04,474 - INFO -   Warming validation cache for slakh_mix dataset before forking workers...
2025-11-03 14:24:05,161 - INFO - 
  Creating multi-task dataset...
2025-11-03 14:24:05,162 - INFO -   ‚úì Multi-task dataset: 671 total samples
2025-11-03 14:24:05,162 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 14:24:05,162 - INFO - 
  Setting up validation data...
2025-11-03 14:24:05,162 - INFO -   ‚úì Validation: 267 samples
2025-11-03 14:24:05,164 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 14:24:05,164 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 14:24:05,164 - INFO -   Label smoothing: 0.1
2025-11-03 14:24:05,164 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 14:24:05,164 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 14:24:05,164 - INFO - 
Starting training...
2025-11-03 14:24:05,164 - INFO -   Total steps: 10
2025-11-03 14:24:05,164 - INFO -   Batch size: 128
2025-11-03 14:24:05,164 - INFO -   Learning rate: 0.0001
2025-11-03 14:24:05,164 - INFO -   Weight decay: 0.1
2025-11-03 14:24:05,164 - INFO -   Log interval: 5 steps
2025-11-03 14:24:05,164 - INFO -   Validation interval: 20 steps
2025-11-03 14:24:05,165 - INFO -   Save interval: 100 steps
2025-11-03 14:24:05,165 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 14:24:05,229 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 14:24:05,229 - INFO - 
================================================================================
2025-11-03 14:24:05,229 - INFO - STEP-BASED TRAINING
2025-11-03 14:24:05,229 - INFO -   Starting from step: 0
2025-11-03 14:24:05,229 - INFO -   Target steps: 10
2025-11-03 14:24:05,229 - INFO -   Batch size: 128
2025-11-03 14:24:05,229 - INFO -   Gradient accumulation steps: 4
2025-11-03 14:24:05,230 - INFO -   Effective batch size: 512
2025-11-03 14:24:05,230 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 14:24:05,230 - INFO - ================================================================================
2025-11-03 14:24:05,230 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 14:24:05,230 - INFO - 
üöÄ Starting training loop...
2025-11-03 14:24:05,230 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 14:24:05,230 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 14:24:07,174 - INFO -      [0] ‚úì Batch fetched in 1.944s
2025-11-03 14:24:07,174 - INFO -      [0] Moving data to device cuda...
2025-11-03 14:24:07,176 - INFO -      [0] ‚úì Data moved to device in 0.002s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 14:24:07,547 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.370s (shape: torch.Size([128, 256, 512]))
2025-11-03 14:24:07,547 - INFO -      [0] Starting forward pass...
2025-11-03 14:24:29,204 - INFO -      [0] ‚úì Forward pass completed in 21.656s, loss = 289.9820 (accum_step 1/4)
2025-11-03 14:24:29,204 - INFO -      [0] Starting backward pass...
2025-11-03 14:24:35,850 - INFO -      [0] ‚úì Backward pass completed in 6.645s
2025-11-03 14:24:35,868 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 14:24:35,869 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 14:24:35,869 - INFO -      [0] Moving data to device cuda...
2025-11-03 14:24:35,875 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 14:24:35,876 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 14:24:35,876 - INFO -      [0] Starting forward pass...
2025-11-03 14:24:36,088 - INFO -      [0] ‚úì Forward pass completed in 0.012s, loss = 288.7959 (accum_step 2/4)
2025-11-03 14:24:36,089 - INFO -      [0] Starting backward pass...
2025-11-03 14:24:36,102 - INFO -      [0] ‚úì Backward pass completed in 0.013s
2025-11-03 14:24:36,348 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 14:24:36,349 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 14:24:36,349 - INFO -      [0] Moving data to device cuda...
2025-11-03 14:24:36,352 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 14:24:36,353 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 14:24:36,353 - INFO -      [0] Starting forward pass...
2025-11-03 14:24:36,565 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 292.7440 (accum_step 3/4)
2025-11-03 14:24:36,565 - INFO -      [0] Starting backward pass...
2025-11-03 14:24:36,575 - INFO -      [0] ‚úì Backward pass completed in 0.010s
2025-11-03 14:24:36,824 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 14:24:36,825 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 14:24:36,825 - INFO -      [0] Moving data to device cuda...
2025-11-03 14:24:36,825 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 14:24:36,826 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 14:24:36,826 - INFO -      [0] Starting forward pass...
2025-11-03 14:24:37,038 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 292.5490 (accum_step 4/4)
2025-11-03 14:24:37,038 - INFO -      [0] Starting backward pass...
2025-11-03 14:24:37,048 - INFO -      [0] ‚úì Backward pass completed in 0.010s
2025-11-03 14:24:37,298 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 14:24:38,347 - INFO -      [0] ‚úì Optimizer step completed in 1.049s, grad_norm = 321.7907
2025-11-03 14:24:38,348 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 14:24:38,348 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 14:24:38,348 - INFO -      [1] Moving data to device cuda...
2025-11-03 14:24:38,351 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 14:24:38,352 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 14:24:38,352 - INFO -      [1] Starting forward pass...
2025-11-03 14:24:38,566 - INFO -      [1] ‚úì Forward pass completed in 0.039s, loss = 288.2801 (accum_step 1/4)
2025-11-03 14:24:38,566 - INFO -      [1] Starting backward pass...
2025-11-03 14:24:38,581 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 14:24:38,833 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 14:24:38,833 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 14:24:38,833 - INFO -      [1] Moving data to device cuda...
2025-11-03 14:24:38,837 - INFO -      [1] ‚úì Data moved to device in 0.004s (frames: torch.Size([31, 256, 128]), targets: torch.Size([31, 1024]))
2025-11-03 14:24:38,839 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([31, 256, 512]))
2025-11-03 14:24:38,839 - INFO -      [1] Starting forward pass...
2025-11-03 14:25:17,889 - INFO -      [1] ‚úì Forward pass completed in 39.049s, loss = 290.9879 (accum_step 2/4)
2025-11-03 14:25:17,889 - INFO -      [1] Starting backward pass...
2025-11-03 14:25:18,418 - INFO -      [1] ‚úì Backward pass completed in 0.529s
2025-11-03 14:25:18,418 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 14:25:19,828 - INFO -      [1] ‚úì Batch fetched in 1.410s
2025-11-03 14:25:19,829 - INFO -      [1] Moving data to device cuda...
2025-11-03 14:25:19,835 - INFO -      [1] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 14:25:19,836 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 14:25:19,836 - INFO -      [1] Starting forward pass...
2025-11-03 14:25:20,049 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 293.1376 (accum_step 3/4)
2025-11-03 14:25:20,049 - INFO -      [1] Starting backward pass...
2025-11-03 14:25:20,068 - INFO -      [1] ‚úì Backward pass completed in 0.019s
2025-11-03 14:25:20,311 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 14:25:20,311 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:20,311 - INFO -      [1] Moving data to device cuda...
2025-11-03 14:25:20,317 - INFO -      [1] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 14:25:20,318 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 14:25:20,318 - INFO -      [1] Starting forward pass...
2025-11-03 14:25:20,530 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 290.8078 (accum_step 4/4)
2025-11-03 14:25:20,530 - INFO -      [1] Starting backward pass...
2025-11-03 14:25:20,542 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 14:25:20,791 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 14:25:20,800 - INFO -      [1] ‚úì Optimizer step completed in 0.010s, grad_norm = 324.3093
2025-11-03 14:25:20,801 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 14:25:20,801 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:20,801 - INFO -      [2] Moving data to device cuda...
2025-11-03 14:25:20,801 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 14:25:20,802 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 14:25:20,802 - INFO -      [2] Starting forward pass...
2025-11-03 14:25:21,015 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 285.6944 (accum_step 1/4)
2025-11-03 14:25:21,015 - INFO -      [2] Starting backward pass...
2025-11-03 14:25:21,028 - INFO -      [2] ‚úì Backward pass completed in 0.013s
2025-11-03 14:25:21,274 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 14:25:21,274 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:21,275 - INFO -      [2] Moving data to device cuda...
2025-11-03 14:25:21,281 - INFO -      [2] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 14:25:21,281 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 14:25:21,281 - INFO -      [2] Starting forward pass...
2025-11-03 14:25:21,494 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.7408 (accum_step 2/4)
2025-11-03 14:25:21,494 - INFO -      [2] Starting backward pass...
2025-11-03 14:25:21,508 - INFO -      [2] ‚úì Backward pass completed in 0.014s
2025-11-03 14:25:21,754 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 14:25:21,754 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:21,754 - INFO -      [2] Moving data to device cuda...
2025-11-03 14:25:21,755 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 14:25:21,755 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 14:25:21,755 - INFO -      [2] Starting forward pass...
2025-11-03 14:25:21,968 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 283.0714 (accum_step 3/4)
2025-11-03 14:25:21,968 - INFO -      [2] Starting backward pass...
2025-11-03 14:25:21,979 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 14:25:22,227 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 14:25:22,228 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:22,228 - INFO -      [2] Moving data to device cuda...
2025-11-03 14:25:22,229 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([31, 256, 128]), targets: torch.Size([31, 1024]))
2025-11-03 14:25:22,230 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([31, 256, 512]))
2025-11-03 14:25:22,230 - INFO -      [2] Starting forward pass...
2025-11-03 14:25:22,285 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 289.1439 (accum_step 4/4)
2025-11-03 14:25:22,285 - INFO -      [2] Starting backward pass...
2025-11-03 14:25:22,296 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 14:25:22,354 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 14:25:22,364 - INFO -      [2] ‚úì Optimizer step completed in 0.009s, grad_norm = 325.3506
2025-11-03 14:25:22,364 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 14:25:24,502 - INFO -      [3] ‚úì Batch fetched in 2.138s
2025-11-03 14:25:24,741 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 285.7496 (accum_step 1/4)
2025-11-03 14:25:25,005 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 14:25:25,005 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:25,224 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 284.7065 (accum_step 2/4)
2025-11-03 14:25:25,484 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 14:25:25,484 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:25,698 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 285.5511 (accum_step 3/4)
2025-11-03 14:25:25,958 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 14:25:25,958 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:26,172 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 283.1937 (accum_step 4/4)
2025-11-03 14:25:26,441 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 14:25:26,441 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:26,659 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 277.5542 (accum_step 1/4)
2025-11-03 14:25:26,919 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 14:25:26,919 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:26,976 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 278.8720 (accum_step 2/4)
2025-11-03 14:25:27,045 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 14:25:28,498 - INFO -      [4] ‚úì Batch fetched in 1.453s
2025-11-03 14:25:28,717 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 278.6934 (accum_step 3/4)
2025-11-03 14:25:28,978 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 14:25:28,979 - INFO -      [4] ‚úì Batch fetched in 0.001s
2025-11-03 14:25:29,197 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 278.1554 (accum_step 4/4)
2025-11-03 14:25:29,466 - INFO -   Step 5/10: loss = 278.3187, avg_loss = 286.3205, lr = 0.000011, grad_norm = 329.1289
2025-11-03 14:25:29,466 - INFO -     ‚è±Ô∏è  Timing: total=3.025s (fetch=1.454s, to_device=0.017s, spec_compute=0.002s, forward=0.026s, backward=0.042s, optim=0.009s)
2025-11-03 14:25:29,466 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 14:25:29,466 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:29,683 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 269.9187 (accum_step 1/4)
2025-11-03 14:25:29,943 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 14:25:29,943 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:30,157 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 269.9144 (accum_step 2/4)
2025-11-03 14:25:30,416 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 14:25:30,417 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:30,630 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 270.1559 (accum_step 3/4)
2025-11-03 14:25:30,890 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 14:25:30,890 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:30,947 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 268.7344 (accum_step 4/4)
2025-11-03 14:25:31,025 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 14:25:32,617 - INFO -      [6] ‚úì Batch fetched in 1.592s
2025-11-03 14:25:32,836 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 260.6022 (accum_step 1/4)
2025-11-03 14:25:33,095 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 14:25:33,095 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:33,311 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 259.7876 (accum_step 2/4)
2025-11-03 14:25:33,571 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 14:25:33,571 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:33,790 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 260.1100 (accum_step 3/4)
2025-11-03 14:25:34,050 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 14:25:34,050 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:34,264 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 257.6977 (accum_step 4/4)
2025-11-03 14:25:34,533 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 14:25:34,533 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:34,747 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.0240 (accum_step 1/4)
2025-11-03 14:25:35,006 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 14:25:35,006 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:35,063 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.1677 (accum_step 2/4)
2025-11-03 14:25:35,133 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 14:25:36,141 - INFO -      [7] ‚úì Batch fetched in 1.008s
2025-11-03 14:25:36,356 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 250.6423 (accum_step 3/4)
2025-11-03 14:25:36,618 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 14:25:36,650 - INFO -      [7] ‚úì Batch fetched in 0.033s
2025-11-03 14:25:36,869 - INFO -      [7] ‚úì Forward pass completed in 0.009s, loss = 250.3713 (accum_step 4/4)
2025-11-03 14:25:37,138 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 14:25:37,138 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:37,357 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 238.0576 (accum_step 1/4)
2025-11-03 14:25:37,616 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 14:25:37,617 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:37,835 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 237.4920 (accum_step 2/4)
2025-11-03 14:25:38,095 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 14:25:38,096 - INFO -      [8] ‚úì Batch fetched in 0.001s
2025-11-03 14:25:38,315 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 235.8279 (accum_step 3/4)
2025-11-03 14:25:38,575 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 14:25:38,575 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:38,632 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 240.4024 (accum_step 4/4)
2025-11-03 14:25:38,710 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 14:25:40,434 - INFO -      [9] ‚úì Batch fetched in 1.724s
2025-11-03 14:25:40,668 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.7769 (accum_step 1/4)
2025-11-03 14:25:40,931 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 14:25:40,932 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:41,151 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 223.6639 (accum_step 2/4)
2025-11-03 14:25:41,411 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 14:25:41,411 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:41,628 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 223.6305 (accum_step 3/4)
2025-11-03 14:25:41,888 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 14:25:41,889 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 14:25:42,102 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 223.4699 (accum_step 4/4)
2025-11-03 14:25:42,371 - INFO -   Step 10/10: loss = 224.3853, avg_loss = 267.3464, lr = 0.000021, grad_norm = 276.7348
2025-11-03 14:25:42,371 - INFO -     ‚è±Ô∏è  Timing: total=3.661s (fetch=1.725s, to_device=0.011s, spec_compute=0.003s, forward=0.027s, backward=0.042s, optim=0.009s)
2025-11-03 14:25:42,372 - INFO - 
================================================================================
2025-11-03 14:25:42,372 - INFO - TRAINING SUMMARY:
2025-11-03 14:25:42,372 - INFO -   Steps Completed: 10
2025-11-03 14:25:42,372 - INFO -   Average Loss: 267.3464
2025-11-03 14:25:42,372 - INFO -   Best Validation Loss: inf
2025-11-03 14:25:42,372 - INFO - ================================================================================
2025-11-03 14:25:42,372 - INFO - 
================================================================================
2025-11-03 14:25:42,372 - INFO - TRAINING COMPLETED
2025-11-03 14:25:42,372 - INFO - Configuration: A100_pretraining_test
2025-11-03 14:25:42,372 - INFO - Final step: 10
2025-11-03 14:25:42,372 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 14:25:42,372 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 14:25:42,372 - INFO - ================================================================================
2025-11-03 15:40:49,058 - INFO - ================================================================================
2025-11-03 15:40:49,086 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 15:40:49,086 - INFO - ================================================================================
2025-11-03 15:40:49,086 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:40:49,086 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:40:49,086 - INFO - ================================================================================
2025-11-03 15:40:49,140 - INFO - Device: cuda
2025-11-03 15:40:49,140 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 15:40:49,140 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 15:40:49,140 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 15:40:49,140 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 15:40:49,140 - INFO -   Batch size: 128, Steps: 10
2025-11-03 15:40:49,140 - INFO -   Validation interval: 20 steps
2025-11-03 15:40:49,140 - INFO -   Log interval: 5 steps
2025-11-03 15:40:49,140 - INFO - 
Initializing model...
2025-11-03 15:40:50,972 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 15:40:50,996 - INFO -   Total parameters: 44,674,663
2025-11-03 15:40:50,996 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 15:41:24,454 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 15:41:24,455 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 15:41:24,465 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 15:41:24,465 - INFO - 
Setting up datasets...
2025-11-03 15:41:24,465 - INFO -   Loading MAESTRO dataset...
2025-11-03 15:41:24,470 - INFO -   ‚úì MAESTRO train: 962 samples (cached)
2025-11-03 15:41:24,471 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 15:41:24,471 - INFO -   Loading SLAKH stems dataset...
2025-11-03 15:43:01,265 - INFO - ================================================================================
2025-11-03 15:43:01,265 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 15:43:01,265 - INFO - ================================================================================
2025-11-03 15:43:01,265 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:43:01,265 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:43:01,265 - INFO - ================================================================================
2025-11-03 15:43:01,266 - INFO - Device: cuda
2025-11-03 15:43:01,266 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 15:43:01,266 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 15:43:01,266 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 15:43:01,266 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 15:43:01,267 - INFO -   Batch size: 128, Steps: 10
2025-11-03 15:43:01,267 - INFO -   Validation interval: 20 steps
2025-11-03 15:43:01,267 - INFO -   Log interval: 5 steps
2025-11-03 15:43:01,267 - INFO - 
Initializing model...
2025-11-03 15:43:01,867 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 15:43:01,868 - INFO -   Total parameters: 44,674,663
2025-11-03 15:43:01,868 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 15:43:04,958 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 15:43:04,958 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 15:43:04,966 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 15:43:04,966 - INFO - 
Setting up datasets...
2025-11-03 15:43:04,966 - INFO -   Loading MAESTRO dataset...
2025-11-03 15:43:04,970 - INFO -   ‚úì MAESTRO train: 20 samples (cached)
2025-11-03 15:43:04,970 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 15:43:04,971 - INFO -   Loading SLAKH stems dataset...
2025-11-03 15:43:05,645 - INFO -   ‚úì SLAKH stems train: 209 samples (cached)
2025-11-03 15:43:13,070 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 15:43:13,070 - INFO -   Loading SLAKH mix dataset...
2025-11-03 15:43:13,234 - INFO -   ‚úì SLAKH mix train: 20 samples (cached)
2025-11-03 15:43:13,284 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 15:43:13,284 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 15:43:13,344 - INFO -   ‚úì SLAKH mixed train: 20 samples (cached)
2025-11-03 15:43:13,399 - INFO -   ‚úì SLAKH mixed val: 20 samples (cached)
2025-11-03 15:43:13,400 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 15:43:13,400 - INFO -   Warming train cache for maestro dataset before forking workers...
2025-11-03 15:43:16,735 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 15:43:17,507 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 15:43:18,272 - INFO -   Warming validation cache for maestro dataset before forking workers...
2025-11-03 15:43:19,919 - INFO -   Warming validation cache for slakh_stems dataset before forking workers...
2025-11-03 15:43:20,589 - INFO -   Warming validation cache for slakh_mix dataset before forking workers...
2025-11-03 15:43:21,255 - INFO - 
  Creating multi-task dataset...
2025-11-03 15:43:21,255 - INFO -   ‚úì Multi-task dataset: 269 total samples
2025-11-03 15:43:21,255 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 15:43:21,255 - INFO - 
  Setting up validation data...
2025-11-03 15:43:21,255 - INFO -   ‚úì Validation: 267 samples
2025-11-03 15:43:21,256 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 15:43:21,256 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 15:43:21,257 - INFO -   Label smoothing: 0.1
2025-11-03 15:43:21,257 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 15:43:21,257 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 15:43:21,257 - INFO - 
Starting training...
2025-11-03 15:43:21,257 - INFO -   Total steps: 10
2025-11-03 15:43:21,257 - INFO -   Batch size: 128
2025-11-03 15:43:21,257 - INFO -   Learning rate: 0.0001
2025-11-03 15:43:21,257 - INFO -   Weight decay: 0.1
2025-11-03 15:43:21,257 - INFO -   Log interval: 5 steps
2025-11-03 15:43:21,257 - INFO -   Validation interval: 20 steps
2025-11-03 15:43:21,257 - INFO -   Save interval: 100 steps
2025-11-03 15:43:21,258 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 15:43:21,320 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 15:43:21,321 - INFO - 
================================================================================
2025-11-03 15:43:21,321 - INFO - STEP-BASED TRAINING
2025-11-03 15:43:21,321 - INFO -   Starting from step: 0
2025-11-03 15:43:21,321 - INFO -   Target steps: 10
2025-11-03 15:43:21,321 - INFO -   Batch size: 128
2025-11-03 15:43:21,321 - INFO -   Gradient accumulation steps: 4
2025-11-03 15:43:21,321 - INFO -   Effective batch size: 512
2025-11-03 15:43:21,321 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 15:43:21,321 - INFO - ================================================================================
2025-11-03 15:43:21,321 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 15:43:21,321 - INFO - 
üöÄ Starting training loop...
2025-11-03 15:43:21,321 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 15:43:21,321 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:43:24,898 - INFO -      [0] ‚úì Batch fetched in 3.577s
2025-11-03 15:43:24,899 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:43:24,901 - INFO -      [0] ‚úì Data moved to device in 0.002s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:43:30,475 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 5.575s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:43:30,476 - INFO -      [0] Starting forward pass...
2025-11-03 15:43:35,178 - INFO -      [0] ‚úì Forward pass completed in 4.702s, loss = 290.8714 (accum_step 1/4)
2025-11-03 15:43:35,179 - INFO -      [0] Starting backward pass...
2025-11-03 15:43:35,770 - INFO -      [0] ‚úì Backward pass completed in 0.592s
2025-11-03 15:43:35,791 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:43:35,791 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:43:35,791 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:43:35,797 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:43:35,798 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:43:35,798 - INFO -      [0] Starting forward pass...
2025-11-03 15:43:36,011 - INFO -      [0] ‚úì Forward pass completed in 0.025s, loss = 296.6624 (accum_step 2/4)
2025-11-03 15:43:36,011 - INFO -      [0] Starting backward pass...
2025-11-03 15:43:36,045 - INFO -      [0] ‚úì Backward pass completed in 0.034s
2025-11-03 15:43:36,271 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:43:36,271 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:43:36,271 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:43:36,271 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:43:36,273 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:43:36,273 - INFO -      [0] Starting forward pass...
2025-11-03 15:43:39,426 - INFO -      [0] ‚úì Forward pass completed in 3.142s, loss = 289.0909 (accum_step 3/4)
2025-11-03 15:43:39,426 - INFO -      [0] Starting backward pass...
2025-11-03 15:43:39,576 - INFO -      [0] ‚úì Backward pass completed in 0.149s
2025-11-03 15:43:39,576 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:43:42,191 - INFO -      [0] ‚úì Batch fetched in 2.615s
2025-11-03 15:43:42,191 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:43:42,196 - INFO -      [0] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:43:42,197 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:43:42,197 - INFO -      [0] Starting forward pass...
2025-11-03 15:43:42,422 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 291.3250 (accum_step 4/4)
2025-11-03 15:43:42,422 - INFO -      [0] Starting backward pass...
2025-11-03 15:43:42,433 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:43:42,682 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 15:43:43,835 - INFO -      [0] ‚úì Optimizer step completed in 1.152s, grad_norm = 324.0614
2025-11-03 15:43:43,835 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:43:43,835 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:43:43,835 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:43:43,848 - INFO -      [1] ‚úì Data moved to device in 0.013s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:43:43,849 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:43:43,849 - INFO -      [1] Starting forward pass...
2025-11-03 15:43:44,063 - INFO -      [1] ‚úì Forward pass completed in 0.040s, loss = 289.2747 (accum_step 1/4)
2025-11-03 15:43:44,063 - INFO -      [1] Starting backward pass...
2025-11-03 15:43:44,078 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 15:43:44,330 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:43:44,330 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:43:44,330 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:43:44,332 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:43:44,333 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:43:44,333 - INFO -      [1] Starting forward pass...
2025-11-03 15:43:44,359 - INFO -      [1] ‚úì Forward pass completed in 0.012s, loss = 286.6451 (accum_step 2/4)
2025-11-03 15:43:44,359 - INFO -      [1] Starting backward pass...
2025-11-03 15:43:44,375 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 15:43:44,393 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:43:46,414 - INFO -      [1] ‚úì Batch fetched in 2.020s
2025-11-03 15:43:46,414 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:43:46,418 - INFO -      [1] ‚úì Data moved to device in 0.004s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:43:46,418 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:43:46,418 - INFO -      [1] Starting forward pass...
2025-11-03 15:43:46,644 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 295.4648 (accum_step 3/4)
2025-11-03 15:43:46,644 - INFO -      [1] Starting backward pass...
2025-11-03 15:43:46,658 - INFO -      [1] ‚úì Backward pass completed in 0.014s
2025-11-03 15:43:46,907 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:43:46,907 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:43:46,907 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:43:46,913 - INFO -      [1] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:43:46,914 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:43:46,914 - INFO -      [1] Starting forward pass...
2025-11-03 15:43:47,126 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 291.9829 (accum_step 4/4)
2025-11-03 15:43:47,126 - INFO -      [1] Starting backward pass...
2025-11-03 15:43:47,137 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 15:43:47,386 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 15:43:47,395 - INFO -      [1] ‚úì Optimizer step completed in 0.009s, grad_norm = 323.6696
2025-11-03 15:43:47,395 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:43:47,395 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:43:47,395 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:43:47,396 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:43:47,396 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:43:47,397 - INFO -      [2] Starting forward pass...
2025-11-03 15:43:47,423 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 294.6187 (accum_step 1/4)
2025-11-03 15:43:47,423 - INFO -      [2] Starting backward pass...
2025-11-03 15:43:47,433 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:43:47,455 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:43:49,006 - INFO -      [2] ‚úì Batch fetched in 1.550s
2025-11-03 15:43:49,006 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:43:49,007 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:43:49,008 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:43:49,008 - INFO -      [2] Starting forward pass...
2025-11-03 15:43:49,220 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.0398 (accum_step 2/4)
2025-11-03 15:43:49,220 - INFO -      [2] Starting backward pass...
2025-11-03 15:43:49,231 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 15:43:49,481 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:43:49,613 - INFO -      [2] ‚úì Batch fetched in 0.132s
2025-11-03 15:43:49,614 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:43:49,618 - INFO -      [2] ‚úì Data moved to device in 0.004s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:43:49,618 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:43:49,619 - INFO -      [2] Starting forward pass...
2025-11-03 15:43:49,832 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.8474 (accum_step 3/4)
2025-11-03 15:43:49,832 - INFO -      [2] Starting backward pass...
2025-11-03 15:43:49,842 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:43:50,092 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:43:50,092 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:43:50,092 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:43:50,093 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:43:50,093 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:43:50,093 - INFO -      [2] Starting forward pass...
2025-11-03 15:43:50,119 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 298.4498 (accum_step 4/4)
2025-11-03 15:43:50,120 - INFO -      [2] Starting backward pass...
2025-11-03 15:43:50,130 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:43:50,153 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 15:43:50,161 - INFO -      [2] ‚úì Optimizer step completed in 0.008s, grad_norm = 331.3848
2025-11-03 15:43:50,161 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:43:51,856 - INFO -      [3] ‚úì Batch fetched in 1.695s
2025-11-03 15:43:52,077 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 289.4939 (accum_step 1/4)
2025-11-03 15:43:52,336 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:43:52,675 - INFO -      [3] ‚úì Batch fetched in 0.339s
2025-11-03 15:43:52,889 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 283.5953 (accum_step 2/4)
2025-11-03 15:43:53,149 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:43:53,149 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:43:53,177 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 289.9717 (accum_step 3/4)
2025-11-03 15:43:53,210 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:43:55,130 - INFO -      [3] ‚úì Batch fetched in 1.920s
2025-11-03 15:43:55,366 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 287.7612 (accum_step 4/4)
2025-11-03 15:43:55,638 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:43:55,638 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:43:55,851 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 277.9601 (accum_step 1/4)
2025-11-03 15:43:56,111 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:43:56,111 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:43:56,139 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 282.7672 (accum_step 2/4)
2025-11-03 15:43:56,172 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:43:57,847 - INFO -      [4] ‚úì Batch fetched in 1.674s
2025-11-03 15:43:58,066 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 276.1534 (accum_step 3/4)
2025-11-03 15:43:58,326 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:43:58,326 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:43:58,546 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 278.7616 (accum_step 4/4)
2025-11-03 15:43:58,815 - INFO -   Step 5/10: loss = 278.9106, avg_loss = 288.3869, lr = 0.000011, grad_norm = 327.9622
2025-11-03 15:43:58,815 - INFO -     ‚è±Ô∏è  Timing: total=3.177s (fetch=1.675s, to_device=0.014s, spec_compute=0.002s, forward=0.026s, backward=0.041s, optim=0.009s)
2025-11-03 15:43:58,815 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:43:58,815 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:43:58,842 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 278.9863 (accum_step 1/4)
2025-11-03 15:43:58,874 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:44:00,289 - INFO -      [5] ‚úì Batch fetched in 1.414s
2025-11-03 15:44:00,508 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 269.0114 (accum_step 2/4)
2025-11-03 15:44:00,768 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:44:01,137 - INFO -      [5] ‚úì Batch fetched in 0.368s
2025-11-03 15:44:01,356 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 270.2458 (accum_step 3/4)
2025-11-03 15:44:01,616 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:44:01,616 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:44:01,643 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 273.2055 (accum_step 4/4)
2025-11-03 15:44:01,686 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:44:02,717 - INFO -      [6] ‚úì Batch fetched in 1.031s
2025-11-03 15:44:02,931 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 260.4125 (accum_step 1/4)
2025-11-03 15:44:03,191 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:44:03,516 - INFO -      [6] ‚úì Batch fetched in 0.325s
2025-11-03 15:44:03,736 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 260.0059 (accum_step 2/4)
2025-11-03 15:44:03,995 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:44:03,995 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:44:04,023 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 255.9816 (accum_step 3/4)
2025-11-03 15:44:04,057 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:44:05,361 - INFO -      [6] ‚úì Batch fetched in 1.304s
2025-11-03 15:44:05,575 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 257.3702 (accum_step 4/4)
2025-11-03 15:44:05,844 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:44:06,359 - INFO -      [7] ‚úì Batch fetched in 0.514s
2025-11-03 15:44:06,577 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 247.2448 (accum_step 1/4)
2025-11-03 15:44:06,837 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:44:06,837 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:44:06,864 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 255.1147 (accum_step 2/4)
2025-11-03 15:44:06,897 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:44:08,886 - INFO -      [7] ‚úì Batch fetched in 1.989s
2025-11-03 15:44:09,125 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 250.8889 (accum_step 3/4)
2025-11-03 15:44:09,385 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:44:09,385 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:44:09,599 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.7272 (accum_step 4/4)
2025-11-03 15:44:09,867 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:44:09,867 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:44:09,895 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 234.8787 (accum_step 1/4)
2025-11-03 15:44:09,927 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:44:12,051 - INFO -      [8] ‚úì Batch fetched in 2.124s
2025-11-03 15:44:12,289 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 237.7719 (accum_step 2/4)
2025-11-03 15:44:12,553 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:44:12,553 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:44:12,771 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 240.5869 (accum_step 3/4)
2025-11-03 15:44:13,032 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:44:13,032 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:44:13,059 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 233.1839 (accum_step 4/4)
2025-11-03 15:44:13,101 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:44:15,109 - INFO -      [9] ‚úì Batch fetched in 2.008s
2025-11-03 15:44:15,349 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 225.6151 (accum_step 1/4)
2025-11-03 15:44:15,609 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:44:15,641 - INFO -      [9] ‚úì Batch fetched in 0.031s
2025-11-03 15:44:15,860 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 227.8802 (accum_step 2/4)
2025-11-03 15:44:16,119 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:44:16,119 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:44:16,147 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.6576 (accum_step 3/4)
2025-11-03 15:44:16,180 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:44:18,390 - INFO -      [9] ‚úì Batch fetched in 2.209s
2025-11-03 15:44:18,625 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.3512 (accum_step 4/4)
2025-11-03 15:44:18,894 - INFO -   Step 10/10: loss = 226.6260, avg_loss = 268.7714, lr = 0.000021, grad_norm = 279.5520
2025-11-03 15:44:18,894 - INFO -     ‚è±Ô∏è  Timing: total=5.793s (fetch=4.249s, to_device=0.017s, spec_compute=0.003s, forward=0.027s, backward=0.042s, optim=0.009s)
2025-11-03 15:44:18,894 - INFO - 
================================================================================
2025-11-03 15:44:18,894 - INFO - TRAINING SUMMARY:
2025-11-03 15:44:18,895 - INFO -   Steps Completed: 10
2025-11-03 15:44:18,895 - INFO -   Average Loss: 268.7714
2025-11-03 15:44:18,895 - INFO -   Best Validation Loss: inf
2025-11-03 15:44:18,895 - INFO - ================================================================================
2025-11-03 15:44:18,895 - INFO - 
================================================================================
2025-11-03 15:44:18,895 - INFO - TRAINING COMPLETED
2025-11-03 15:44:18,895 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:44:18,895 - INFO - Final step: 10
2025-11-03 15:44:18,895 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 15:44:18,895 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:44:18,895 - INFO - ================================================================================
2025-11-03 15:44:32,892 - INFO - ================================================================================
2025-11-03 15:44:32,892 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 15:44:32,892 - INFO - ================================================================================
2025-11-03 15:44:32,892 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:44:32,892 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:44:32,892 - INFO - ================================================================================
2025-11-03 15:44:32,893 - INFO - Device: cuda
2025-11-03 15:44:32,894 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 15:44:32,894 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 15:44:32,894 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 15:44:32,894 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 15:44:32,894 - INFO -   Batch size: 128, Steps: 10
2025-11-03 15:44:32,894 - INFO -   Validation interval: 20 steps
2025-11-03 15:44:32,894 - INFO -   Log interval: 5 steps
2025-11-03 15:44:32,894 - INFO - 
Initializing model...
2025-11-03 15:44:33,340 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 15:44:33,341 - INFO -   Total parameters: 44,674,663
2025-11-03 15:44:33,341 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 15:44:36,473 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 15:44:36,473 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 15:44:36,482 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 15:44:36,482 - INFO - 
Setting up datasets...
2025-11-03 15:44:36,482 - INFO -   Loading MAESTRO dataset...
2025-11-03 15:44:36,486 - INFO -   ‚úì MAESTRO train: 20 samples (cached)
2025-11-03 15:44:36,487 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 15:44:36,487 - INFO -   Loading SLAKH stems dataset...
2025-11-03 15:44:37,179 - INFO -   ‚úì SLAKH stems train: 209 samples (cached)
2025-11-03 15:44:37,597 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 15:44:37,597 - INFO -   Loading SLAKH mix dataset...
2025-11-03 15:44:37,646 - INFO -   ‚úì SLAKH mix train: 20 samples (cached)
2025-11-03 15:44:37,699 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 15:44:37,699 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 15:44:37,755 - INFO -   ‚úì SLAKH mixed train: 20 samples (cached)
2025-11-03 15:44:37,794 - INFO -   ‚úì SLAKH mixed val: 20 samples (cached)
2025-11-03 15:44:37,795 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 15:44:37,795 - INFO -   Warming train cache for maestro dataset before forking workers...
2025-11-03 15:44:38,059 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 15:44:39,103 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 15:44:40,710 - INFO -   Warming validation cache for maestro dataset before forking workers...
2025-11-03 15:44:41,008 - INFO -   Warming validation cache for slakh_stems dataset before forking workers...
2025-11-03 15:44:42,554 - INFO -   Warming validation cache for slakh_mix dataset before forking workers...
2025-11-03 15:44:44,091 - INFO - 
  Creating multi-task dataset...
2025-11-03 15:44:44,092 - INFO -   ‚úì Multi-task dataset: 269 total samples
2025-11-03 15:44:44,092 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 15:44:44,092 - INFO - 
  Setting up validation data...
2025-11-03 15:44:44,092 - INFO -   ‚úì Validation: 267 samples
2025-11-03 15:44:44,093 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 15:44:44,093 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 15:44:44,094 - INFO -   Label smoothing: 0.1
2025-11-03 15:44:44,094 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 15:44:44,094 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 15:44:44,094 - INFO - 
Starting training...
2025-11-03 15:44:44,094 - INFO -   Total steps: 10
2025-11-03 15:44:44,094 - INFO -   Batch size: 128
2025-11-03 15:44:44,094 - INFO -   Learning rate: 0.0001
2025-11-03 15:44:44,094 - INFO -   Weight decay: 0.1
2025-11-03 15:44:44,094 - INFO -   Log interval: 5 steps
2025-11-03 15:44:44,094 - INFO -   Validation interval: 20 steps
2025-11-03 15:44:44,094 - INFO -   Save interval: 100 steps
2025-11-03 15:44:44,095 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 15:44:44,170 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 15:44:44,171 - INFO - 
================================================================================
2025-11-03 15:44:44,171 - INFO - STEP-BASED TRAINING
2025-11-03 15:44:44,171 - INFO -   Starting from step: 0
2025-11-03 15:44:44,171 - INFO -   Target steps: 10
2025-11-03 15:44:44,171 - INFO -   Batch size: 128
2025-11-03 15:44:44,171 - INFO -   Gradient accumulation steps: 4
2025-11-03 15:44:44,171 - INFO -   Effective batch size: 512
2025-11-03 15:44:44,171 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 15:44:44,171 - INFO - ================================================================================
2025-11-03 15:44:44,171 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 15:44:44,171 - INFO - 
üöÄ Starting training loop...
2025-11-03 15:44:44,171 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 15:44:44,171 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:44:48,691 - INFO -      [0] ‚úì Batch fetched in 4.520s
2025-11-03 15:44:48,692 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:44:48,698 - INFO -      [0] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:44:49,022 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.323s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:44:49,022 - INFO -      [0] Starting forward pass...
2025-11-03 15:44:51,749 - INFO -      [0] ‚úì Forward pass completed in 2.727s, loss = 290.8714 (accum_step 1/4)
2025-11-03 15:44:51,750 - INFO -      [0] Starting backward pass...
2025-11-03 15:44:52,068 - INFO -      [0] ‚úì Backward pass completed in 0.318s
2025-11-03 15:44:52,088 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:44:52,089 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:44:52,089 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:44:52,095 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:44:52,096 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:44:52,096 - INFO -      [0] Starting forward pass...
2025-11-03 15:44:52,309 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 296.6624 (accum_step 2/4)
2025-11-03 15:44:52,309 - INFO -      [0] Starting backward pass...
2025-11-03 15:44:52,323 - INFO -      [0] ‚úì Backward pass completed in 0.015s
2025-11-03 15:44:52,568 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:44:52,569 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:44:52,569 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:44:52,569 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:44:52,571 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.002s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:44:52,571 - INFO -      [0] Starting forward pass...
2025-11-03 15:44:55,285 - INFO -      [0] ‚úì Forward pass completed in 2.703s, loss = 289.0909 (accum_step 3/4)
2025-11-03 15:44:55,285 - INFO -      [0] Starting backward pass...
2025-11-03 15:44:55,364 - INFO -      [0] ‚úì Backward pass completed in 0.078s
2025-11-03 15:44:55,364 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:44:58,010 - INFO -      [0] ‚úì Batch fetched in 2.646s
2025-11-03 15:44:58,010 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:44:58,016 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:44:58,017 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:44:58,017 - INFO -      [0] Starting forward pass...
2025-11-03 15:44:58,243 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 291.3250 (accum_step 4/4)
2025-11-03 15:44:58,244 - INFO -      [0] Starting backward pass...
2025-11-03 15:44:58,255 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:44:58,504 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 15:44:58,618 - INFO -      [0] ‚úì Optimizer step completed in 0.114s, grad_norm = 324.0614
2025-11-03 15:44:58,618 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:44:58,618 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:44:58,618 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:44:58,620 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:44:58,621 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:44:58,621 - INFO -      [1] Starting forward pass...
2025-11-03 15:44:58,835 - INFO -      [1] ‚úì Forward pass completed in 0.039s, loss = 289.2749 (accum_step 1/4)
2025-11-03 15:44:58,836 - INFO -      [1] Starting backward pass...
2025-11-03 15:44:58,851 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 15:44:59,103 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:44:59,103 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:44:59,103 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:44:59,105 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:44:59,105 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:44:59,106 - INFO -      [1] Starting forward pass...
2025-11-03 15:44:59,132 - INFO -      [1] ‚úì Forward pass completed in 0.012s, loss = 286.6450 (accum_step 2/4)
2025-11-03 15:44:59,132 - INFO -      [1] Starting backward pass...
2025-11-03 15:44:59,147 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 15:44:59,166 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:45:01,397 - INFO -      [1] ‚úì Batch fetched in 2.231s
2025-11-03 15:45:01,397 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:45:01,403 - INFO -      [1] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:45:01,404 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:45:01,404 - INFO -      [1] Starting forward pass...
2025-11-03 15:45:01,633 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 295.4647 (accum_step 3/4)
2025-11-03 15:45:01,633 - INFO -      [1] Starting backward pass...
2025-11-03 15:45:01,647 - INFO -      [1] ‚úì Backward pass completed in 0.014s
2025-11-03 15:45:01,897 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:45:01,897 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:01,897 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:45:01,902 - INFO -      [1] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:45:01,903 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:45:01,903 - INFO -      [1] Starting forward pass...
2025-11-03 15:45:02,115 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 291.9831 (accum_step 4/4)
2025-11-03 15:45:02,115 - INFO -      [1] Starting backward pass...
2025-11-03 15:45:02,126 - INFO -      [1] ‚úì Backward pass completed in 0.010s
2025-11-03 15:45:02,375 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 15:45:02,384 - INFO -      [1] ‚úì Optimizer step completed in 0.008s, grad_norm = 323.6697
2025-11-03 15:45:02,384 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:45:02,384 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:02,384 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:45:02,384 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:45:02,385 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:45:02,385 - INFO -      [2] Starting forward pass...
2025-11-03 15:45:02,411 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 294.6192 (accum_step 1/4)
2025-11-03 15:45:02,411 - INFO -      [2] Starting backward pass...
2025-11-03 15:45:02,421 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:45:02,444 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:45:04,146 - INFO -      [2] ‚úì Batch fetched in 1.702s
2025-11-03 15:45:04,146 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:45:04,148 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:45:04,149 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:45:04,149 - INFO -      [2] Starting forward pass...
2025-11-03 15:45:04,375 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.0400 (accum_step 2/4)
2025-11-03 15:45:04,375 - INFO -      [2] Starting backward pass...
2025-11-03 15:45:04,386 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 15:45:04,642 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:45:04,642 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:04,642 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:45:04,648 - INFO -      [2] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:45:04,648 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:45:04,649 - INFO -      [2] Starting forward pass...
2025-11-03 15:45:04,861 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.8476 (accum_step 3/4)
2025-11-03 15:45:04,861 - INFO -      [2] Starting backward pass...
2025-11-03 15:45:04,871 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:45:05,121 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:45:05,122 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:05,122 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:45:05,122 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:45:05,124 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:45:05,124 - INFO -      [2] Starting forward pass...
2025-11-03 15:45:05,150 - INFO -      [2] ‚úì Forward pass completed in 0.008s, loss = 298.4499 (accum_step 4/4)
2025-11-03 15:45:05,150 - INFO -      [2] Starting backward pass...
2025-11-03 15:45:05,162 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 15:45:05,184 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 15:45:05,194 - INFO -      [2] ‚úì Optimizer step completed in 0.010s, grad_norm = 331.3847
2025-11-03 15:45:05,194 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:45:07,024 - INFO -      [3] ‚úì Batch fetched in 1.830s
2025-11-03 15:45:07,259 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 289.4938 (accum_step 1/4)
2025-11-03 15:45:07,520 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:45:07,691 - INFO -      [3] ‚úì Batch fetched in 0.171s
2025-11-03 15:45:07,910 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 283.5951 (accum_step 2/4)
2025-11-03 15:45:08,169 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:45:08,170 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:08,196 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 289.9709 (accum_step 3/4)
2025-11-03 15:45:08,230 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:45:10,325 - INFO -      [3] ‚úì Batch fetched in 2.094s
2025-11-03 15:45:10,551 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 287.7613 (accum_step 4/4)
2025-11-03 15:45:10,826 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:45:10,827 - INFO -      [4] ‚úì Batch fetched in 0.001s
2025-11-03 15:45:11,046 - INFO -      [4] ‚úì Forward pass completed in 0.008s, loss = 277.9602 (accum_step 1/4)
2025-11-03 15:45:11,306 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:45:11,307 - INFO -      [4] ‚úì Batch fetched in 0.001s
2025-11-03 15:45:11,334 - INFO -      [4] ‚úì Forward pass completed in 0.008s, loss = 282.7668 (accum_step 2/4)
2025-11-03 15:45:11,367 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:45:13,381 - INFO -      [4] ‚úì Batch fetched in 2.014s
2025-11-03 15:45:13,615 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 276.1533 (accum_step 3/4)
2025-11-03 15:45:13,881 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:45:13,881 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:14,100 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 278.7617 (accum_step 4/4)
2025-11-03 15:45:14,370 - INFO -   Step 5/10: loss = 278.9105, avg_loss = 288.3869, lr = 0.000011, grad_norm = 327.9621
2025-11-03 15:45:14,370 - INFO -     ‚è±Ô∏è  Timing: total=3.544s (fetch=2.015s, to_device=0.016s, spec_compute=0.003s, forward=0.029s, backward=0.048s, optim=0.010s)
2025-11-03 15:45:14,370 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:45:14,370 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:14,398 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 278.9864 (accum_step 1/4)
2025-11-03 15:45:14,431 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:45:16,114 - INFO -      [5] ‚úì Batch fetched in 1.683s
2025-11-03 15:45:16,333 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 269.0112 (accum_step 2/4)
2025-11-03 15:45:16,594 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:45:16,897 - INFO -      [5] ‚úì Batch fetched in 0.304s
2025-11-03 15:45:17,117 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 270.2458 (accum_step 3/4)
2025-11-03 15:45:17,378 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:45:17,378 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:17,406 - INFO -      [5] ‚úì Forward pass completed in 0.008s, loss = 273.2044 (accum_step 4/4)
2025-11-03 15:45:17,449 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:45:18,694 - INFO -      [6] ‚úì Batch fetched in 1.246s
2025-11-03 15:45:18,914 - INFO -      [6] ‚úì Forward pass completed in 0.008s, loss = 260.4124 (accum_step 1/4)
2025-11-03 15:45:19,174 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:45:19,401 - INFO -      [6] ‚úì Batch fetched in 0.227s
2025-11-03 15:45:19,621 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 260.0057 (accum_step 2/4)
2025-11-03 15:45:19,880 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:45:19,881 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:19,908 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 255.9815 (accum_step 3/4)
2025-11-03 15:45:19,942 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:45:21,399 - INFO -      [6] ‚úì Batch fetched in 1.457s
2025-11-03 15:45:21,618 - INFO -      [6] ‚úì Forward pass completed in 0.008s, loss = 257.3705 (accum_step 4/4)
2025-11-03 15:45:21,890 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:45:22,356 - INFO -      [7] ‚úì Batch fetched in 0.467s
2025-11-03 15:45:22,575 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 247.2447 (accum_step 1/4)
2025-11-03 15:45:22,835 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:45:22,835 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:22,863 - INFO -      [7] ‚úì Forward pass completed in 0.008s, loss = 255.1147 (accum_step 2/4)
2025-11-03 15:45:22,897 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:45:25,076 - INFO -      [7] ‚úì Batch fetched in 2.180s
2025-11-03 15:45:25,316 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 250.8890 (accum_step 3/4)
2025-11-03 15:45:25,579 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:45:25,579 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:25,793 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 251.7272 (accum_step 4/4)
2025-11-03 15:45:26,063 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:45:26,063 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:26,091 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 234.8788 (accum_step 1/4)
2025-11-03 15:45:26,124 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:45:28,511 - INFO -      [8] ‚úì Batch fetched in 2.388s
2025-11-03 15:45:28,752 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 237.7718 (accum_step 2/4)
2025-11-03 15:45:29,014 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:45:29,177 - INFO -      [8] ‚úì Batch fetched in 0.163s
2025-11-03 15:45:29,392 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.5870 (accum_step 3/4)
2025-11-03 15:45:29,652 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:45:29,652 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:29,680 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 233.1840 (accum_step 4/4)
2025-11-03 15:45:29,723 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:45:31,869 - INFO -      [9] ‚úì Batch fetched in 2.146s
2025-11-03 15:45:32,100 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 225.6152 (accum_step 1/4)
2025-11-03 15:45:32,359 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:45:32,399 - INFO -      [9] ‚úì Batch fetched in 0.040s
2025-11-03 15:45:32,618 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 227.8802 (accum_step 2/4)
2025-11-03 15:45:32,878 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:45:32,878 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:45:32,906 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.6575 (accum_step 3/4)
2025-11-03 15:45:32,939 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:45:35,537 - INFO -      [9] ‚úì Batch fetched in 2.597s
2025-11-03 15:45:35,773 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.3512 (accum_step 4/4)
2025-11-03 15:45:36,045 - INFO -   Step 10/10: loss = 226.6260, avg_loss = 268.7714, lr = 0.000021, grad_norm = 279.5520
2025-11-03 15:45:36,045 - INFO -     ‚è±Ô∏è  Timing: total=6.322s (fetch=4.784s, to_device=0.015s, spec_compute=0.003s, forward=0.027s, backward=0.043s, optim=0.009s)
2025-11-03 15:45:36,045 - INFO - 
================================================================================
2025-11-03 15:45:36,045 - INFO - TRAINING SUMMARY:
2025-11-03 15:45:36,045 - INFO -   Steps Completed: 10
2025-11-03 15:45:36,045 - INFO -   Average Loss: 268.7714
2025-11-03 15:45:36,045 - INFO -   Best Validation Loss: inf
2025-11-03 15:45:36,045 - INFO - ================================================================================
2025-11-03 15:45:36,046 - INFO - 
================================================================================
2025-11-03 15:45:36,046 - INFO - TRAINING COMPLETED
2025-11-03 15:45:36,046 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:45:36,046 - INFO - Final step: 10
2025-11-03 15:45:36,046 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 15:45:36,046 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:45:36,046 - INFO - ================================================================================
2025-11-03 15:45:48,912 - INFO - ================================================================================
2025-11-03 15:45:48,912 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 15:45:48,912 - INFO - ================================================================================
2025-11-03 15:45:48,912 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:45:48,912 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:45:48,912 - INFO - ================================================================================
2025-11-03 15:45:48,913 - INFO - Device: cuda
2025-11-03 15:45:48,913 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 15:45:48,913 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 15:45:48,913 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 15:45:48,913 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 15:45:48,914 - INFO -   Batch size: 128, Steps: 10
2025-11-03 15:45:48,914 - INFO -   Validation interval: 20 steps
2025-11-03 15:45:48,914 - INFO -   Log interval: 5 steps
2025-11-03 15:45:48,914 - INFO - 
Initializing model...
2025-11-03 15:45:49,400 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 15:45:49,400 - INFO -   Total parameters: 44,674,663
2025-11-03 15:45:49,400 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 15:45:52,475 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 15:45:52,475 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 15:45:52,484 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 15:45:52,484 - INFO - 
Setting up datasets...
2025-11-03 15:45:52,484 - INFO -   Loading MAESTRO dataset...
2025-11-03 15:45:52,487 - INFO -   ‚úì MAESTRO train: 20 samples (cached)
2025-11-03 15:45:52,488 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 15:45:52,488 - INFO -   Loading SLAKH stems dataset...
2025-11-03 15:45:53,172 - INFO -   ‚úì SLAKH stems train: 209 samples (cached)
2025-11-03 15:45:53,604 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 15:45:53,604 - INFO -   Loading SLAKH mix dataset...
2025-11-03 15:45:53,656 - INFO -   ‚úì SLAKH mix train: 20 samples (cached)
2025-11-03 15:45:53,717 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 15:45:53,717 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 15:45:53,769 - INFO -   ‚úì SLAKH mixed train: 20 samples (cached)
2025-11-03 15:45:53,808 - INFO -   ‚úì SLAKH mixed val: 20 samples (cached)
2025-11-03 15:45:53,809 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 15:45:53,809 - INFO -   Warming train cache for maestro dataset before forking workers...
2025-11-03 15:45:54,060 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 15:45:54,828 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 15:45:56,460 - INFO -   Warming validation cache for maestro dataset before forking workers...
2025-11-03 15:45:56,760 - INFO -   Warming validation cache for slakh_stems dataset before forking workers...
2025-11-03 15:45:58,299 - INFO -   Warming validation cache for slakh_mix dataset before forking workers...
2025-11-03 15:45:59,851 - INFO - 
  Creating multi-task dataset...
2025-11-03 15:45:59,852 - INFO -   ‚úì Multi-task dataset: 269 total samples
2025-11-03 15:45:59,852 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 15:45:59,852 - INFO - 
  Setting up validation data...
2025-11-03 15:45:59,852 - INFO -   ‚úì Validation: 267 samples
2025-11-03 15:45:59,853 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 15:45:59,854 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 15:45:59,854 - INFO -   Label smoothing: 0.1
2025-11-03 15:45:59,854 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 15:45:59,854 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 15:45:59,854 - INFO - 
Starting training...
2025-11-03 15:45:59,854 - INFO -   Total steps: 10
2025-11-03 15:45:59,854 - INFO -   Batch size: 128
2025-11-03 15:45:59,854 - INFO -   Learning rate: 0.0001
2025-11-03 15:45:59,854 - INFO -   Weight decay: 0.1
2025-11-03 15:45:59,854 - INFO -   Log interval: 5 steps
2025-11-03 15:45:59,854 - INFO -   Validation interval: 20 steps
2025-11-03 15:45:59,854 - INFO -   Save interval: 100 steps
2025-11-03 15:45:59,855 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 15:45:59,909 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 15:45:59,910 - INFO - 
================================================================================
2025-11-03 15:45:59,910 - INFO - STEP-BASED TRAINING
2025-11-03 15:45:59,910 - INFO -   Starting from step: 0
2025-11-03 15:45:59,910 - INFO -   Target steps: 10
2025-11-03 15:45:59,910 - INFO -   Batch size: 128
2025-11-03 15:45:59,910 - INFO -   Gradient accumulation steps: 4
2025-11-03 15:45:59,910 - INFO -   Effective batch size: 512
2025-11-03 15:45:59,910 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 15:45:59,910 - INFO - ================================================================================
2025-11-03 15:45:59,910 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 15:45:59,910 - INFO - 
üöÄ Starting training loop...
2025-11-03 15:45:59,910 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 15:45:59,910 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:46:04,451 - INFO -      [0] ‚úì Batch fetched in 4.541s
2025-11-03 15:46:04,451 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:46:04,457 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:46:04,781 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.323s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:46:04,781 - INFO -      [0] Starting forward pass...
2025-11-03 15:46:07,482 - INFO -      [0] ‚úì Forward pass completed in 2.701s, loss = 290.8715 (accum_step 1/4)
2025-11-03 15:46:07,482 - INFO -      [0] Starting backward pass...
2025-11-03 15:46:07,798 - INFO -      [0] ‚úì Backward pass completed in 0.316s
2025-11-03 15:46:07,819 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:46:07,819 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:07,819 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:46:07,820 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:46:07,821 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:46:07,821 - INFO -      [0] Starting forward pass...
2025-11-03 15:46:08,034 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 296.6624 (accum_step 2/4)
2025-11-03 15:46:08,034 - INFO -      [0] Starting backward pass...
2025-11-03 15:46:08,049 - INFO -      [0] ‚úì Backward pass completed in 0.015s
2025-11-03 15:46:08,294 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:46:08,295 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:08,295 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:46:08,295 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:46:08,297 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:46:08,297 - INFO -      [0] Starting forward pass...
2025-11-03 15:46:10,993 - INFO -      [0] ‚úì Forward pass completed in 2.685s, loss = 289.0909 (accum_step 3/4)
2025-11-03 15:46:10,993 - INFO -      [0] Starting backward pass...
2025-11-03 15:46:11,072 - INFO -      [0] ‚úì Backward pass completed in 0.079s
2025-11-03 15:46:11,073 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:46:13,691 - INFO -      [0] ‚úì Batch fetched in 2.618s
2025-11-03 15:46:13,691 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:46:13,697 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:46:13,698 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:46:13,698 - INFO -      [0] Starting forward pass...
2025-11-03 15:46:13,921 - INFO -      [0] ‚úì Forward pass completed in 0.011s, loss = 291.3250 (accum_step 4/4)
2025-11-03 15:46:13,921 - INFO -      [0] Starting backward pass...
2025-11-03 15:46:13,932 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:46:14,181 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 15:46:14,296 - INFO -      [0] ‚úì Optimizer step completed in 0.115s, grad_norm = 324.0614
2025-11-03 15:46:14,296 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:46:14,297 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:14,297 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:46:14,308 - INFO -      [1] ‚úì Data moved to device in 0.012s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:46:14,310 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:46:14,310 - INFO -      [1] Starting forward pass...
2025-11-03 15:46:14,523 - INFO -      [1] ‚úì Forward pass completed in 0.041s, loss = 289.2751 (accum_step 1/4)
2025-11-03 15:46:14,523 - INFO -      [1] Starting backward pass...
2025-11-03 15:46:14,539 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 15:46:14,790 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:46:14,790 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:14,790 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:46:14,792 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:46:14,793 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:46:14,793 - INFO -      [1] Starting forward pass...
2025-11-03 15:46:14,819 - INFO -      [1] ‚úì Forward pass completed in 0.011s, loss = 286.6450 (accum_step 2/4)
2025-11-03 15:46:14,819 - INFO -      [1] Starting backward pass...
2025-11-03 15:46:14,834 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 15:46:14,853 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:46:17,034 - INFO -      [1] ‚úì Batch fetched in 2.181s
2025-11-03 15:46:17,035 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:46:17,041 - INFO -      [1] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:46:17,042 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:46:17,042 - INFO -      [1] Starting forward pass...
2025-11-03 15:46:17,271 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 295.4646 (accum_step 3/4)
2025-11-03 15:46:17,271 - INFO -      [1] Starting backward pass...
2025-11-03 15:46:17,285 - INFO -      [1] ‚úì Backward pass completed in 0.014s
2025-11-03 15:46:17,534 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:46:17,534 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:17,534 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:46:17,540 - INFO -      [1] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:46:17,540 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:46:17,540 - INFO -      [1] Starting forward pass...
2025-11-03 15:46:17,753 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 291.9831 (accum_step 4/4)
2025-11-03 15:46:17,753 - INFO -      [1] Starting backward pass...
2025-11-03 15:46:17,763 - INFO -      [1] ‚úì Backward pass completed in 0.010s
2025-11-03 15:46:18,013 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 15:46:18,022 - INFO -      [1] ‚úì Optimizer step completed in 0.009s, grad_norm = 323.6696
2025-11-03 15:46:18,023 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:46:18,023 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:18,023 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:46:18,024 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:46:18,024 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:46:18,024 - INFO -      [2] Starting forward pass...
2025-11-03 15:46:18,050 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 294.6188 (accum_step 1/4)
2025-11-03 15:46:18,050 - INFO -      [2] Starting backward pass...
2025-11-03 15:46:18,060 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:46:18,083 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:46:19,876 - INFO -      [2] ‚úì Batch fetched in 1.793s
2025-11-03 15:46:19,876 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:46:19,878 - INFO -      [2] ‚úì Data moved to device in 0.002s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:46:19,879 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:46:19,879 - INFO -      [2] Starting forward pass...
2025-11-03 15:46:20,106 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.0400 (accum_step 2/4)
2025-11-03 15:46:20,107 - INFO -      [2] Starting backward pass...
2025-11-03 15:46:20,119 - INFO -      [2] ‚úì Backward pass completed in 0.013s
2025-11-03 15:46:20,368 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:46:20,368 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:20,368 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:46:20,374 - INFO -      [2] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:46:20,374 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:46:20,375 - INFO -      [2] Starting forward pass...
2025-11-03 15:46:20,587 - INFO -      [2] ‚úì Forward pass completed in 0.008s, loss = 288.8475 (accum_step 3/4)
2025-11-03 15:46:20,587 - INFO -      [2] Starting backward pass...
2025-11-03 15:46:20,599 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 15:46:20,848 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:46:20,849 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:20,849 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:46:20,850 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:46:20,850 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:46:20,851 - INFO -      [2] Starting forward pass...
2025-11-03 15:46:20,876 - INFO -      [2] ‚úì Forward pass completed in 0.008s, loss = 298.4500 (accum_step 4/4)
2025-11-03 15:46:20,877 - INFO -      [2] Starting backward pass...
2025-11-03 15:46:20,892 - INFO -      [2] ‚úì Backward pass completed in 0.015s
2025-11-03 15:46:20,911 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 15:46:20,921 - INFO -      [2] ‚úì Optimizer step completed in 0.009s, grad_norm = 331.3847
2025-11-03 15:46:20,921 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:46:22,718 - INFO -      [3] ‚úì Batch fetched in 1.797s
2025-11-03 15:46:22,945 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 289.4940 (accum_step 1/4)
2025-11-03 15:46:23,206 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:46:23,578 - INFO -      [3] ‚úì Batch fetched in 0.372s
2025-11-03 15:46:23,797 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 283.5954 (accum_step 2/4)
2025-11-03 15:46:24,057 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:46:24,057 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:24,084 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 289.9715 (accum_step 3/4)
2025-11-03 15:46:24,118 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:46:26,169 - INFO -      [3] ‚úì Batch fetched in 2.051s
2025-11-03 15:46:26,398 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 287.7613 (accum_step 4/4)
2025-11-03 15:46:26,668 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:46:26,668 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:26,886 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 277.9601 (accum_step 1/4)
2025-11-03 15:46:27,146 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:46:27,146 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:27,174 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 282.7673 (accum_step 2/4)
2025-11-03 15:46:27,207 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:46:28,967 - INFO -      [4] ‚úì Batch fetched in 1.760s
2025-11-03 15:46:29,182 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 276.1533 (accum_step 3/4)
2025-11-03 15:46:29,442 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:46:29,443 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:29,661 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 278.7614 (accum_step 4/4)
2025-11-03 15:46:29,930 - INFO -   Step 5/10: loss = 278.9106, avg_loss = 288.3869, lr = 0.000011, grad_norm = 327.9622
2025-11-03 15:46:29,930 - INFO -     ‚è±Ô∏è  Timing: total=3.262s (fetch=1.761s, to_device=0.014s, spec_compute=0.002s, forward=0.025s, backward=0.042s, optim=0.009s)
2025-11-03 15:46:29,930 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:46:29,930 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:29,957 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 278.9865 (accum_step 1/4)
2025-11-03 15:46:29,990 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:46:31,564 - INFO -      [5] ‚úì Batch fetched in 1.574s
2025-11-03 15:46:31,779 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 269.0114 (accum_step 2/4)
2025-11-03 15:46:32,039 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:46:32,325 - INFO -      [5] ‚úì Batch fetched in 0.286s
2025-11-03 15:46:32,540 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 270.2458 (accum_step 3/4)
2025-11-03 15:46:32,800 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:46:32,801 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:32,828 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 273.2049 (accum_step 4/4)
2025-11-03 15:46:32,870 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:46:34,076 - INFO -      [6] ‚úì Batch fetched in 1.205s
2025-11-03 15:46:34,296 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 260.4124 (accum_step 1/4)
2025-11-03 15:46:34,555 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:46:34,771 - INFO -      [6] ‚úì Batch fetched in 0.216s
2025-11-03 15:46:34,989 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 260.0057 (accum_step 2/4)
2025-11-03 15:46:35,249 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:46:35,249 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:35,276 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 255.9815 (accum_step 3/4)
2025-11-03 15:46:35,310 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:46:36,735 - INFO -      [6] ‚úì Batch fetched in 1.425s
2025-11-03 15:46:36,950 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 257.3704 (accum_step 4/4)
2025-11-03 15:46:37,219 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:46:37,810 - INFO -      [7] ‚úì Batch fetched in 0.591s
2025-11-03 15:46:38,024 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 247.2450 (accum_step 1/4)
2025-11-03 15:46:38,284 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:46:38,284 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:38,312 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 255.1144 (accum_step 2/4)
2025-11-03 15:46:38,345 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:46:40,464 - INFO -      [7] ‚úì Batch fetched in 2.119s
2025-11-03 15:46:40,694 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 250.8890 (accum_step 3/4)
2025-11-03 15:46:40,954 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:46:40,954 - INFO -      [7] ‚úì Batch fetched in 0.001s
2025-11-03 15:46:41,174 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 251.7271 (accum_step 4/4)
2025-11-03 15:46:41,442 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:46:41,442 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:41,469 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 234.8788 (accum_step 1/4)
2025-11-03 15:46:41,502 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:46:43,678 - INFO -      [8] ‚úì Batch fetched in 2.177s
2025-11-03 15:46:43,907 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 237.7720 (accum_step 2/4)
2025-11-03 15:46:44,168 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:46:44,168 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:44,388 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.5869 (accum_step 3/4)
2025-11-03 15:46:44,649 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:46:44,649 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:44,676 - INFO -      [8] ‚úì Forward pass completed in 0.009s, loss = 233.1844 (accum_step 4/4)
2025-11-03 15:46:44,719 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:46:47,031 - INFO -      [9] ‚úì Batch fetched in 2.312s
2025-11-03 15:46:47,266 - INFO -      [9] ‚úì Forward pass completed in 0.010s, loss = 225.6151 (accum_step 1/4)
2025-11-03 15:46:47,526 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:46:47,527 - INFO -      [9] ‚úì Batch fetched in 0.001s
2025-11-03 15:46:47,746 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 227.8802 (accum_step 2/4)
2025-11-03 15:46:48,006 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:46:48,006 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:46:48,033 - INFO -      [9] ‚úì Forward pass completed in 0.008s, loss = 226.6576 (accum_step 3/4)
2025-11-03 15:46:48,067 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:46:50,426 - INFO -      [9] ‚úì Batch fetched in 2.359s
2025-11-03 15:46:50,659 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.3512 (accum_step 4/4)
2025-11-03 15:46:50,928 - INFO -   Step 10/10: loss = 226.6260, avg_loss = 268.7715, lr = 0.000021, grad_norm = 279.5519
2025-11-03 15:46:50,928 - INFO -     ‚è±Ô∏è  Timing: total=6.209s (fetch=4.673s, to_device=0.013s, spec_compute=0.003s, forward=0.031s, backward=0.042s, optim=0.009s)
2025-11-03 15:46:50,928 - INFO - 
================================================================================
2025-11-03 15:46:50,928 - INFO - TRAINING SUMMARY:
2025-11-03 15:46:50,928 - INFO -   Steps Completed: 10
2025-11-03 15:46:50,928 - INFO -   Average Loss: 268.7715
2025-11-03 15:46:50,928 - INFO -   Best Validation Loss: inf
2025-11-03 15:46:50,929 - INFO - ================================================================================
2025-11-03 15:46:50,929 - INFO - 
================================================================================
2025-11-03 15:46:50,929 - INFO - TRAINING COMPLETED
2025-11-03 15:46:50,929 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:46:50,929 - INFO - Final step: 10
2025-11-03 15:46:50,929 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 15:46:50,929 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:46:50,929 - INFO - ================================================================================
2025-11-03 15:50:09,597 - INFO - ================================================================================
2025-11-03 15:50:09,597 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 15:50:09,597 - INFO - ================================================================================
2025-11-03 15:50:09,597 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:50:09,597 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:50:09,597 - INFO - ================================================================================
2025-11-03 15:50:09,598 - INFO - Device: cuda
2025-11-03 15:50:09,598 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 15:50:09,598 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 15:50:09,598 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 15:50:09,598 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 15:50:09,598 - INFO -   Batch size: 128, Steps: 10
2025-11-03 15:50:09,598 - INFO -   Validation interval: 20 steps
2025-11-03 15:50:09,598 - INFO -   Log interval: 5 steps
2025-11-03 15:50:09,598 - INFO - 
Initializing model...
2025-11-03 15:50:10,188 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 15:50:10,189 - INFO -   Total parameters: 44,674,663
2025-11-03 15:50:10,189 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 15:50:13,174 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 15:50:13,174 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 15:50:13,183 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 15:50:13,183 - INFO - 
Setting up datasets...
2025-11-03 15:50:13,183 - INFO -   Loading MAESTRO dataset...
2025-11-03 15:50:13,187 - INFO -   ‚úì MAESTRO train: 20 samples (cached)
2025-11-03 15:50:13,188 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 15:50:13,188 - INFO -   Loading SLAKH stems dataset...
2025-11-03 15:50:13,883 - INFO -   ‚úì SLAKH stems train: 209 samples (cached)
2025-11-03 15:50:14,346 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 15:50:14,346 - INFO -   Loading SLAKH mix dataset...
2025-11-03 15:50:14,400 - INFO -   ‚úì SLAKH mix train: 20 samples (cached)
2025-11-03 15:50:14,452 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 15:50:14,452 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 15:50:14,508 - INFO -   ‚úì SLAKH mixed train: 20 samples (cached)
2025-11-03 15:50:14,557 - INFO -   ‚úì SLAKH mixed val: 20 samples (cached)
2025-11-03 15:50:14,557 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 15:50:14,558 - INFO -   Warming train cache for maestro dataset before forking workers...
2025-11-03 15:50:14,818 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 15:50:15,603 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 15:50:16,381 - INFO -   Warming validation cache for maestro dataset before forking workers...
2025-11-03 15:50:16,514 - INFO -   Warming validation cache for slakh_stems dataset before forking workers...
2025-11-03 15:50:17,179 - INFO -   Warming validation cache for slakh_mix dataset before forking workers...
2025-11-03 15:50:17,846 - INFO - 
  Creating multi-task dataset...
2025-11-03 15:50:17,846 - INFO -   ‚úì Multi-task dataset: 269 total samples
2025-11-03 15:50:17,846 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 15:50:17,846 - INFO - 
  Setting up validation data...
2025-11-03 15:50:17,847 - INFO -   ‚úì Validation: 267 samples
2025-11-03 15:50:17,848 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 15:50:17,848 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 15:50:17,848 - INFO -   Label smoothing: 0.1
2025-11-03 15:50:17,848 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 15:50:17,849 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 15:50:17,849 - INFO - 
Starting training...
2025-11-03 15:50:17,849 - INFO -   Total steps: 10
2025-11-03 15:50:17,849 - INFO -   Batch size: 128
2025-11-03 15:50:17,849 - INFO -   Learning rate: 0.0001
2025-11-03 15:50:17,849 - INFO -   Weight decay: 0.1
2025-11-03 15:50:17,849 - INFO -   Log interval: 5 steps
2025-11-03 15:50:17,849 - INFO -   Validation interval: 20 steps
2025-11-03 15:50:17,849 - INFO -   Save interval: 100 steps
2025-11-03 15:50:17,850 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 15:50:17,901 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 15:50:17,902 - INFO - 
================================================================================
2025-11-03 15:50:17,902 - INFO - STEP-BASED TRAINING
2025-11-03 15:50:17,902 - INFO -   Starting from step: 0
2025-11-03 15:50:17,902 - INFO -   Target steps: 10
2025-11-03 15:50:17,902 - INFO -   Batch size: 128
2025-11-03 15:50:17,902 - INFO -   Gradient accumulation steps: 4
2025-11-03 15:50:17,902 - INFO -   Effective batch size: 512
2025-11-03 15:50:17,902 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 15:50:17,902 - INFO - ================================================================================
2025-11-03 15:50:17,902 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 15:50:17,902 - INFO - 
üöÄ Starting training loop...
2025-11-03 15:50:17,902 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 15:50:17,902 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:50:21,216 - INFO -      [0] ‚úì Batch fetched in 3.314s
2025-11-03 15:50:21,217 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:50:21,221 - INFO -      [0] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:50:21,518 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.297s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:50:21,519 - INFO -      [0] Starting forward pass...
2025-11-03 15:50:24,121 - INFO -      [0] ‚úì Forward pass completed in 2.602s, loss = 290.8714 (accum_step 1/4)
2025-11-03 15:50:24,121 - INFO -      [0] Starting backward pass...
2025-11-03 15:50:24,435 - INFO -      [0] ‚úì Backward pass completed in 0.314s
2025-11-03 15:50:24,456 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:50:24,456 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:24,456 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:50:24,457 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:50:24,458 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:50:24,458 - INFO -      [0] Starting forward pass...
2025-11-03 15:50:24,671 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 296.6624 (accum_step 2/4)
2025-11-03 15:50:24,671 - INFO -      [0] Starting backward pass...
2025-11-03 15:50:24,687 - INFO -      [0] ‚úì Backward pass completed in 0.016s
2025-11-03 15:50:24,931 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:50:24,932 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:24,932 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:50:24,932 - INFO -      [0] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:50:24,934 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:50:24,934 - INFO -      [0] Starting forward pass...
2025-11-03 15:50:27,606 - INFO -      [0] ‚úì Forward pass completed in 2.662s, loss = 289.0909 (accum_step 3/4)
2025-11-03 15:50:27,607 - INFO -      [0] Starting backward pass...
2025-11-03 15:50:27,686 - INFO -      [0] ‚úì Backward pass completed in 0.079s
2025-11-03 15:50:27,686 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:50:30,178 - INFO -      [0] ‚úì Batch fetched in 2.491s
2025-11-03 15:50:30,178 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:50:30,183 - INFO -      [0] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:50:30,184 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:50:30,184 - INFO -      [0] Starting forward pass...
2025-11-03 15:50:30,408 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 291.3250 (accum_step 4/4)
2025-11-03 15:50:30,408 - INFO -      [0] Starting backward pass...
2025-11-03 15:50:30,419 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:50:30,668 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 15:50:30,767 - INFO -      [0] ‚úì Optimizer step completed in 0.098s, grad_norm = 324.0614
2025-11-03 15:50:30,767 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:50:30,767 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:30,767 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:50:30,775 - INFO -      [1] ‚úì Data moved to device in 0.008s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:50:30,777 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:50:30,777 - INFO -      [1] Starting forward pass...
2025-11-03 15:50:30,990 - INFO -      [1] ‚úì Forward pass completed in 0.041s, loss = 289.2750 (accum_step 1/4)
2025-11-03 15:50:30,990 - INFO -      [1] Starting backward pass...
2025-11-03 15:50:31,006 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 15:50:31,257 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:50:31,257 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:31,257 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:50:31,260 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:50:31,260 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:50:31,260 - INFO -      [1] Starting forward pass...
2025-11-03 15:50:31,287 - INFO -      [1] ‚úì Forward pass completed in 0.012s, loss = 286.6451 (accum_step 2/4)
2025-11-03 15:50:31,287 - INFO -      [1] Starting backward pass...
2025-11-03 15:50:31,302 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 15:50:31,321 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:50:33,143 - INFO -      [1] ‚úì Batch fetched in 1.822s
2025-11-03 15:50:33,144 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:50:33,149 - INFO -      [1] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:50:33,150 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:50:33,150 - INFO -      [1] Starting forward pass...
2025-11-03 15:50:33,362 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 295.4645 (accum_step 3/4)
2025-11-03 15:50:33,362 - INFO -      [1] Starting backward pass...
2025-11-03 15:50:33,376 - INFO -      [1] ‚úì Backward pass completed in 0.014s
2025-11-03 15:50:33,625 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:50:33,625 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:33,625 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:50:33,629 - INFO -      [1] ‚úì Data moved to device in 0.004s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:50:33,629 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:50:33,629 - INFO -      [1] Starting forward pass...
2025-11-03 15:50:33,842 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 291.9830 (accum_step 4/4)
2025-11-03 15:50:33,842 - INFO -      [1] Starting backward pass...
2025-11-03 15:50:33,852 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 15:50:34,102 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 15:50:34,111 - INFO -      [1] ‚úì Optimizer step completed in 0.008s, grad_norm = 323.6696
2025-11-03 15:50:34,111 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:50:34,111 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:34,111 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:50:34,111 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:50:34,111 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:50:34,112 - INFO -      [2] Starting forward pass...
2025-11-03 15:50:34,138 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 294.6193 (accum_step 1/4)
2025-11-03 15:50:34,138 - INFO -      [2] Starting backward pass...
2025-11-03 15:50:34,148 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:50:34,171 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:50:35,663 - INFO -      [2] ‚úì Batch fetched in 1.493s
2025-11-03 15:50:35,664 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:50:35,668 - INFO -      [2] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:50:35,669 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:50:35,669 - INFO -      [2] Starting forward pass...
2025-11-03 15:50:35,882 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.0401 (accum_step 2/4)
2025-11-03 15:50:35,882 - INFO -      [2] Starting backward pass...
2025-11-03 15:50:35,893 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 15:50:36,142 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:50:36,247 - INFO -      [2] ‚úì Batch fetched in 0.105s
2025-11-03 15:50:36,247 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:50:36,252 - INFO -      [2] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:50:36,253 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:50:36,253 - INFO -      [2] Starting forward pass...
2025-11-03 15:50:36,466 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.8478 (accum_step 3/4)
2025-11-03 15:50:36,466 - INFO -      [2] Starting backward pass...
2025-11-03 15:50:36,476 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:50:36,726 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:50:36,726 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:36,727 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:50:36,727 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:50:36,727 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:50:36,728 - INFO -      [2] Starting forward pass...
2025-11-03 15:50:36,754 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 298.4497 (accum_step 4/4)
2025-11-03 15:50:36,754 - INFO -      [2] Starting backward pass...
2025-11-03 15:50:36,765 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 15:50:36,788 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 15:50:36,796 - INFO -      [2] ‚úì Optimizer step completed in 0.009s, grad_norm = 331.3846
2025-11-03 15:50:36,796 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:50:38,464 - INFO -      [3] ‚úì Batch fetched in 1.668s
2025-11-03 15:50:38,680 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 289.4939 (accum_step 1/4)
2025-11-03 15:50:38,940 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:50:39,247 - INFO -      [3] ‚úì Batch fetched in 0.307s
2025-11-03 15:50:39,466 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 283.5952 (accum_step 2/4)
2025-11-03 15:50:39,726 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:50:39,726 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:39,753 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 289.9711 (accum_step 3/4)
2025-11-03 15:50:39,787 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:50:41,693 - INFO -      [3] ‚úì Batch fetched in 1.906s
2025-11-03 15:50:41,928 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 287.7612 (accum_step 4/4)
2025-11-03 15:50:42,201 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:50:42,201 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:42,419 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 277.9601 (accum_step 1/4)
2025-11-03 15:50:42,679 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:50:42,679 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:42,706 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 282.7671 (accum_step 2/4)
2025-11-03 15:50:42,739 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:50:44,391 - INFO -      [4] ‚úì Batch fetched in 1.652s
2025-11-03 15:50:44,611 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 276.1534 (accum_step 3/4)
2025-11-03 15:50:44,871 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:50:44,871 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:45,090 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 278.7616 (accum_step 4/4)
2025-11-03 15:50:45,358 - INFO -   Step 5/10: loss = 278.9106, avg_loss = 288.3869, lr = 0.000011, grad_norm = 327.9622
2025-11-03 15:50:45,358 - INFO -     ‚è±Ô∏è  Timing: total=3.157s (fetch=1.653s, to_device=0.017s, spec_compute=0.002s, forward=0.025s, backward=0.041s, optim=0.009s)
2025-11-03 15:50:45,358 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:50:45,358 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:45,385 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 278.9860 (accum_step 1/4)
2025-11-03 15:50:45,418 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:50:46,830 - INFO -      [5] ‚úì Batch fetched in 1.412s
2025-11-03 15:50:47,050 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 269.0114 (accum_step 2/4)
2025-11-03 15:50:47,310 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:50:47,589 - INFO -      [5] ‚úì Batch fetched in 0.278s
2025-11-03 15:50:47,808 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 270.2458 (accum_step 3/4)
2025-11-03 15:50:48,069 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:50:48,069 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:48,096 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 273.2050 (accum_step 4/4)
2025-11-03 15:50:48,138 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:50:49,160 - INFO -      [6] ‚úì Batch fetched in 1.021s
2025-11-03 15:50:49,378 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 260.4126 (accum_step 1/4)
2025-11-03 15:50:49,637 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:50:49,929 - INFO -      [6] ‚úì Batch fetched in 0.291s
2025-11-03 15:50:50,148 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 260.0056 (accum_step 2/4)
2025-11-03 15:50:50,407 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:50:50,407 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:50,434 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 255.9813 (accum_step 3/4)
2025-11-03 15:50:50,468 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:50:51,767 - INFO -      [6] ‚úì Batch fetched in 1.298s
2025-11-03 15:50:51,984 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 257.3704 (accum_step 4/4)
2025-11-03 15:50:52,254 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:50:52,714 - INFO -      [7] ‚úì Batch fetched in 0.460s
2025-11-03 15:50:52,935 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 247.2449 (accum_step 1/4)
2025-11-03 15:50:53,194 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:50:53,194 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:53,221 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 255.1143 (accum_step 2/4)
2025-11-03 15:50:53,255 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:50:55,238 - INFO -      [7] ‚úì Batch fetched in 1.983s
2025-11-03 15:50:55,477 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 250.8891 (accum_step 3/4)
2025-11-03 15:50:55,737 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:50:55,738 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:55,952 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.7272 (accum_step 4/4)
2025-11-03 15:50:56,220 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:50:56,220 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:56,247 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 234.8792 (accum_step 1/4)
2025-11-03 15:50:56,280 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:50:58,367 - INFO -      [8] ‚úì Batch fetched in 2.088s
2025-11-03 15:50:58,596 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 237.7720 (accum_step 2/4)
2025-11-03 15:50:58,857 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:50:58,857 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:59,076 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.5869 (accum_step 3/4)
2025-11-03 15:50:59,336 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:50:59,336 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:50:59,363 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 233.1843 (accum_step 4/4)
2025-11-03 15:50:59,405 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:51:01,421 - INFO -      [9] ‚úì Batch fetched in 2.016s
2025-11-03 15:51:01,653 - INFO -      [9] ‚úì Forward pass completed in 0.008s, loss = 225.6151 (accum_step 1/4)
2025-11-03 15:51:01,918 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:51:01,918 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:51:02,132 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 227.8803 (accum_step 2/4)
2025-11-03 15:51:02,392 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:51:02,392 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:51:02,420 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.6573 (accum_step 3/4)
2025-11-03 15:51:02,453 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:51:04,643 - INFO -      [9] ‚úì Batch fetched in 2.189s
2025-11-03 15:51:04,879 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.3513 (accum_step 4/4)
2025-11-03 15:51:05,151 - INFO -   Step 10/10: loss = 226.6260, avg_loss = 268.7714, lr = 0.000021, grad_norm = 279.5520
2025-11-03 15:51:05,151 - INFO -     ‚è±Ô∏è  Timing: total=5.746s (fetch=4.206s, to_device=0.011s, spec_compute=0.003s, forward=0.027s, backward=0.043s, optim=0.009s)
2025-11-03 15:51:05,151 - INFO - 
================================================================================
2025-11-03 15:51:05,151 - INFO - TRAINING SUMMARY:
2025-11-03 15:51:05,151 - INFO -   Steps Completed: 10
2025-11-03 15:51:05,151 - INFO -   Average Loss: 268.7714
2025-11-03 15:51:05,151 - INFO -   Best Validation Loss: inf
2025-11-03 15:51:05,151 - INFO - ================================================================================
2025-11-03 15:51:05,152 - INFO - 
================================================================================
2025-11-03 15:51:05,152 - INFO - TRAINING COMPLETED
2025-11-03 15:51:05,152 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:51:05,152 - INFO - Final step: 10
2025-11-03 15:51:05,152 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 15:51:05,152 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:51:05,152 - INFO - ================================================================================
2025-11-03 15:52:00,277 - INFO - ================================================================================
2025-11-03 15:52:00,277 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 15:52:00,277 - INFO - ================================================================================
2025-11-03 15:52:00,277 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:52:00,277 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:52:00,277 - INFO - ================================================================================
2025-11-03 15:52:00,279 - INFO - Device: cuda
2025-11-03 15:52:00,279 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 15:52:00,279 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 15:52:00,279 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 15:52:00,279 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 15:52:00,279 - INFO -   Batch size: 128, Steps: 10
2025-11-03 15:52:00,279 - INFO -   Validation interval: 20 steps
2025-11-03 15:52:00,279 - INFO -   Log interval: 5 steps
2025-11-03 15:52:00,279 - INFO - 
Initializing model...
2025-11-03 15:52:00,803 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 15:52:00,804 - INFO -   Total parameters: 44,674,663
2025-11-03 15:52:00,804 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 15:52:03,817 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 15:52:03,817 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 15:52:03,825 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 15:52:03,826 - INFO - 
Setting up datasets...
2025-11-03 15:52:03,826 - INFO -   Loading MAESTRO dataset...
2025-11-03 15:52:03,829 - INFO -   ‚úì MAESTRO train: 20 samples (cached)
2025-11-03 15:52:03,830 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 15:52:03,830 - INFO -   Loading SLAKH stems dataset...
2025-11-03 15:52:04,530 - INFO -   ‚úì SLAKH stems train: 209 samples (cached)
2025-11-03 15:52:04,957 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 15:52:04,957 - INFO -   Loading SLAKH mix dataset...
2025-11-03 15:52:05,008 - INFO -   ‚úì SLAKH mix train: 20 samples (cached)
2025-11-03 15:52:05,065 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 15:52:05,065 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 15:52:05,121 - INFO -   ‚úì SLAKH mixed train: 20 samples (cached)
2025-11-03 15:52:05,161 - INFO -   ‚úì SLAKH mixed val: 20 samples (cached)
2025-11-03 15:52:05,162 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 15:52:05,162 - INFO -   Warming train cache for maestro dataset before forking workers...
2025-11-03 15:52:05,417 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 15:52:06,279 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 15:52:07,909 - INFO -   Warming validation cache for maestro dataset before forking workers...
2025-11-03 15:52:08,207 - INFO -   Warming validation cache for slakh_stems dataset before forking workers...
2025-11-03 15:52:09,748 - INFO -   Warming validation cache for slakh_mix dataset before forking workers...
2025-11-03 15:52:11,292 - INFO - 
  Creating multi-task dataset...
2025-11-03 15:52:11,292 - INFO -   ‚úì Multi-task dataset: 269 total samples
2025-11-03 15:52:11,292 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 15:52:11,292 - INFO - 
  Setting up validation data...
2025-11-03 15:52:11,292 - INFO -   ‚úì Validation: 267 samples
2025-11-03 15:52:11,294 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 15:52:11,294 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 15:52:11,294 - INFO -   Label smoothing: 0.1
2025-11-03 15:52:11,294 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 15:52:11,294 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 15:52:11,294 - INFO - 
Starting training...
2025-11-03 15:52:11,294 - INFO -   Total steps: 10
2025-11-03 15:52:11,294 - INFO -   Batch size: 128
2025-11-03 15:52:11,294 - INFO -   Learning rate: 0.0001
2025-11-03 15:52:11,294 - INFO -   Weight decay: 0.1
2025-11-03 15:52:11,294 - INFO -   Log interval: 5 steps
2025-11-03 15:52:11,295 - INFO -   Validation interval: 20 steps
2025-11-03 15:52:11,295 - INFO -   Save interval: 100 steps
2025-11-03 15:52:11,295 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 15:52:11,351 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 15:52:11,351 - INFO - 
================================================================================
2025-11-03 15:52:11,351 - INFO - STEP-BASED TRAINING
2025-11-03 15:52:11,351 - INFO -   Starting from step: 0
2025-11-03 15:52:11,351 - INFO -   Target steps: 10
2025-11-03 15:52:11,351 - INFO -   Batch size: 128
2025-11-03 15:52:11,351 - INFO -   Gradient accumulation steps: 4
2025-11-03 15:52:11,351 - INFO -   Effective batch size: 512
2025-11-03 15:52:11,351 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 15:52:11,351 - INFO - ================================================================================
2025-11-03 15:52:11,351 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 15:52:11,351 - INFO - 
üöÄ Starting training loop...
2025-11-03 15:52:11,351 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 15:52:11,351 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:52:15,137 - INFO -      [0] ‚úì Batch fetched in 3.786s
2025-11-03 15:52:15,138 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:52:15,144 - INFO -      [0] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:52:15,458 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.314s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:52:15,459 - INFO -      [0] Starting forward pass...
2025-11-03 15:52:18,157 - INFO -      [0] ‚úì Forward pass completed in 2.699s, loss = 290.8715 (accum_step 1/4)
2025-11-03 15:52:18,158 - INFO -      [0] Starting backward pass...
2025-11-03 15:52:18,477 - INFO -      [0] ‚úì Backward pass completed in 0.319s
2025-11-03 15:52:18,497 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:52:18,497 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:18,498 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:52:18,504 - INFO -      [0] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:52:18,505 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:52:18,505 - INFO -      [0] Starting forward pass...
2025-11-03 15:52:18,718 - INFO -      [0] ‚úì Forward pass completed in 0.011s, loss = 296.6624 (accum_step 2/4)
2025-11-03 15:52:18,718 - INFO -      [0] Starting backward pass...
2025-11-03 15:52:18,733 - INFO -      [0] ‚úì Backward pass completed in 0.015s
2025-11-03 15:52:18,978 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:52:18,978 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:18,978 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:52:18,978 - INFO -      [0] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:52:18,979 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:52:18,980 - INFO -      [0] Starting forward pass...
2025-11-03 15:52:21,661 - INFO -      [0] ‚úì Forward pass completed in 2.671s, loss = 289.0909 (accum_step 3/4)
2025-11-03 15:52:21,661 - INFO -      [0] Starting backward pass...
2025-11-03 15:52:21,741 - INFO -      [0] ‚úì Backward pass completed in 0.080s
2025-11-03 15:52:21,741 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:52:24,273 - INFO -      [0] ‚úì Batch fetched in 2.532s
2025-11-03 15:52:24,274 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:52:24,280 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:52:24,281 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:52:24,281 - INFO -      [0] Starting forward pass...
2025-11-03 15:52:24,509 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 291.3250 (accum_step 4/4)
2025-11-03 15:52:24,509 - INFO -      [0] Starting backward pass...
2025-11-03 15:52:24,522 - INFO -      [0] ‚úì Backward pass completed in 0.013s
2025-11-03 15:52:24,770 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 15:52:24,871 - INFO -      [0] ‚úì Optimizer step completed in 0.101s, grad_norm = 324.0614
2025-11-03 15:52:24,871 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:52:24,871 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:24,871 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:52:24,883 - INFO -      [1] ‚úì Data moved to device in 0.012s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:52:24,885 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:52:24,885 - INFO -      [1] Starting forward pass...
2025-11-03 15:52:25,098 - INFO -      [1] ‚úì Forward pass completed in 0.041s, loss = 289.2750 (accum_step 1/4)
2025-11-03 15:52:25,098 - INFO -      [1] Starting backward pass...
2025-11-03 15:52:25,117 - INFO -      [1] ‚úì Backward pass completed in 0.019s
2025-11-03 15:52:25,367 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:52:25,367 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:25,367 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:52:25,369 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:52:25,370 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:52:25,370 - INFO -      [1] Starting forward pass...
2025-11-03 15:52:25,396 - INFO -      [1] ‚úì Forward pass completed in 0.012s, loss = 286.6451 (accum_step 2/4)
2025-11-03 15:52:25,396 - INFO -      [1] Starting backward pass...
2025-11-03 15:52:25,412 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 15:52:25,430 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:52:27,329 - INFO -      [1] ‚úì Batch fetched in 1.898s
2025-11-03 15:52:27,329 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:52:27,330 - INFO -      [1] ‚úì Data moved to device in 0.001s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:52:27,331 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:52:27,331 - INFO -      [1] Starting forward pass...
2025-11-03 15:52:27,543 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 295.4647 (accum_step 3/4)
2025-11-03 15:52:27,544 - INFO -      [1] Starting backward pass...
2025-11-03 15:52:27,560 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 15:52:27,807 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:52:27,807 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:27,807 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:52:27,812 - INFO -      [1] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:52:27,813 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:52:27,813 - INFO -      [1] Starting forward pass...
2025-11-03 15:52:28,025 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 291.9830 (accum_step 4/4)
2025-11-03 15:52:28,025 - INFO -      [1] Starting backward pass...
2025-11-03 15:52:28,037 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 15:52:28,286 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 15:52:28,295 - INFO -      [1] ‚úì Optimizer step completed in 0.009s, grad_norm = 323.6696
2025-11-03 15:52:28,295 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:52:28,295 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:28,295 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:52:28,296 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:52:28,296 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:52:28,296 - INFO -      [2] Starting forward pass...
2025-11-03 15:52:28,323 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 294.6192 (accum_step 1/4)
2025-11-03 15:52:28,323 - INFO -      [2] Starting backward pass...
2025-11-03 15:52:28,334 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 15:52:28,356 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:52:29,942 - INFO -      [2] ‚úì Batch fetched in 1.587s
2025-11-03 15:52:29,942 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:52:29,946 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:52:29,947 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:52:29,947 - INFO -      [2] Starting forward pass...
2025-11-03 15:52:30,159 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.0400 (accum_step 2/4)
2025-11-03 15:52:30,159 - INFO -      [2] Starting backward pass...
2025-11-03 15:52:30,172 - INFO -      [2] ‚úì Backward pass completed in 0.013s
2025-11-03 15:52:30,420 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:52:30,455 - INFO -      [2] ‚úì Batch fetched in 0.035s
2025-11-03 15:52:30,455 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:52:30,462 - INFO -      [2] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:52:30,462 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:52:30,462 - INFO -      [2] Starting forward pass...
2025-11-03 15:52:30,675 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.8474 (accum_step 3/4)
2025-11-03 15:52:30,675 - INFO -      [2] Starting backward pass...
2025-11-03 15:52:30,687 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 15:52:30,935 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:52:30,936 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:30,936 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:52:30,936 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:52:30,937 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:52:30,937 - INFO -      [2] Starting forward pass...
2025-11-03 15:52:30,963 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 298.4490 (accum_step 4/4)
2025-11-03 15:52:30,963 - INFO -      [2] Starting backward pass...
2025-11-03 15:52:30,974 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 15:52:30,997 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 15:52:31,005 - INFO -      [2] ‚úì Optimizer step completed in 0.009s, grad_norm = 331.3846
2025-11-03 15:52:31,006 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:52:32,776 - INFO -      [3] ‚úì Batch fetched in 1.770s
2025-11-03 15:52:32,992 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 289.4939 (accum_step 1/4)
2025-11-03 15:52:33,252 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:52:33,485 - INFO -      [3] ‚úì Batch fetched in 0.232s
2025-11-03 15:52:33,704 - INFO -      [3] ‚úì Forward pass completed in 0.011s, loss = 283.5954 (accum_step 2/4)
2025-11-03 15:52:33,964 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:52:33,965 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:33,992 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 289.9715 (accum_step 3/4)
2025-11-03 15:52:34,026 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:52:36,105 - INFO -      [3] ‚úì Batch fetched in 2.079s
2025-11-03 15:52:36,340 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 287.7612 (accum_step 4/4)
2025-11-03 15:52:36,614 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:52:36,614 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:36,833 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 277.9603 (accum_step 1/4)
2025-11-03 15:52:37,093 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:52:37,093 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:37,121 - INFO -      [4] ‚úì Forward pass completed in 0.009s, loss = 282.7668 (accum_step 2/4)
2025-11-03 15:52:37,155 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:52:38,952 - INFO -      [4] ‚úì Batch fetched in 1.797s
2025-11-03 15:52:39,184 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 276.1534 (accum_step 3/4)
2025-11-03 15:52:39,445 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:52:39,445 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:39,664 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 278.7617 (accum_step 4/4)
2025-11-03 15:52:39,933 - INFO -   Step 5/10: loss = 278.9106, avg_loss = 288.3869, lr = 0.000011, grad_norm = 327.9622
2025-11-03 15:52:39,933 - INFO -     ‚è±Ô∏è  Timing: total=3.319s (fetch=1.798s, to_device=0.013s, spec_compute=0.003s, forward=0.029s, backward=0.046s, optim=0.009s)
2025-11-03 15:52:39,933 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:52:39,933 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:39,961 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 278.9864 (accum_step 1/4)
2025-11-03 15:52:39,995 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:52:41,475 - INFO -      [5] ‚úì Batch fetched in 1.479s
2025-11-03 15:52:41,694 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 269.0111 (accum_step 2/4)
2025-11-03 15:52:41,955 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:52:42,291 - INFO -      [5] ‚úì Batch fetched in 0.337s
2025-11-03 15:52:42,511 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 270.2460 (accum_step 3/4)
2025-11-03 15:52:42,772 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:52:42,772 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:42,800 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 273.2050 (accum_step 4/4)
2025-11-03 15:52:42,843 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:52:43,894 - INFO -      [6] ‚úì Batch fetched in 1.051s
2025-11-03 15:52:44,115 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 260.4124 (accum_step 1/4)
2025-11-03 15:52:44,375 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:52:44,737 - INFO -      [6] ‚úì Batch fetched in 0.363s
2025-11-03 15:52:44,952 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 260.0056 (accum_step 2/4)
2025-11-03 15:52:45,212 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:52:45,213 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:45,240 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 255.9822 (accum_step 3/4)
2025-11-03 15:52:45,274 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:52:46,636 - INFO -      [6] ‚úì Batch fetched in 1.362s
2025-11-03 15:52:46,851 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 257.3704 (accum_step 4/4)
2025-11-03 15:52:47,121 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:52:47,695 - INFO -      [7] ‚úì Batch fetched in 0.575s
2025-11-03 15:52:47,910 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 247.2447 (accum_step 1/4)
2025-11-03 15:52:48,170 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:52:48,170 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:48,198 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 255.1145 (accum_step 2/4)
2025-11-03 15:52:48,232 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:52:50,265 - INFO -      [7] ‚úì Batch fetched in 2.033s
2025-11-03 15:52:50,500 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 250.8889 (accum_step 3/4)
2025-11-03 15:52:50,761 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:52:50,761 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:50,980 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 251.7271 (accum_step 4/4)
2025-11-03 15:52:51,249 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:52:51,249 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:51,277 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 234.8783 (accum_step 1/4)
2025-11-03 15:52:51,310 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:52:53,406 - INFO -      [8] ‚úì Batch fetched in 2.095s
2025-11-03 15:52:53,641 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 237.7720 (accum_step 2/4)
2025-11-03 15:52:53,903 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:52:53,908 - INFO -      [8] ‚úì Batch fetched in 0.005s
2025-11-03 15:52:54,127 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 240.5869 (accum_step 3/4)
2025-11-03 15:52:54,389 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:52:54,389 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:54,416 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 233.1841 (accum_step 4/4)
2025-11-03 15:52:54,460 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:52:56,498 - INFO -      [9] ‚úì Batch fetched in 2.039s
2025-11-03 15:52:56,734 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 225.6151 (accum_step 1/4)
2025-11-03 15:52:56,993 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:52:56,996 - INFO -      [9] ‚úì Batch fetched in 0.003s
2025-11-03 15:52:57,216 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 227.8803 (accum_step 2/4)
2025-11-03 15:52:57,476 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:52:57,476 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:52:57,503 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.6576 (accum_step 3/4)
2025-11-03 15:52:57,537 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:52:59,764 - INFO -      [9] ‚úì Batch fetched in 2.227s
2025-11-03 15:52:59,991 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.3511 (accum_step 4/4)
2025-11-03 15:53:00,261 - INFO -   Step 10/10: loss = 226.6260, avg_loss = 268.7714, lr = 0.000021, grad_norm = 279.5520
2025-11-03 15:53:00,261 - INFO -     ‚è±Ô∏è  Timing: total=5.801s (fetch=4.269s, to_device=0.015s, spec_compute=0.003s, forward=0.028s, backward=0.049s, optim=0.009s)
2025-11-03 15:53:00,261 - INFO - 
================================================================================
2025-11-03 15:53:00,261 - INFO - TRAINING SUMMARY:
2025-11-03 15:53:00,261 - INFO -   Steps Completed: 10
2025-11-03 15:53:00,261 - INFO -   Average Loss: 268.7714
2025-11-03 15:53:00,261 - INFO -   Best Validation Loss: inf
2025-11-03 15:53:00,261 - INFO - ================================================================================
2025-11-03 15:53:00,261 - INFO - 
================================================================================
2025-11-03 15:53:00,261 - INFO - TRAINING COMPLETED
2025-11-03 15:53:00,261 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:53:00,261 - INFO - Final step: 10
2025-11-03 15:53:00,261 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 15:53:00,261 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:53:00,261 - INFO - ================================================================================
2025-11-03 15:53:34,842 - INFO - ================================================================================
2025-11-03 15:53:34,842 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 15:53:34,842 - INFO - ================================================================================
2025-11-03 15:53:34,843 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:53:34,843 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:53:34,843 - INFO - ================================================================================
2025-11-03 15:53:34,844 - INFO - Device: cuda
2025-11-03 15:53:34,844 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 15:53:34,844 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 15:53:34,844 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 15:53:34,844 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 15:53:34,844 - INFO -   Batch size: 128, Steps: 10
2025-11-03 15:53:34,844 - INFO -   Validation interval: 20 steps
2025-11-03 15:53:34,844 - INFO -   Log interval: 5 steps
2025-11-03 15:53:34,844 - INFO - 
Initializing model...
2025-11-03 15:53:35,404 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 15:53:35,405 - INFO -   Total parameters: 44,674,663
2025-11-03 15:53:35,405 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 15:53:38,429 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 15:53:38,430 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 15:53:38,438 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 15:53:38,438 - INFO - 
Setting up datasets...
2025-11-03 15:53:38,438 - INFO -   Loading MAESTRO dataset...
2025-11-03 15:53:38,442 - INFO -   ‚úì MAESTRO train: 20 samples (cached)
2025-11-03 15:53:38,443 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 15:53:38,443 - INFO -   Loading SLAKH stems dataset...
2025-11-03 15:53:39,115 - INFO -   ‚úì SLAKH stems train: 209 samples (cached)
2025-11-03 15:53:39,572 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 15:53:39,573 - INFO -   Loading SLAKH mix dataset...
2025-11-03 15:53:39,626 - INFO -   ‚úì SLAKH mix train: 20 samples (cached)
2025-11-03 15:53:39,677 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 15:53:39,677 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 15:53:39,736 - INFO -   ‚úì SLAKH mixed train: 20 samples (cached)
2025-11-03 15:53:39,785 - INFO -   ‚úì SLAKH mixed val: 20 samples (cached)
2025-11-03 15:53:39,785 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 15:53:39,785 - INFO -   Warming train cache for maestro dataset before forking workers...
2025-11-03 15:53:40,041 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 15:53:40,871 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 15:53:42,495 - INFO -   Warming validation cache for maestro dataset before forking workers...
2025-11-03 15:53:42,786 - INFO -   Warming validation cache for slakh_stems dataset before forking workers...
2025-11-03 15:53:44,317 - INFO -   Warming validation cache for slakh_mix dataset before forking workers...
2025-11-03 15:53:45,841 - INFO - 
  Creating multi-task dataset...
2025-11-03 15:53:45,841 - INFO -   ‚úì Multi-task dataset: 269 total samples
2025-11-03 15:53:45,841 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 15:53:45,841 - INFO - 
  Setting up validation data...
2025-11-03 15:53:45,841 - INFO -   ‚úì Validation: 267 samples
2025-11-03 15:53:45,843 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 15:53:45,843 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 15:53:45,843 - INFO -   Label smoothing: 0.1
2025-11-03 15:53:45,843 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 15:53:45,843 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 15:53:45,843 - INFO - 
Starting training...
2025-11-03 15:53:45,843 - INFO -   Total steps: 10
2025-11-03 15:53:45,843 - INFO -   Batch size: 128
2025-11-03 15:53:45,843 - INFO -   Learning rate: 0.0001
2025-11-03 15:53:45,843 - INFO -   Weight decay: 0.1
2025-11-03 15:53:45,843 - INFO -   Log interval: 5 steps
2025-11-03 15:53:45,843 - INFO -   Validation interval: 20 steps
2025-11-03 15:53:45,843 - INFO -   Save interval: 100 steps
2025-11-03 15:53:45,844 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 15:53:45,917 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 15:53:45,917 - INFO - 
================================================================================
2025-11-03 15:53:45,917 - INFO - STEP-BASED TRAINING
2025-11-03 15:53:45,917 - INFO -   Starting from step: 0
2025-11-03 15:53:45,917 - INFO -   Target steps: 10
2025-11-03 15:53:45,917 - INFO -   Batch size: 128
2025-11-03 15:53:45,917 - INFO -   Gradient accumulation steps: 4
2025-11-03 15:53:45,917 - INFO -   Effective batch size: 512
2025-11-03 15:53:45,917 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 15:53:45,917 - INFO - ================================================================================
2025-11-03 15:53:45,917 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 15:53:45,917 - INFO - 
üöÄ Starting training loop...
2025-11-03 15:53:45,917 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 15:53:45,917 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:53:50,107 - INFO -      [0] ‚úì Batch fetched in 4.190s
2025-11-03 15:53:50,108 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:53:50,114 - INFO -      [0] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:53:50,660 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.546s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:53:50,660 - INFO -      [0] Starting forward pass...
2025-11-03 15:53:53,515 - INFO -      [0] ‚úì Forward pass completed in 2.854s, loss = 290.8715 (accum_step 1/4)
2025-11-03 15:53:53,515 - INFO -      [0] Starting backward pass...
2025-11-03 15:53:53,832 - INFO -      [0] ‚úì Backward pass completed in 0.317s
2025-11-03 15:53:53,853 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:53:53,853 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:53:53,853 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:53:53,860 - INFO -      [0] ‚úì Data moved to device in 0.007s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:53:53,861 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:53:53,861 - INFO -      [0] Starting forward pass...
2025-11-03 15:53:54,074 - INFO -      [0] ‚úì Forward pass completed in 0.011s, loss = 296.6625 (accum_step 2/4)
2025-11-03 15:53:54,074 - INFO -      [0] Starting backward pass...
2025-11-03 15:53:54,188 - INFO -      [0] ‚úì Backward pass completed in 0.114s
2025-11-03 15:53:54,415 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:53:54,415 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:53:54,415 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:53:54,416 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:53:54,418 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.002s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:53:54,418 - INFO -      [0] Starting forward pass...
2025-11-03 15:53:57,136 - INFO -      [0] ‚úì Forward pass completed in 2.709s, loss = 289.0909 (accum_step 3/4)
2025-11-03 15:53:57,136 - INFO -      [0] Starting backward pass...
2025-11-03 15:53:57,215 - INFO -      [0] ‚úì Backward pass completed in 0.078s
2025-11-03 15:53:57,215 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:53:59,909 - INFO -      [0] ‚úì Batch fetched in 2.694s
2025-11-03 15:53:59,910 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:53:59,911 - INFO -      [0] ‚úì Data moved to device in 0.002s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:53:59,912 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:53:59,912 - INFO -      [0] Starting forward pass...
2025-11-03 15:54:00,125 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 291.3250 (accum_step 4/4)
2025-11-03 15:54:00,125 - INFO -      [0] Starting backward pass...
2025-11-03 15:54:00,138 - INFO -      [0] ‚úì Backward pass completed in 0.013s
2025-11-03 15:54:00,385 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 15:54:00,496 - INFO -      [0] ‚úì Optimizer step completed in 0.110s, grad_norm = 324.0614
2025-11-03 15:54:00,496 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:54:00,496 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:00,496 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:54:00,499 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:54:00,500 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:54:00,500 - INFO -      [1] Starting forward pass...
2025-11-03 15:54:00,713 - INFO -      [1] ‚úì Forward pass completed in 0.039s, loss = 289.2750 (accum_step 1/4)
2025-11-03 15:54:00,713 - INFO -      [1] Starting backward pass...
2025-11-03 15:54:00,730 - INFO -      [1] ‚úì Backward pass completed in 0.017s
2025-11-03 15:54:00,981 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:54:00,981 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:00,981 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:54:00,984 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:54:00,985 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:54:00,985 - INFO -      [1] Starting forward pass...
2025-11-03 15:54:01,012 - INFO -      [1] ‚úì Forward pass completed in 0.014s, loss = 286.6449 (accum_step 2/4)
2025-11-03 15:54:01,012 - INFO -      [1] Starting backward pass...
2025-11-03 15:54:01,028 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 15:54:01,046 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:54:03,197 - INFO -      [1] ‚úì Batch fetched in 2.151s
2025-11-03 15:54:03,198 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:54:03,203 - INFO -      [1] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:54:03,204 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:54:03,204 - INFO -      [1] Starting forward pass...
2025-11-03 15:54:03,417 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 295.4645 (accum_step 3/4)
2025-11-03 15:54:03,417 - INFO -      [1] Starting backward pass...
2025-11-03 15:54:03,433 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 15:54:03,680 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:54:03,680 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:03,681 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:54:03,687 - INFO -      [1] ‚úì Data moved to device in 0.006s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:54:03,687 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:54:03,687 - INFO -      [1] Starting forward pass...
2025-11-03 15:54:03,900 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 291.9830 (accum_step 4/4)
2025-11-03 15:54:03,900 - INFO -      [1] Starting backward pass...
2025-11-03 15:54:03,911 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 15:54:04,160 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 15:54:04,170 - INFO -      [1] ‚úì Optimizer step completed in 0.010s, grad_norm = 323.6697
2025-11-03 15:54:04,170 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:54:04,170 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:04,170 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:54:04,171 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:54:04,172 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:54:04,172 - INFO -      [2] Starting forward pass...
2025-11-03 15:54:04,198 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 294.6190 (accum_step 1/4)
2025-11-03 15:54:04,198 - INFO -      [2] Starting backward pass...
2025-11-03 15:54:04,209 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 15:54:04,231 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:54:05,940 - INFO -      [2] ‚úì Batch fetched in 1.709s
2025-11-03 15:54:05,940 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:54:05,942 - INFO -      [2] ‚úì Data moved to device in 0.002s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:54:05,943 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:54:05,943 - INFO -      [2] Starting forward pass...
2025-11-03 15:54:06,156 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.0400 (accum_step 2/4)
2025-11-03 15:54:06,156 - INFO -      [2] Starting backward pass...
2025-11-03 15:54:06,167 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 15:54:06,417 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:54:06,417 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:06,417 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:54:06,422 - INFO -      [2] ‚úì Data moved to device in 0.005s (frames: torch.Size([128, 256, 128]), targets: torch.Size([128, 1024]))
2025-11-03 15:54:06,422 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([128, 256, 512]))
2025-11-03 15:54:06,422 - INFO -      [2] Starting forward pass...
2025-11-03 15:54:06,635 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.8476 (accum_step 3/4)
2025-11-03 15:54:06,635 - INFO -      [2] Starting backward pass...
2025-11-03 15:54:06,646 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 15:54:06,895 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:54:06,896 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:06,896 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:54:06,896 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:54:06,897 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:54:06,897 - INFO -      [2] Starting forward pass...
2025-11-03 15:54:06,923 - INFO -      [2] ‚úì Forward pass completed in 0.008s, loss = 298.4497 (accum_step 4/4)
2025-11-03 15:54:06,923 - INFO -      [2] Starting backward pass...
2025-11-03 15:54:06,935 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 15:54:06,957 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 15:54:06,966 - INFO -      [2] ‚úì Optimizer step completed in 0.009s, grad_norm = 331.3848
2025-11-03 15:54:06,966 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:54:08,856 - INFO -      [3] ‚úì Batch fetched in 1.889s
2025-11-03 15:54:09,085 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 289.4941 (accum_step 1/4)
2025-11-03 15:54:09,345 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:54:09,506 - INFO -      [3] ‚úì Batch fetched in 0.161s
2025-11-03 15:54:09,725 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 283.5953 (accum_step 2/4)
2025-11-03 15:54:09,985 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:54:09,985 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:10,012 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 289.9717 (accum_step 3/4)
2025-11-03 15:54:10,046 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:54:12,226 - INFO -      [3] ‚úì Batch fetched in 2.180s
2025-11-03 15:54:12,441 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 287.7612 (accum_step 4/4)
2025-11-03 15:54:12,711 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:54:12,711 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:12,925 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 277.9601 (accum_step 1/4)
2025-11-03 15:54:13,184 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:54:13,185 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:13,212 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 282.7670 (accum_step 2/4)
2025-11-03 15:54:13,246 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:54:15,075 - INFO -      [4] ‚úì Batch fetched in 1.830s
2025-11-03 15:54:15,291 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 276.1534 (accum_step 3/4)
2025-11-03 15:54:15,551 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:54:15,551 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:15,765 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 278.7615 (accum_step 4/4)
2025-11-03 15:54:16,034 - INFO -   Step 5/10: loss = 278.9105, avg_loss = 288.3869, lr = 0.000011, grad_norm = 327.9622
2025-11-03 15:54:16,034 - INFO -     ‚è±Ô∏è  Timing: total=3.323s (fetch=1.830s, to_device=0.004s, spec_compute=0.002s, forward=0.027s, backward=0.045s, optim=0.009s)
2025-11-03 15:54:16,034 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:54:16,034 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:16,061 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 278.9862 (accum_step 1/4)
2025-11-03 15:54:16,094 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:54:17,709 - INFO -      [5] ‚úì Batch fetched in 1.615s
2025-11-03 15:54:17,924 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 269.0111 (accum_step 2/4)
2025-11-03 15:54:18,184 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:54:18,555 - INFO -      [5] ‚úì Batch fetched in 0.370s
2025-11-03 15:54:18,773 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 270.2458 (accum_step 3/4)
2025-11-03 15:54:19,034 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:54:19,034 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:19,061 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 273.2043 (accum_step 4/4)
2025-11-03 15:54:19,103 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:54:20,497 - INFO -      [6] ‚úì Batch fetched in 1.394s
2025-11-03 15:54:20,712 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 260.4123 (accum_step 1/4)
2025-11-03 15:54:20,972 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:54:21,064 - INFO -      [6] ‚úì Batch fetched in 0.092s
2025-11-03 15:54:21,283 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 260.0057 (accum_step 2/4)
2025-11-03 15:54:21,543 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:54:21,543 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:21,571 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 255.9815 (accum_step 3/4)
2025-11-03 15:54:21,604 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:54:23,127 - INFO -      [6] ‚úì Batch fetched in 1.523s
2025-11-03 15:54:23,342 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 257.3706 (accum_step 4/4)
2025-11-03 15:54:23,613 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:54:24,120 - INFO -      [7] ‚úì Batch fetched in 0.506s
2025-11-03 15:54:24,338 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 247.2451 (accum_step 1/4)
2025-11-03 15:54:24,598 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:54:24,598 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:24,626 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 255.1147 (accum_step 2/4)
2025-11-03 15:54:24,660 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:54:26,905 - INFO -      [7] ‚úì Batch fetched in 2.245s
2025-11-03 15:54:27,119 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 250.8890 (accum_step 3/4)
2025-11-03 15:54:27,379 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:54:27,380 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:27,593 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.7272 (accum_step 4/4)
2025-11-03 15:54:27,863 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:54:27,863 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:27,890 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 234.8784 (accum_step 1/4)
2025-11-03 15:54:27,923 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:54:30,223 - INFO -      [8] ‚úì Batch fetched in 2.300s
2025-11-03 15:54:30,439 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 237.7720 (accum_step 2/4)
2025-11-03 15:54:30,699 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:54:30,736 - INFO -      [8] ‚úì Batch fetched in 0.037s
2025-11-03 15:54:30,955 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 240.5869 (accum_step 3/4)
2025-11-03 15:54:31,216 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:54:31,216 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:31,244 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 233.1837 (accum_step 4/4)
2025-11-03 15:54:31,286 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:54:33,663 - INFO -      [9] ‚úì Batch fetched in 2.377s
2025-11-03 15:54:33,879 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 225.6152 (accum_step 1/4)
2025-11-03 15:54:34,138 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:54:34,138 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:34,357 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 227.8802 (accum_step 2/4)
2025-11-03 15:54:34,617 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:54:34,617 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:54:34,644 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 226.6576 (accum_step 3/4)
2025-11-03 15:54:34,678 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:54:37,225 - INFO -      [9] ‚úì Batch fetched in 2.547s
2025-11-03 15:54:37,444 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.3513 (accum_step 4/4)
2025-11-03 15:54:37,714 - INFO -   Step 10/10: loss = 226.6261, avg_loss = 268.7714, lr = 0.000021, grad_norm = 279.5520
2025-11-03 15:54:37,715 - INFO -     ‚è±Ô∏è  Timing: total=6.428s (fetch=4.925s, to_device=0.013s, spec_compute=0.003s, forward=0.027s, backward=0.051s, optim=0.009s)
2025-11-03 15:54:37,715 - INFO - 
================================================================================
2025-11-03 15:54:37,715 - INFO - TRAINING SUMMARY:
2025-11-03 15:54:37,715 - INFO -   Steps Completed: 10
2025-11-03 15:54:37,715 - INFO -   Average Loss: 268.7714
2025-11-03 15:54:37,715 - INFO -   Best Validation Loss: inf
2025-11-03 15:54:37,715 - INFO - ================================================================================
2025-11-03 15:54:37,715 - INFO - 
================================================================================
2025-11-03 15:54:37,715 - INFO - TRAINING COMPLETED
2025-11-03 15:54:37,715 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:54:37,715 - INFO - Final step: 10
2025-11-03 15:54:37,715 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 15:54:37,715 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:54:37,715 - INFO - ================================================================================
2025-11-03 15:55:02,612 - INFO - ================================================================================
2025-11-03 15:55:02,612 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 15:55:02,612 - INFO - ================================================================================
2025-11-03 15:55:02,612 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:55:02,612 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:55:02,612 - INFO - ================================================================================
2025-11-03 15:55:02,614 - INFO - Device: cuda
2025-11-03 15:55:02,614 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 15:55:02,614 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 15:55:02,614 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 15:55:02,614 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 15:55:02,614 - INFO -   Batch size: 256, Steps: 10
2025-11-03 15:55:02,614 - INFO -   Validation interval: 20 steps
2025-11-03 15:55:02,614 - INFO -   Log interval: 5 steps
2025-11-03 15:55:02,614 - INFO - 
Initializing model...
2025-11-03 15:55:03,113 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 15:55:03,114 - INFO -   Total parameters: 44,674,663
2025-11-03 15:55:03,114 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 15:55:06,155 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 15:55:06,155 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 15:55:06,164 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 15:55:06,164 - INFO - 
Setting up datasets...
2025-11-03 15:55:06,164 - INFO -   Loading MAESTRO dataset...
2025-11-03 15:55:06,168 - INFO -   ‚úì MAESTRO train: 20 samples (cached)
2025-11-03 15:55:06,169 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 15:55:06,169 - INFO -   Loading SLAKH stems dataset...
2025-11-03 15:55:06,876 - INFO -   ‚úì SLAKH stems train: 209 samples (cached)
2025-11-03 15:55:07,291 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 15:55:07,291 - INFO -   Loading SLAKH mix dataset...
2025-11-03 15:55:07,350 - INFO -   ‚úì SLAKH mix train: 20 samples (cached)
2025-11-03 15:55:07,404 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 15:55:07,404 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 15:55:07,460 - INFO -   ‚úì SLAKH mixed train: 20 samples (cached)
2025-11-03 15:55:07,520 - INFO -   ‚úì SLAKH mixed val: 20 samples (cached)
2025-11-03 15:55:07,520 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 15:55:07,520 - INFO -   Warming train cache for maestro dataset before forking workers...
2025-11-03 15:55:07,771 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 15:55:08,575 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 15:55:10,251 - INFO -   Warming validation cache for maestro dataset before forking workers...
2025-11-03 15:55:10,546 - INFO -   Warming validation cache for slakh_stems dataset before forking workers...
2025-11-03 15:55:12,087 - INFO -   Warming validation cache for slakh_mix dataset before forking workers...
2025-11-03 15:55:13,636 - INFO - 
  Creating multi-task dataset...
2025-11-03 15:55:13,637 - INFO -   ‚úì Multi-task dataset: 269 total samples
2025-11-03 15:55:13,637 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 15:55:13,637 - INFO - 
  Setting up validation data...
2025-11-03 15:55:13,637 - INFO -   ‚úì Validation: 267 samples
2025-11-03 15:55:13,639 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 15:55:13,639 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 15:55:13,639 - INFO -   Label smoothing: 0.1
2025-11-03 15:55:13,639 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 15:55:13,639 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 15:55:13,639 - INFO - 
Starting training...
2025-11-03 15:55:13,639 - INFO -   Total steps: 10
2025-11-03 15:55:13,639 - INFO -   Batch size: 256
2025-11-03 15:55:13,639 - INFO -   Learning rate: 0.0001
2025-11-03 15:55:13,639 - INFO -   Weight decay: 0.1
2025-11-03 15:55:13,639 - INFO -   Log interval: 5 steps
2025-11-03 15:55:13,639 - INFO -   Validation interval: 20 steps
2025-11-03 15:55:13,639 - INFO -   Save interval: 100 steps
2025-11-03 15:55:13,640 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 15:55:13,700 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 15:55:13,700 - INFO - 
================================================================================
2025-11-03 15:55:13,700 - INFO - STEP-BASED TRAINING
2025-11-03 15:55:13,700 - INFO -   Starting from step: 0
2025-11-03 15:55:13,700 - INFO -   Target steps: 10
2025-11-03 15:55:13,700 - INFO -   Batch size: 256
2025-11-03 15:55:13,700 - INFO -   Gradient accumulation steps: 4
2025-11-03 15:55:13,700 - INFO -   Effective batch size: 1024
2025-11-03 15:55:13,700 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 15:55:13,700 - INFO - ================================================================================
2025-11-03 15:55:13,700 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 15:55:13,700 - INFO - 
üöÄ Starting training loop...
2025-11-03 15:55:13,700 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 15:55:13,700 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:55:20,913 - INFO -      [0] ‚úì Batch fetched in 7.213s
2025-11-03 15:55:20,914 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:55:20,922 - INFO -      [0] ‚úì Data moved to device in 0.008s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 15:55:21,330 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.408s (shape: torch.Size([256, 256, 512]))
2025-11-03 15:55:21,330 - INFO -      [0] Starting forward pass...
2025-11-03 15:55:40,342 - INFO -      [0] ‚úì Forward pass completed in 19.011s, loss = 291.1472 (accum_step 1/4)
2025-11-03 15:55:40,342 - INFO -      [0] Starting backward pass...
2025-11-03 15:55:47,809 - INFO -      [0] ‚úì Backward pass completed in 7.467s
2025-11-03 15:55:47,837 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:55:47,837 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:55:47,838 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:55:47,838 - INFO -      [0] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:55:47,840 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.002s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:55:47,840 - INFO -      [0] Starting forward pass...
2025-11-03 15:55:50,564 - INFO -      [0] ‚úì Forward pass completed in 2.718s, loss = 300.3485 (accum_step 2/4)
2025-11-03 15:55:50,567 - INFO -      [0] Starting backward pass...
2025-11-03 15:55:50,647 - INFO -      [0] ‚úì Backward pass completed in 0.080s
2025-11-03 15:55:50,647 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:55:54,184 - INFO -      [0] ‚úì Batch fetched in 3.536s
2025-11-03 15:55:54,184 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:55:54,186 - INFO -      [0] ‚úì Data moved to device in 0.002s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 15:55:54,187 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 15:55:54,187 - INFO -      [0] Starting forward pass...
2025-11-03 15:55:54,624 - INFO -      [0] ‚úì Forward pass completed in 0.008s, loss = 293.9424 (accum_step 3/4)
2025-11-03 15:55:54,625 - INFO -      [0] Starting backward pass...
2025-11-03 15:55:54,639 - INFO -      [0] ‚úì Backward pass completed in 0.014s
2025-11-03 15:55:55,138 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:55:55,138 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:55:55,138 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:55:55,139 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:55:55,140 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:55:55,140 - INFO -      [0] Starting forward pass...
2025-11-03 15:55:55,166 - INFO -      [0] ‚úì Forward pass completed in 0.009s, loss = 292.1336 (accum_step 4/4)
2025-11-03 15:55:55,166 - INFO -      [0] Starting backward pass...
2025-11-03 15:55:55,178 - INFO -      [0] ‚úì Backward pass completed in 0.012s
2025-11-03 15:55:55,199 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 15:55:55,327 - INFO -      [0] ‚úì Optimizer step completed in 0.127s, grad_norm = 326.7719
2025-11-03 15:55:55,327 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:55:58,979 - INFO -      [1] ‚úì Batch fetched in 3.652s
2025-11-03 15:55:58,980 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:55:58,987 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 15:55:59,004 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.017s (shape: torch.Size([256, 256, 512]))
2025-11-03 15:55:59,004 - INFO -      [1] Starting forward pass...
2025-11-03 15:55:59,447 - INFO -      [1] ‚úì Forward pass completed in 0.041s, loss = 295.6740 (accum_step 1/4)
2025-11-03 15:55:59,447 - INFO -      [1] Starting backward pass...
2025-11-03 15:55:59,462 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 15:55:59,960 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:55:59,960 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:55:59,960 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:55:59,960 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:55:59,961 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:55:59,961 - INFO -      [1] Starting forward pass...
2025-11-03 15:55:59,987 - INFO -      [1] ‚úì Forward pass completed in 0.010s, loss = 304.1190 (accum_step 2/4)
2025-11-03 15:55:59,987 - INFO -      [1] Starting backward pass...
2025-11-03 15:56:00,004 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 15:56:00,021 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:56:03,158 - INFO -      [1] ‚úì Batch fetched in 3.136s
2025-11-03 15:56:03,158 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:56:03,166 - INFO -      [1] ‚úì Data moved to device in 0.008s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 15:56:03,167 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 15:56:03,167 - INFO -      [1] Starting forward pass...
2025-11-03 15:56:03,615 - INFO -      [1] ‚úì Forward pass completed in 0.008s, loss = 289.3441 (accum_step 3/4)
2025-11-03 15:56:03,615 - INFO -      [1] Starting backward pass...
2025-11-03 15:56:03,630 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 15:56:04,129 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:56:04,130 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:56:04,130 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:56:04,131 - INFO -      [1] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:56:04,132 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:56:04,132 - INFO -      [1] Starting forward pass...
2025-11-03 15:56:04,158 - INFO -      [1] ‚úì Forward pass completed in 0.008s, loss = 306.0599 (accum_step 4/4)
2025-11-03 15:56:04,158 - INFO -      [1] Starting backward pass...
2025-11-03 15:56:04,171 - INFO -      [1] ‚úì Backward pass completed in 0.013s
2025-11-03 15:56:04,192 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 15:56:04,202 - INFO -      [1] ‚úì Optimizer step completed in 0.010s, grad_norm = 332.1068
2025-11-03 15:56:04,203 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:56:06,586 - INFO -      [2] ‚úì Batch fetched in 2.384s
2025-11-03 15:56:06,587 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:56:06,589 - INFO -      [2] ‚úì Data moved to device in 0.002s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 15:56:06,589 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 15:56:06,590 - INFO -      [2] Starting forward pass...
2025-11-03 15:56:07,033 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 286.4580 (accum_step 1/4)
2025-11-03 15:56:07,033 - INFO -      [2] Starting backward pass...
2025-11-03 15:56:07,046 - INFO -      [2] ‚úì Backward pass completed in 0.013s
2025-11-03 15:56:07,546 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:56:07,546 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:56:07,546 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:56:07,547 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:56:07,548 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:56:07,548 - INFO -      [2] Starting forward pass...
2025-11-03 15:56:07,574 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 285.5693 (accum_step 2/4)
2025-11-03 15:56:07,574 - INFO -      [2] Starting backward pass...
2025-11-03 15:56:07,586 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 15:56:07,608 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:56:11,829 - INFO -      [2] ‚úì Batch fetched in 4.221s
2025-11-03 15:56:11,829 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:56:11,837 - INFO -      [2] ‚úì Data moved to device in 0.008s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 15:56:11,838 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 15:56:11,838 - INFO -      [2] Starting forward pass...
2025-11-03 15:56:12,281 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.9675 (accum_step 3/4)
2025-11-03 15:56:12,281 - INFO -      [2] Starting backward pass...
2025-11-03 15:56:12,293 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 15:56:12,793 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:56:12,794 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:56:12,794 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:56:12,795 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:56:12,796 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:56:12,796 - INFO -      [2] Starting forward pass...
2025-11-03 15:56:12,822 - INFO -      [2] ‚úì Forward pass completed in 0.009s, loss = 284.7725 (accum_step 4/4)
2025-11-03 15:56:12,822 - INFO -      [2] Starting backward pass...
2025-11-03 15:56:12,834 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 15:56:12,855 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 15:56:12,865 - INFO -      [2] ‚úì Optimizer step completed in 0.010s, grad_norm = 324.2001
2025-11-03 15:56:12,865 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:56:17,317 - INFO -      [3] ‚úì Batch fetched in 4.452s
2025-11-03 15:56:17,767 - INFO -      [3] ‚úì Forward pass completed in 0.009s, loss = 285.3671 (accum_step 1/4)
2025-11-03 15:56:18,280 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:56:18,280 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:56:18,307 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 290.2542 (accum_step 2/4)
2025-11-03 15:56:18,341 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:56:22,994 - INFO -      [3] ‚úì Batch fetched in 4.653s
2025-11-03 15:56:23,431 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 283.4201 (accum_step 3/4)
2025-11-03 15:56:23,944 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:56:23,945 - INFO -      [3] ‚úì Batch fetched in 0.001s
2025-11-03 15:56:23,973 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 287.2069 (accum_step 4/4)
2025-11-03 15:56:24,016 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:56:27,744 - INFO -      [4] ‚úì Batch fetched in 3.728s
2025-11-03 15:56:28,196 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 279.1797 (accum_step 1/4)
2025-11-03 15:56:28,708 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:56:28,708 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:56:28,736 - INFO -      [4] ‚úì Forward pass completed in 0.008s, loss = 281.6134 (accum_step 2/4)
2025-11-03 15:56:28,770 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:56:32,881 - INFO -      [4] ‚úì Batch fetched in 4.111s
2025-11-03 15:56:33,319 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 276.7734 (accum_step 3/4)
2025-11-03 15:56:33,833 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:56:33,833 - INFO -      [4] ‚úì Batch fetched in 0.001s
2025-11-03 15:56:33,861 - INFO -      [4] ‚úì Forward pass completed in 0.009s, loss = 282.5692 (accum_step 4/4)
2025-11-03 15:56:33,905 - INFO -   Step 5/10: loss = 280.0340, avg_loss = 289.2460, lr = 0.000011, grad_norm = 330.5102
2025-11-03 15:56:33,905 - INFO -     ‚è±Ô∏è  Timing: total=9.889s (fetch=7.839s, to_device=0.016s, spec_compute=0.003s, forward=0.030s, backward=0.048s, optim=0.010s)
2025-11-03 15:56:33,905 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:56:37,929 - INFO -      [5] ‚úì Batch fetched in 4.024s
2025-11-03 15:56:38,379 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 272.9545 (accum_step 1/4)
2025-11-03 15:56:38,893 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:56:38,894 - INFO -      [5] ‚úì Batch fetched in 0.001s
2025-11-03 15:56:38,922 - INFO -      [5] ‚úì Forward pass completed in 0.010s, loss = 283.3611 (accum_step 2/4)
2025-11-03 15:56:38,956 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:56:42,018 - INFO -      [5] ‚úì Batch fetched in 3.062s
2025-11-03 15:56:42,467 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 270.1338 (accum_step 3/4)
2025-11-03 15:56:42,981 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:56:42,982 - INFO -      [5] ‚úì Batch fetched in 0.001s
2025-11-03 15:56:43,010 - INFO -      [5] ‚úì Forward pass completed in 0.008s, loss = 255.4208 (accum_step 4/4)
2025-11-03 15:56:43,054 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:56:46,388 - INFO -      [6] ‚úì Batch fetched in 3.333s
2025-11-03 15:56:46,845 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 259.7195 (accum_step 1/4)
2025-11-03 15:56:47,359 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:56:47,361 - INFO -      [6] ‚úì Batch fetched in 0.002s
2025-11-03 15:56:47,389 - INFO -      [6] ‚úì Forward pass completed in 0.014s, loss = 247.9161 (accum_step 2/4)
2025-11-03 15:56:47,423 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:56:51,389 - INFO -      [6] ‚úì Batch fetched in 3.966s
2025-11-03 15:56:51,827 - INFO -      [6] ‚úì Forward pass completed in 0.008s, loss = 261.3833 (accum_step 3/4)
2025-11-03 15:56:52,339 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:56:52,340 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:56:52,367 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 262.4940 (accum_step 4/4)
2025-11-03 15:56:52,411 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:56:56,182 - INFO -      [7] ‚úì Batch fetched in 3.771s
2025-11-03 15:56:56,619 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.2453 (accum_step 1/4)
2025-11-03 15:56:57,131 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:56:57,131 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:56:57,158 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 248.8205 (accum_step 2/4)
2025-11-03 15:56:57,192 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:57:01,212 - INFO -      [7] ‚úì Batch fetched in 4.020s
2025-11-03 15:57:01,640 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.9443 (accum_step 3/4)
2025-11-03 15:57:02,152 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:57:02,153 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:57:02,180 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 236.6989 (accum_step 4/4)
2025-11-03 15:57:02,222 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:57:04,931 - INFO -      [8] ‚úì Batch fetched in 2.709s
2025-11-03 15:57:05,354 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 237.6670 (accum_step 1/4)
2025-11-03 15:57:05,866 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:57:05,866 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:57:05,894 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 241.5451 (accum_step 2/4)
2025-11-03 15:57:05,927 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:57:09,561 - INFO -      [8] ‚úì Batch fetched in 3.634s
2025-11-03 15:57:10,006 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 237.3576 (accum_step 3/4)
2025-11-03 15:57:10,519 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:57:10,519 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:57:10,547 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 243.5646 (accum_step 4/4)
2025-11-03 15:57:10,589 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 15:57:13,961 - INFO -      [9] ‚úì Batch fetched in 3.371s
2025-11-03 15:57:14,418 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 227.7019 (accum_step 1/4)
2025-11-03 15:57:14,931 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 15:57:14,931 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:57:14,958 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 228.8715 (accum_step 2/4)
2025-11-03 15:57:14,992 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 15:57:19,077 - INFO -      [9] ‚úì Batch fetched in 4.084s
2025-11-03 15:57:19,523 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 224.7783 (accum_step 3/4)
2025-11-03 15:57:20,036 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 15:57:20,036 - INFO -      [9] ‚úì Batch fetched in 0.001s
2025-11-03 15:57:20,064 - INFO -      [9] ‚úì Forward pass completed in 0.008s, loss = 224.1009 (accum_step 4/4)
2025-11-03 15:57:20,108 - INFO -   Step 10/10: loss = 226.3632, avg_loss = 268.7150, lr = 0.000021, grad_norm = 277.5062
2025-11-03 15:57:20,108 - INFO -     ‚è±Ô∏è  Timing: total=9.518s (fetch=7.457s, to_device=0.018s, spec_compute=0.003s, forward=0.029s, backward=0.045s, optim=0.010s)
2025-11-03 15:57:20,108 - INFO - 
================================================================================
2025-11-03 15:57:20,108 - INFO - TRAINING SUMMARY:
2025-11-03 15:57:20,108 - INFO -   Steps Completed: 10
2025-11-03 15:57:20,108 - INFO -   Average Loss: 268.7150
2025-11-03 15:57:20,108 - INFO -   Best Validation Loss: inf
2025-11-03 15:57:20,108 - INFO - ================================================================================
2025-11-03 15:57:20,108 - INFO - 
================================================================================
2025-11-03 15:57:20,108 - INFO - TRAINING COMPLETED
2025-11-03 15:57:20,108 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:57:20,109 - INFO - Final step: 10
2025-11-03 15:57:20,109 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 15:57:20,109 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:57:20,109 - INFO - ================================================================================
2025-11-03 15:57:33,094 - INFO - ================================================================================
2025-11-03 15:57:33,095 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 15:57:33,095 - INFO - ================================================================================
2025-11-03 15:57:33,095 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:57:33,095 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:57:33,095 - INFO - ================================================================================
2025-11-03 15:57:33,096 - INFO - Device: cuda
2025-11-03 15:57:33,096 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 15:57:33,096 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 15:57:33,096 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 15:57:33,096 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 15:57:33,096 - INFO -   Batch size: 64, Steps: 10
2025-11-03 15:57:33,097 - INFO -   Validation interval: 20 steps
2025-11-03 15:57:33,097 - INFO -   Log interval: 5 steps
2025-11-03 15:57:33,097 - INFO - 
Initializing model...
2025-11-03 15:57:33,688 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 15:57:33,689 - INFO -   Total parameters: 44,674,663
2025-11-03 15:57:33,689 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 15:57:36,786 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 15:57:36,786 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 15:57:36,795 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 15:57:36,795 - INFO - 
Setting up datasets...
2025-11-03 15:57:36,795 - INFO -   Loading MAESTRO dataset...
2025-11-03 15:57:36,800 - INFO -   ‚úì MAESTRO train: 20 samples (cached)
2025-11-03 15:57:36,801 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 15:57:36,801 - INFO -   Loading SLAKH stems dataset...
2025-11-03 15:57:37,457 - INFO -   ‚úì SLAKH stems train: 209 samples (cached)
2025-11-03 15:57:37,870 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 15:57:37,870 - INFO -   Loading SLAKH mix dataset...
2025-11-03 15:57:37,932 - INFO -   ‚úì SLAKH mix train: 20 samples (cached)
2025-11-03 15:57:37,991 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 15:57:37,991 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 15:57:38,050 - INFO -   ‚úì SLAKH mixed train: 20 samples (cached)
2025-11-03 15:57:38,112 - INFO -   ‚úì SLAKH mixed val: 20 samples (cached)
2025-11-03 15:57:38,112 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 15:57:38,112 - INFO -   Warming train cache for maestro dataset before forking workers...
2025-11-03 15:57:38,373 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 15:57:39,241 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 15:57:40,875 - INFO -   Warming validation cache for maestro dataset before forking workers...
2025-11-03 15:57:41,171 - INFO -   Warming validation cache for slakh_stems dataset before forking workers...
2025-11-03 15:57:42,688 - INFO -   Warming validation cache for slakh_mix dataset before forking workers...
2025-11-03 15:57:44,219 - INFO - 
  Creating multi-task dataset...
2025-11-03 15:57:44,220 - INFO -   ‚úì Multi-task dataset: 269 total samples
2025-11-03 15:57:44,220 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 15:57:44,220 - INFO - 
  Setting up validation data...
2025-11-03 15:57:44,220 - INFO -   ‚úì Validation: 267 samples
2025-11-03 15:57:44,221 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 15:57:44,221 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 15:57:44,221 - INFO -   Label smoothing: 0.1
2025-11-03 15:57:44,222 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 15:57:44,222 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 15:57:44,222 - INFO - 
Starting training...
2025-11-03 15:57:44,222 - INFO -   Total steps: 10
2025-11-03 15:57:44,222 - INFO -   Batch size: 64
2025-11-03 15:57:44,222 - INFO -   Learning rate: 0.0001
2025-11-03 15:57:44,222 - INFO -   Weight decay: 0.1
2025-11-03 15:57:44,222 - INFO -   Log interval: 5 steps
2025-11-03 15:57:44,222 - INFO -   Validation interval: 20 steps
2025-11-03 15:57:44,222 - INFO -   Save interval: 100 steps
2025-11-03 15:57:44,223 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 15:57:44,279 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 15:57:44,279 - INFO - 
================================================================================
2025-11-03 15:57:44,279 - INFO - STEP-BASED TRAINING
2025-11-03 15:57:44,279 - INFO -   Starting from step: 0
2025-11-03 15:57:44,279 - INFO -   Target steps: 10
2025-11-03 15:57:44,279 - INFO -   Batch size: 64
2025-11-03 15:57:44,279 - INFO -   Gradient accumulation steps: 16
2025-11-03 15:57:44,279 - INFO -   Effective batch size: 1024
2025-11-03 15:57:44,279 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 15:57:44,279 - INFO - ================================================================================
2025-11-03 15:57:44,279 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 15:57:44,279 - INFO - 
üöÄ Starting training loop...
2025-11-03 15:57:44,280 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 15:57:44,280 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 15:57:46,815 - INFO -      [0] ‚úì Batch fetched in 2.535s
2025-11-03 15:57:46,815 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:57:46,819 - INFO -      [0] ‚úì Data moved to device in 0.004s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:57:47,096 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.277s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:57:47,096 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:04,304 - INFO -      [0] ‚úì Forward pass completed in 17.208s, loss = 293.0322 (accum_step 1/16)
2025-11-03 15:58:04,305 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:10,561 - INFO -      [0] ‚úì Backward pass completed in 6.257s
2025-11-03 15:58:10,568 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 15:58:10,568 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:10,568 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:10,572 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:10,573 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:10,573 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:10,680 - INFO -      [0] ‚úì Forward pass completed in 0.011s, loss = 298.1180 (accum_step 2/16)
2025-11-03 15:58:10,681 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:10,696 - INFO -      [0] ‚úì Backward pass completed in 0.015s
2025-11-03 15:58:10,815 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 15:58:10,815 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:10,815 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:10,815 - INFO -      [0] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:10,816 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:10,816 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:10,924 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 294.9651 (accum_step 3/16)
2025-11-03 15:58:10,924 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:10,935 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:11,058 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 15:58:11,058 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:11,058 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:11,061 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:11,062 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:11,062 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:11,170 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 287.0170 (accum_step 4/16)
2025-11-03 15:58:11,170 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:11,180 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:11,303 - INFO -      [0] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 15:58:11,304 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:11,304 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:11,304 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:58:11,306 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:58:11,306 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:13,961 - INFO -      [0] ‚úì Forward pass completed in 2.644s, loss = 285.8675 (accum_step 5/16)
2025-11-03 15:58:13,961 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:14,039 - INFO -      [0] ‚úì Backward pass completed in 0.077s
2025-11-03 15:58:14,039 - INFO -      [0] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 15:58:15,492 - INFO -      [0] ‚úì Batch fetched in 1.453s
2025-11-03 15:58:15,493 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:15,496 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:15,497 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:15,497 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:15,605 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 290.2938 (accum_step 6/16)
2025-11-03 15:58:15,605 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:15,618 - INFO -      [0] ‚úì Backward pass completed in 0.013s
2025-11-03 15:58:15,740 - INFO -      [0] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 15:58:15,834 - INFO -      [0] ‚úì Batch fetched in 0.094s
2025-11-03 15:58:15,834 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:15,834 - INFO -      [0] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:15,835 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:15,835 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:15,943 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 295.0726 (accum_step 7/16)
2025-11-03 15:58:15,943 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:15,954 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:16,077 - INFO -      [0] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 15:58:16,077 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:16,077 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:16,080 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:16,080 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:16,080 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:16,188 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 295.5228 (accum_step 8/16)
2025-11-03 15:58:16,188 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:16,198 - INFO -      [0] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:16,321 - INFO -      [0] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 15:58:16,321 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:16,321 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:16,324 - INFO -      [0] ‚úì Data moved to device in 0.002s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:16,324 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:16,324 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:16,432 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 291.4682 (accum_step 9/16)
2025-11-03 15:58:16,432 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:16,442 - INFO -      [0] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:16,565 - INFO -      [0] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 15:58:16,565 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:16,565 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:16,566 - INFO -      [0] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:58:16,566 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:58:16,566 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:16,592 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 301.5529 (accum_step 10/16)
2025-11-03 15:58:16,593 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:16,603 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:16,626 - INFO -      [0] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 15:58:18,503 - INFO -      [0] ‚úì Batch fetched in 1.877s
2025-11-03 15:58:18,504 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:18,507 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:18,508 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:18,508 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:18,621 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 290.1332 (accum_step 11/16)
2025-11-03 15:58:18,621 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:18,632 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:18,765 - INFO -      [0] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 15:58:18,765 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:18,765 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:18,765 - INFO -      [0] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:18,766 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:18,766 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:18,874 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 288.1637 (accum_step 12/16)
2025-11-03 15:58:18,874 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:18,885 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:19,007 - INFO -      [0] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 15:58:19,007 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:19,007 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:19,011 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:19,011 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:19,011 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:19,119 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 294.6042 (accum_step 13/16)
2025-11-03 15:58:19,119 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:19,129 - INFO -      [0] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:19,252 - INFO -      [0] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 15:58:19,252 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:19,253 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:19,255 - INFO -      [0] ‚úì Data moved to device in 0.002s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:19,256 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:19,256 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:19,363 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 290.8181 (accum_step 14/16)
2025-11-03 15:58:19,363 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:19,374 - INFO -      [0] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:19,497 - INFO -      [0] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 15:58:19,497 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:19,497 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:19,497 - INFO -      [0] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:58:19,498 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:58:19,498 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:19,524 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 284.0897 (accum_step 15/16)
2025-11-03 15:58:19,524 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:19,536 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:19,558 - INFO -      [0] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 15:58:20,604 - INFO -      [0] ‚úì Batch fetched in 1.047s
2025-11-03 15:58:20,605 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:58:20,608 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:20,609 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:20,609 - INFO -      [0] Starting forward pass...
2025-11-03 15:58:20,717 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 295.2990 (accum_step 16/16)
2025-11-03 15:58:20,717 - INFO -      [0] Starting backward pass...
2025-11-03 15:58:20,731 - INFO -      [0] ‚úì Backward pass completed in 0.014s
2025-11-03 15:58:20,852 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 15:58:20,996 - INFO -      [0] ‚úì Optimizer step completed in 0.144s, grad_norm = 324.1804
2025-11-03 15:58:20,997 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 15:58:20,997 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:20,997 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:21,003 - INFO -      [1] ‚úì Data moved to device in 0.006s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:21,004 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:21,005 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:21,113 - INFO -      [1] ‚úì Forward pass completed in 0.039s, loss = 291.2435 (accum_step 1/16)
2025-11-03 15:58:21,113 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:21,129 - INFO -      [1] ‚úì Backward pass completed in 0.016s
2025-11-03 15:58:21,250 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 15:58:21,250 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:21,250 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:21,251 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:21,252 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:21,252 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:21,360 - INFO -      [1] ‚úì Forward pass completed in 0.011s, loss = 290.2340 (accum_step 2/16)
2025-11-03 15:58:21,360 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:21,377 - INFO -      [1] ‚úì Backward pass completed in 0.017s
2025-11-03 15:58:21,496 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 15:58:21,496 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:21,496 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:21,500 - INFO -      [1] ‚úì Data moved to device in 0.004s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:21,500 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:21,500 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:21,608 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 291.1613 (accum_step 3/16)
2025-11-03 15:58:21,608 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:21,619 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:21,742 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 15:58:21,742 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:21,742 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:21,743 - INFO -      [1] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:58:21,743 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:58:21,743 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:21,769 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 302.1552 (accum_step 4/16)
2025-11-03 15:58:21,769 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:21,781 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:21,803 - INFO -      [1] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 15:58:23,126 - INFO -      [1] ‚úì Batch fetched in 1.322s
2025-11-03 15:58:23,126 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:23,130 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:23,131 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:23,131 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:23,239 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 293.1863 (accum_step 5/16)
2025-11-03 15:58:23,239 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:23,251 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 15:58:23,373 - INFO -      [1] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 15:58:23,373 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:23,373 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:23,374 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:23,374 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:23,374 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:23,482 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 296.1573 (accum_step 6/16)
2025-11-03 15:58:23,482 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:23,493 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:23,615 - INFO -      [1] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 15:58:23,615 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:23,615 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:23,618 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:23,619 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:23,619 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:23,726 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 286.4059 (accum_step 7/16)
2025-11-03 15:58:23,727 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:23,738 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:23,860 - INFO -      [1] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 15:58:23,860 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:23,860 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:23,863 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:23,865 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:23,865 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:23,972 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 290.9436 (accum_step 8/16)
2025-11-03 15:58:23,972 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:23,982 - INFO -      [1] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:24,105 - INFO -      [1] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 15:58:24,105 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:24,105 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:24,106 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:58:24,106 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:58:24,106 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:24,132 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 294.4075 (accum_step 9/16)
2025-11-03 15:58:24,132 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:24,143 - INFO -      [1] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:24,166 - INFO -      [1] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 15:58:25,125 - INFO -      [1] ‚úì Batch fetched in 0.959s
2025-11-03 15:58:25,125 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:25,129 - INFO -      [1] ‚úì Data moved to device in 0.004s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:25,130 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:25,130 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:25,238 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 286.9599 (accum_step 10/16)
2025-11-03 15:58:25,238 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:25,249 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:25,372 - INFO -      [1] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 15:58:25,372 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:25,372 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:25,375 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:25,375 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:25,375 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:25,483 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 287.4337 (accum_step 11/16)
2025-11-03 15:58:25,483 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:25,493 - INFO -      [1] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:25,617 - INFO -      [1] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 15:58:25,617 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:25,617 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:25,619 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:25,619 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:25,619 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:25,727 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 291.3038 (accum_step 12/16)
2025-11-03 15:58:25,727 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:25,737 - INFO -      [1] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:25,861 - INFO -      [1] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 15:58:25,861 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:25,861 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:25,862 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:25,862 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:25,862 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:25,970 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 290.5564 (accum_step 13/16)
2025-11-03 15:58:25,970 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:25,981 - INFO -      [1] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:26,103 - INFO -      [1] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 15:58:26,104 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:26,104 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:26,104 - INFO -      [1] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:58:26,105 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:58:26,105 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:26,131 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 295.4719 (accum_step 14/16)
2025-11-03 15:58:26,131 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:26,142 - INFO -      [1] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:26,165 - INFO -      [1] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 15:58:27,130 - INFO -      [1] ‚úì Batch fetched in 0.965s
2025-11-03 15:58:27,130 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:27,134 - INFO -      [1] ‚úì Data moved to device in 0.004s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:27,135 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:27,135 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:27,243 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 293.8911 (accum_step 15/16)
2025-11-03 15:58:27,243 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:27,255 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 15:58:27,377 - INFO -      [1] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 15:58:27,377 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:27,377 - INFO -      [1] Moving data to device cuda...
2025-11-03 15:58:27,380 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:27,381 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:27,381 - INFO -      [1] Starting forward pass...
2025-11-03 15:58:27,488 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 291.9221 (accum_step 16/16)
2025-11-03 15:58:27,488 - INFO -      [1] Starting backward pass...
2025-11-03 15:58:27,499 - INFO -      [1] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:27,622 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 15:58:27,632 - INFO -      [1] ‚úì Optimizer step completed in 0.010s, grad_norm = 324.8422
2025-11-03 15:58:27,632 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 15:58:27,632 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:27,632 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:27,633 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:27,634 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:27,634 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:27,741 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 291.5954 (accum_step 1/16)
2025-11-03 15:58:27,741 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:27,751 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:27,874 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 15:58:27,874 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:27,874 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:27,877 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:27,878 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:27,878 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:27,986 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 290.4445 (accum_step 2/16)
2025-11-03 15:58:27,986 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:27,996 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:28,119 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 15:58:28,119 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:28,119 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:28,120 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:58:28,120 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:58:28,121 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:28,147 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 297.2681 (accum_step 3/16)
2025-11-03 15:58:28,147 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:28,157 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:28,180 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 15:58:28,909 - INFO -      [2] ‚úì Batch fetched in 0.729s
2025-11-03 15:58:28,910 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:28,910 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:28,911 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:28,911 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:29,019 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 295.0737 (accum_step 4/16)
2025-11-03 15:58:29,019 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:29,031 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 15:58:29,153 - INFO -      [2] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 15:58:29,632 - INFO -      [2] ‚úì Batch fetched in 0.478s
2025-11-03 15:58:29,632 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:29,632 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:29,633 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:29,633 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:29,741 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.2725 (accum_step 5/16)
2025-11-03 15:58:29,741 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:29,752 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:29,875 - INFO -      [2] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 15:58:29,875 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:29,875 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:29,877 - INFO -      [2] ‚úì Data moved to device in 0.002s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:29,878 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:29,878 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:29,985 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 290.2286 (accum_step 6/16)
2025-11-03 15:58:29,985 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:29,995 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:30,119 - INFO -      [2] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 15:58:30,119 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:30,119 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:30,122 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:30,123 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:30,123 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:30,230 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 291.9520 (accum_step 7/16)
2025-11-03 15:58:30,230 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:30,241 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:30,364 - INFO -      [2] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 15:58:30,364 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:30,364 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:30,364 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:58:30,365 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:58:30,365 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:30,391 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 295.8267 (accum_step 8/16)
2025-11-03 15:58:30,391 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:30,401 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:30,425 - INFO -      [2] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 15:58:31,103 - INFO -      [2] ‚úì Batch fetched in 0.678s
2025-11-03 15:58:31,103 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:31,104 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:31,105 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:31,105 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:31,213 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 292.4438 (accum_step 9/16)
2025-11-03 15:58:31,213 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:31,225 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 15:58:31,347 - INFO -      [2] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 15:58:31,450 - INFO -      [2] ‚úì Batch fetched in 0.103s
2025-11-03 15:58:31,450 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:31,453 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:31,454 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:31,454 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:31,562 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 291.7278 (accum_step 10/16)
2025-11-03 15:58:31,562 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:31,573 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:31,696 - INFO -      [2] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 15:58:31,696 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:31,696 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:31,699 - INFO -      [2] ‚úì Data moved to device in 0.002s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:31,699 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:31,699 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:31,807 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 293.9363 (accum_step 11/16)
2025-11-03 15:58:31,807 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:31,817 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:31,940 - INFO -      [2] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 15:58:31,940 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:31,941 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:31,941 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:31,942 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:31,942 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:32,049 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.6580 (accum_step 12/16)
2025-11-03 15:58:32,049 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:32,060 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:32,183 - INFO -      [2] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 15:58:32,183 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:32,183 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:32,184 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:58:32,184 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:58:32,184 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:32,211 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 284.4186 (accum_step 13/16)
2025-11-03 15:58:32,211 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:32,221 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:32,244 - INFO -      [2] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 15:58:33,746 - INFO -      [2] ‚úì Batch fetched in 1.502s
2025-11-03 15:58:33,747 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:33,750 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:33,752 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.002s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:33,752 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:33,859 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 292.4812 (accum_step 14/16)
2025-11-03 15:58:33,860 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:33,871 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 15:58:33,993 - INFO -      [2] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 15:58:33,993 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:33,993 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:33,996 - INFO -      [2] ‚úì Data moved to device in 0.002s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:33,996 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:33,997 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:34,104 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 283.5559 (accum_step 15/16)
2025-11-03 15:58:34,104 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:34,115 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:34,238 - INFO -      [2] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 15:58:34,238 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:34,238 - INFO -      [2] Moving data to device cuda...
2025-11-03 15:58:34,242 - INFO -      [2] ‚úì Data moved to device in 0.004s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:58:34,242 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:58:34,243 - INFO -      [2] Starting forward pass...
2025-11-03 15:58:34,350 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 294.4245 (accum_step 16/16)
2025-11-03 15:58:34,350 - INFO -      [2] Starting backward pass...
2025-11-03 15:58:34,360 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 15:58:34,484 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 15:58:34,492 - INFO -      [2] ‚úì Optimizer step completed in 0.009s, grad_norm = 328.7791
2025-11-03 15:58:34,492 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 15:58:34,493 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:34,605 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 282.9390 (accum_step 1/16)
2025-11-03 15:58:34,737 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 15:58:34,738 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:34,765 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 288.0878 (accum_step 2/16)
2025-11-03 15:58:34,799 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 15:58:36,080 - INFO -      [3] ‚úì Batch fetched in 1.281s
2025-11-03 15:58:36,189 - INFO -      [3] ‚úì Forward pass completed in 0.008s, loss = 284.5797 (accum_step 3/16)
2025-11-03 15:58:36,323 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 15:58:36,323 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:36,434 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 282.4273 (accum_step 4/16)
2025-11-03 15:58:36,567 - INFO -      [3] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 15:58:36,568 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:36,678 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 284.2598 (accum_step 5/16)
2025-11-03 15:58:36,812 - INFO -      [3] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 15:58:36,812 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:36,921 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 283.2510 (accum_step 6/16)
2025-11-03 15:58:37,054 - INFO -      [3] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 15:58:37,055 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:37,082 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 277.4448 (accum_step 7/16)
2025-11-03 15:58:37,116 - INFO -      [3] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 15:58:37,867 - INFO -      [3] ‚úì Batch fetched in 0.751s
2025-11-03 15:58:37,976 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 282.4593 (accum_step 8/16)
2025-11-03 15:58:38,110 - INFO -      [3] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 15:58:38,499 - INFO -      [3] ‚úì Batch fetched in 0.389s
2025-11-03 15:58:38,611 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 285.8551 (accum_step 9/16)
2025-11-03 15:58:38,745 - INFO -      [3] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 15:58:38,745 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:38,857 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 282.8267 (accum_step 10/16)
2025-11-03 15:58:38,990 - INFO -      [3] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 15:58:38,990 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:39,099 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 286.4966 (accum_step 11/16)
2025-11-03 15:58:39,233 - INFO -      [3] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 15:58:39,233 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:39,260 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 289.5742 (accum_step 12/16)
2025-11-03 15:58:39,294 - INFO -      [3] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 15:58:40,041 - INFO -      [3] ‚úì Batch fetched in 0.747s
2025-11-03 15:58:40,151 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 279.2099 (accum_step 13/16)
2025-11-03 15:58:40,285 - INFO -      [3] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 15:58:40,285 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:40,396 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 287.0646 (accum_step 14/16)
2025-11-03 15:58:40,529 - INFO -      [3] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 15:58:40,529 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:40,638 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 284.7661 (accum_step 15/16)
2025-11-03 15:58:40,772 - INFO -      [3] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 15:58:40,772 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:40,884 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 291.1229 (accum_step 16/16)
2025-11-03 15:58:41,026 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 15:58:41,026 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:41,054 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 287.9007 (accum_step 1/16)
2025-11-03 15:58:41,086 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 15:58:41,858 - INFO -      [4] ‚úì Batch fetched in 0.772s
2025-11-03 15:58:41,971 - INFO -      [4] ‚úì Forward pass completed in 0.008s, loss = 272.3702 (accum_step 2/16)
2025-11-03 15:58:42,105 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 15:58:42,105 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:42,216 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 276.6773 (accum_step 3/16)
2025-11-03 15:58:42,349 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 15:58:42,350 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:42,461 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 279.3459 (accum_step 4/16)
2025-11-03 15:58:42,595 - INFO -      [4] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 15:58:42,595 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:42,704 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 280.7411 (accum_step 5/16)
2025-11-03 15:58:42,837 - INFO -      [4] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 15:58:42,837 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:42,865 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 286.7498 (accum_step 6/16)
2025-11-03 15:58:42,899 - INFO -      [4] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 15:58:43,420 - INFO -      [4] ‚úì Batch fetched in 0.521s
2025-11-03 15:58:43,532 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 277.8601 (accum_step 7/16)
2025-11-03 15:58:43,666 - INFO -      [4] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 15:58:43,972 - INFO -      [4] ‚úì Batch fetched in 0.306s
2025-11-03 15:58:44,082 - INFO -      [4] ‚úì Forward pass completed in 0.008s, loss = 282.1069 (accum_step 8/16)
2025-11-03 15:58:44,216 - INFO -      [4] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 15:58:44,216 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:44,328 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 279.3574 (accum_step 9/16)
2025-11-03 15:58:44,462 - INFO -      [4] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 15:58:44,462 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:44,573 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 281.4546 (accum_step 10/16)
2025-11-03 15:58:44,707 - INFO -      [4] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 15:58:44,707 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:44,734 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 278.1634 (accum_step 11/16)
2025-11-03 15:58:44,768 - INFO -      [4] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 15:58:45,156 - INFO -      [4] ‚úì Batch fetched in 0.387s
2025-11-03 15:58:45,268 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 273.7966 (accum_step 12/16)
2025-11-03 15:58:45,402 - INFO -      [4] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 15:58:46,149 - INFO -      [4] ‚úì Batch fetched in 0.747s
2025-11-03 15:58:46,261 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 273.5836 (accum_step 13/16)
2025-11-03 15:58:46,395 - INFO -      [4] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 15:58:46,395 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:46,506 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 275.4367 (accum_step 14/16)
2025-11-03 15:58:46,639 - INFO -      [4] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 15:58:46,639 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:46,751 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 274.3218 (accum_step 15/16)
2025-11-03 15:58:46,884 - INFO -      [4] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 15:58:46,884 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:46,912 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 276.7770 (accum_step 16/16)
2025-11-03 15:58:46,954 - INFO -   Step 5/10: loss = 278.5402, avg_loss = 287.7596, lr = 0.000011, grad_norm = 329.1178
2025-11-03 15:58:46,954 - INFO -     ‚è±Ô∏è  Timing: total=5.928s (fetch=2.735s, to_device=0.035s, spec_compute=0.010s, forward=0.103s, backward=0.172s, optim=0.008s)
2025-11-03 15:58:46,954 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 15:58:48,262 - INFO -      [5] ‚úì Batch fetched in 1.308s
2025-11-03 15:58:48,374 - INFO -      [5] ‚úì Forward pass completed in 0.008s, loss = 268.5711 (accum_step 1/16)
2025-11-03 15:58:48,507 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 15:58:48,507 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:48,617 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 263.3568 (accum_step 2/16)
2025-11-03 15:58:48,751 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 15:58:48,751 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:48,860 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 270.7913 (accum_step 3/16)
2025-11-03 15:58:48,993 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 15:58:48,993 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:49,105 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 270.2370 (accum_step 4/16)
2025-11-03 15:58:49,238 - INFO -      [5] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 15:58:49,238 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:49,266 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 269.9722 (accum_step 5/16)
2025-11-03 15:58:49,299 - INFO -      [5] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 15:58:50,296 - INFO -      [5] ‚úì Batch fetched in 0.997s
2025-11-03 15:58:50,408 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 269.7603 (accum_step 6/16)
2025-11-03 15:58:50,542 - INFO -      [5] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 15:58:50,677 - INFO -      [5] ‚úì Batch fetched in 0.135s
2025-11-03 15:58:50,788 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 275.2355 (accum_step 7/16)
2025-11-03 15:58:50,922 - INFO -      [5] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 15:58:50,922 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:51,031 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 269.9146 (accum_step 8/16)
2025-11-03 15:58:51,164 - INFO -      [5] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 15:58:51,164 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:51,276 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 270.1366 (accum_step 9/16)
2025-11-03 15:58:51,410 - INFO -      [5] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 15:58:51,410 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:51,438 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 270.4086 (accum_step 10/16)
2025-11-03 15:58:51,472 - INFO -      [5] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 15:58:52,972 - INFO -      [5] ‚úì Batch fetched in 1.500s
2025-11-03 15:58:53,085 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 269.3999 (accum_step 11/16)
2025-11-03 15:58:53,219 - INFO -      [5] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 15:58:53,219 - INFO -      [5] ‚úì Batch fetched in 0.001s
2025-11-03 15:58:53,330 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 268.3355 (accum_step 12/16)
2025-11-03 15:58:53,464 - INFO -      [5] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 15:58:53,464 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:53,573 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 262.1637 (accum_step 13/16)
2025-11-03 15:58:53,706 - INFO -      [5] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 15:58:53,706 - INFO -      [5] ‚úì Batch fetched in 0.001s
2025-11-03 15:58:53,818 - INFO -      [5] ‚úì Forward pass completed in 0.008s, loss = 276.8417 (accum_step 14/16)
2025-11-03 15:58:53,951 - INFO -      [5] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 15:58:53,951 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:53,979 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 264.5146 (accum_step 15/16)
2025-11-03 15:58:54,012 - INFO -      [5] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 15:58:54,969 - INFO -      [5] ‚úì Batch fetched in 0.957s
2025-11-03 15:58:55,082 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 273.4322 (accum_step 16/16)
2025-11-03 15:58:55,229 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 15:58:55,416 - INFO -      [6] ‚úì Batch fetched in 0.187s
2025-11-03 15:58:55,528 - INFO -      [6] ‚úì Forward pass completed in 0.008s, loss = 257.0519 (accum_step 1/16)
2025-11-03 15:58:55,661 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 15:58:55,661 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:55,770 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 265.0419 (accum_step 2/16)
2025-11-03 15:58:55,904 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 15:58:55,904 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:56,016 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 261.3549 (accum_step 3/16)
2025-11-03 15:58:56,149 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 15:58:56,150 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:56,177 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 261.5456 (accum_step 4/16)
2025-11-03 15:58:56,211 - INFO -      [6] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 15:58:57,428 - INFO -      [6] ‚úì Batch fetched in 1.217s
2025-11-03 15:58:57,537 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 263.3960 (accum_step 5/16)
2025-11-03 15:58:57,671 - INFO -      [6] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 15:58:57,671 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:57,782 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 260.4595 (accum_step 6/16)
2025-11-03 15:58:57,916 - INFO -      [6] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 15:58:57,916 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:58,028 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.5849 (accum_step 7/16)
2025-11-03 15:58:58,161 - INFO -      [6] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 15:58:58,161 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:58,270 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 262.6049 (accum_step 8/16)
2025-11-03 15:58:58,404 - INFO -      [6] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 15:58:58,404 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:58:58,431 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 265.9008 (accum_step 9/16)
2025-11-03 15:58:58,465 - INFO -      [6] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 15:58:59,586 - INFO -      [6] ‚úì Batch fetched in 1.121s
2025-11-03 15:58:59,698 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 258.3420 (accum_step 10/16)
2025-11-03 15:58:59,831 - INFO -      [6] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 15:59:00,004 - INFO -      [6] ‚úì Batch fetched in 0.173s
2025-11-03 15:59:00,116 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 264.9003 (accum_step 11/16)
2025-11-03 15:59:00,250 - INFO -      [6] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 15:59:00,250 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:00,362 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 262.5370 (accum_step 12/16)
2025-11-03 15:59:00,495 - INFO -      [6] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 15:59:00,496 - INFO -      [6] ‚úì Batch fetched in 0.001s
2025-11-03 15:59:00,605 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.2995 (accum_step 13/16)
2025-11-03 15:59:00,739 - INFO -      [6] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 15:59:00,739 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:00,767 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 259.8257 (accum_step 14/16)
2025-11-03 15:59:00,800 - INFO -      [6] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 15:59:02,055 - INFO -      [6] ‚úì Batch fetched in 1.255s
2025-11-03 15:59:02,165 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 263.3168 (accum_step 15/16)
2025-11-03 15:59:02,299 - INFO -      [6] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 15:59:02,669 - INFO -      [6] ‚úì Batch fetched in 0.370s
2025-11-03 15:59:02,781 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 262.3392 (accum_step 16/16)
2025-11-03 15:59:02,925 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 15:59:02,926 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:03,036 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 246.5147 (accum_step 1/16)
2025-11-03 15:59:03,169 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 15:59:03,169 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:03,280 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.7474 (accum_step 2/16)
2025-11-03 15:59:03,414 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 15:59:03,414 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:03,441 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 254.8097 (accum_step 3/16)
2025-11-03 15:59:03,475 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 15:59:04,401 - INFO -      [7] ‚úì Batch fetched in 0.926s
2025-11-03 15:59:04,513 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 250.9112 (accum_step 4/16)
2025-11-03 15:59:04,648 - INFO -      [7] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 15:59:04,648 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:04,759 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 253.8117 (accum_step 5/16)
2025-11-03 15:59:04,893 - INFO -      [7] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 15:59:04,893 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:05,002 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.0894 (accum_step 6/16)
2025-11-03 15:59:05,135 - INFO -      [7] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 15:59:05,136 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:05,247 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.0326 (accum_step 7/16)
2025-11-03 15:59:05,380 - INFO -      [7] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 15:59:05,381 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:05,408 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 249.5627 (accum_step 8/16)
2025-11-03 15:59:05,442 - INFO -      [7] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 15:59:06,529 - INFO -      [7] ‚úì Batch fetched in 1.087s
2025-11-03 15:59:06,641 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 244.7776 (accum_step 9/16)
2025-11-03 15:59:06,776 - INFO -      [7] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 15:59:07,114 - INFO -      [7] ‚úì Batch fetched in 0.338s
2025-11-03 15:59:07,226 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 255.4823 (accum_step 10/16)
2025-11-03 15:59:07,360 - INFO -      [7] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 15:59:07,360 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:07,469 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.5887 (accum_step 11/16)
2025-11-03 15:59:07,602 - INFO -      [7] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 15:59:07,603 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:07,714 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 250.6142 (accum_step 12/16)
2025-11-03 15:59:07,848 - INFO -      [7] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 15:59:07,848 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:07,876 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 249.5690 (accum_step 13/16)
2025-11-03 15:59:07,910 - INFO -      [7] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 15:59:08,928 - INFO -      [7] ‚úì Batch fetched in 1.019s
2025-11-03 15:59:09,041 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 248.5972 (accum_step 14/16)
2025-11-03 15:59:09,175 - INFO -      [7] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 15:59:09,175 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:09,284 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 250.6962 (accum_step 15/16)
2025-11-03 15:59:09,417 - INFO -      [7] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 15:59:09,418 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:09,529 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.5077 (accum_step 16/16)
2025-11-03 15:59:09,672 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 15:59:09,672 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:09,783 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 235.4616 (accum_step 1/16)
2025-11-03 15:59:09,916 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 15:59:09,916 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:09,943 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 248.1114 (accum_step 2/16)
2025-11-03 15:59:09,977 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 15:59:11,300 - INFO -      [8] ‚úì Batch fetched in 1.323s
2025-11-03 15:59:11,413 - INFO -      [8] ‚úì Forward pass completed in 0.008s, loss = 239.6546 (accum_step 3/16)
2025-11-03 15:59:11,546 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 15:59:11,547 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:11,658 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 236.8684 (accum_step 4/16)
2025-11-03 15:59:11,792 - INFO -      [8] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 15:59:11,792 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:11,903 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 237.7806 (accum_step 5/16)
2025-11-03 15:59:12,037 - INFO -      [8] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 15:59:12,037 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:12,146 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 238.4526 (accum_step 6/16)
2025-11-03 15:59:12,279 - INFO -      [8] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 15:59:12,279 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:12,307 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 241.0676 (accum_step 7/16)
2025-11-03 15:59:12,340 - INFO -      [8] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 15:59:13,362 - INFO -      [8] ‚úì Batch fetched in 1.021s
2025-11-03 15:59:13,471 - INFO -      [8] ‚úì Forward pass completed in 0.008s, loss = 236.4461 (accum_step 8/16)
2025-11-03 15:59:13,605 - INFO -      [8] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 15:59:13,605 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:13,717 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 239.0343 (accum_step 9/16)
2025-11-03 15:59:13,851 - INFO -      [8] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 15:59:13,851 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:13,962 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 236.9500 (accum_step 10/16)
2025-11-03 15:59:14,095 - INFO -      [8] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 15:59:14,095 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:14,204 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 237.8923 (accum_step 11/16)
2025-11-03 15:59:14,338 - INFO -      [8] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 15:59:14,338 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:14,365 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 242.4038 (accum_step 12/16)
2025-11-03 15:59:14,399 - INFO -      [8] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 15:59:15,466 - INFO -      [8] ‚úì Batch fetched in 1.067s
2025-11-03 15:59:15,578 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 234.8611 (accum_step 13/16)
2025-11-03 15:59:15,712 - INFO -      [8] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 15:59:15,933 - INFO -      [8] ‚úì Batch fetched in 0.221s
2025-11-03 15:59:16,042 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 235.9834 (accum_step 14/16)
2025-11-03 15:59:16,175 - INFO -      [8] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 15:59:16,175 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:16,286 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 241.0226 (accum_step 15/16)
2025-11-03 15:59:16,420 - INFO -      [8] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 15:59:16,420 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:16,531 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 238.2259 (accum_step 16/16)
2025-11-03 15:59:16,673 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 15:59:16,673 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:16,700 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 228.0605 (accum_step 1/16)
2025-11-03 15:59:16,733 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 15:59:17,703 - INFO -      [9] ‚úì Batch fetched in 0.970s
2025-11-03 15:59:17,816 - INFO -      [9] ‚úì Forward pass completed in 0.008s, loss = 227.5934 (accum_step 2/16)
2025-11-03 15:59:17,950 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 15:59:18,076 - INFO -      [9] ‚úì Batch fetched in 0.126s
2025-11-03 15:59:18,188 - INFO -      [9] ‚úì Forward pass completed in 0.008s, loss = 221.2773 (accum_step 3/16)
2025-11-03 15:59:18,322 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 15:59:18,323 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:18,433 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 223.7729 (accum_step 4/16)
2025-11-03 15:59:18,566 - INFO -      [9] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 15:59:18,567 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:18,678 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 223.0739 (accum_step 5/16)
2025-11-03 15:59:18,812 - INFO -      [9] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 15:59:18,812 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:18,840 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 225.0453 (accum_step 6/16)
2025-11-03 15:59:18,874 - INFO -      [9] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 15:59:19,810 - INFO -      [9] ‚úì Batch fetched in 0.936s
2025-11-03 15:59:19,922 - INFO -      [9] ‚úì Forward pass completed in 0.008s, loss = 222.6441 (accum_step 7/16)
2025-11-03 15:59:20,056 - INFO -      [9] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 15:59:20,056 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:20,167 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 222.1372 (accum_step 8/16)
2025-11-03 15:59:20,301 - INFO -      [9] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 15:59:20,301 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:20,410 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 228.6931 (accum_step 9/16)
2025-11-03 15:59:20,544 - INFO -      [9] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 15:59:20,544 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:20,655 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 226.6963 (accum_step 10/16)
2025-11-03 15:59:20,789 - INFO -      [9] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 15:59:20,790 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:20,817 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 225.0082 (accum_step 11/16)
2025-11-03 15:59:20,851 - INFO -      [9] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 15:59:22,111 - INFO -      [9] ‚úì Batch fetched in 1.260s
2025-11-03 15:59:22,223 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 219.6330 (accum_step 12/16)
2025-11-03 15:59:22,356 - INFO -      [9] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 15:59:22,357 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:22,465 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 225.9470 (accum_step 13/16)
2025-11-03 15:59:22,599 - INFO -      [9] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 15:59:22,599 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:22,711 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 225.7828 (accum_step 14/16)
2025-11-03 15:59:22,844 - INFO -      [9] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 15:59:22,845 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:22,955 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 221.9456 (accum_step 15/16)
2025-11-03 15:59:23,088 - INFO -      [9] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 15:59:23,089 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:23,116 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 229.5780 (accum_step 16/16)
2025-11-03 15:59:23,159 - INFO -   Step 10/10: loss = 224.8055, avg_loss = 268.4547, lr = 0.000021, grad_norm = 276.9218
2025-11-03 15:59:23,160 - INFO -     ‚è±Ô∏è  Timing: total=6.486s (fetch=3.297s, to_device=0.030s, spec_compute=0.010s, forward=0.109s, backward=0.178s, optim=0.010s)
2025-11-03 15:59:23,160 - INFO - 
================================================================================
2025-11-03 15:59:23,160 - INFO - TRAINING SUMMARY:
2025-11-03 15:59:23,160 - INFO -   Steps Completed: 10
2025-11-03 15:59:23,160 - INFO -   Average Loss: 268.4547
2025-11-03 15:59:23,160 - INFO -   Best Validation Loss: inf
2025-11-03 15:59:23,160 - INFO - ================================================================================
2025-11-03 15:59:23,160 - INFO - 
================================================================================
2025-11-03 15:59:23,160 - INFO - TRAINING COMPLETED
2025-11-03 15:59:23,160 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:59:23,160 - INFO - Final step: 10
2025-11-03 15:59:23,160 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 15:59:23,160 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:59:23,160 - INFO - ================================================================================
2025-11-03 15:59:32,923 - INFO - ================================================================================
2025-11-03 15:59:32,923 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 15:59:32,923 - INFO - ================================================================================
2025-11-03 15:59:32,923 - INFO - Configuration: A100_pretraining_test
2025-11-03 15:59:32,923 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 15:59:32,923 - INFO - ================================================================================
2025-11-03 15:59:32,925 - INFO - Device: cuda
2025-11-03 15:59:32,925 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 15:59:32,925 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 15:59:32,925 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 15:59:32,925 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 15:59:32,925 - INFO -   Batch size: 64, Steps: 10
2025-11-03 15:59:32,925 - INFO -   Validation interval: 20 steps
2025-11-03 15:59:32,925 - INFO -   Log interval: 5 steps
2025-11-03 15:59:32,925 - INFO - 
Initializing model...
2025-11-03 15:59:33,525 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 15:59:33,526 - INFO -   Total parameters: 44,674,663
2025-11-03 15:59:33,526 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 15:59:36,566 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 15:59:36,566 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 15:59:36,574 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 15:59:36,574 - INFO - 
Setting up datasets...
2025-11-03 15:59:36,574 - INFO -   Loading MAESTRO dataset...
2025-11-03 15:59:36,578 - INFO -   ‚úì MAESTRO train: 20 samples (cached)
2025-11-03 15:59:36,578 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 15:59:36,578 - INFO -   Loading SLAKH stems dataset...
2025-11-03 15:59:37,262 - INFO -   ‚úì SLAKH stems train: 209 samples (cached)
2025-11-03 15:59:37,682 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 15:59:37,682 - INFO -   Loading SLAKH mix dataset...
2025-11-03 15:59:37,732 - INFO -   ‚úì SLAKH mix train: 20 samples (cached)
2025-11-03 15:59:37,783 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 15:59:37,783 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 15:59:37,842 - INFO -   ‚úì SLAKH mixed train: 20 samples (cached)
2025-11-03 15:59:37,884 - INFO -   ‚úì SLAKH mixed val: 20 samples (cached)
2025-11-03 15:59:37,884 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 15:59:37,884 - INFO -   Warming train cache for maestro dataset before forking workers...
2025-11-03 15:59:38,150 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 15:59:39,124 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 15:59:40,777 - INFO -   Warming validation cache for maestro dataset before forking workers...
2025-11-03 15:59:41,073 - INFO -   Warming validation cache for slakh_stems dataset before forking workers...
2025-11-03 15:59:42,606 - INFO -   Warming validation cache for slakh_mix dataset before forking workers...
2025-11-03 15:59:44,151 - INFO - 
  Creating multi-task dataset...
2025-11-03 15:59:44,151 - INFO -   ‚úì Multi-task dataset: 269 total samples
2025-11-03 15:59:44,151 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 15:59:44,151 - INFO - 
  Setting up validation data...
2025-11-03 15:59:44,151 - INFO -   ‚úì Validation: 267 samples
2025-11-03 15:59:44,153 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 15:59:44,153 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 15:59:44,153 - INFO -   Label smoothing: 0.1
2025-11-03 15:59:44,153 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 15:59:44,153 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 15:59:44,153 - INFO - 
Starting training...
2025-11-03 15:59:44,153 - INFO -   Total steps: 10
2025-11-03 15:59:44,153 - INFO -   Batch size: 64
2025-11-03 15:59:44,153 - INFO -   Learning rate: 0.0001
2025-11-03 15:59:44,153 - INFO -   Weight decay: 0.1
2025-11-03 15:59:44,153 - INFO -   Log interval: 5 steps
2025-11-03 15:59:44,153 - INFO -   Validation interval: 20 steps
2025-11-03 15:59:44,153 - INFO -   Save interval: 100 steps
2025-11-03 15:59:44,154 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 15:59:44,206 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 15:59:44,206 - INFO - 
================================================================================
2025-11-03 15:59:44,207 - INFO - STEP-BASED TRAINING
2025-11-03 15:59:44,207 - INFO -   Starting from step: 0
2025-11-03 15:59:44,207 - INFO -   Target steps: 10
2025-11-03 15:59:44,207 - INFO -   Batch size: 64
2025-11-03 15:59:44,207 - INFO -   Gradient accumulation steps: 16
2025-11-03 15:59:44,207 - INFO -   Effective batch size: 1024
2025-11-03 15:59:44,207 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 15:59:44,207 - INFO - ================================================================================
2025-11-03 15:59:44,207 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 15:59:44,207 - INFO - 
üöÄ Starting training loop...
2025-11-03 15:59:44,207 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 15:59:44,207 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 15:59:46,892 - INFO -      [0] ‚úì Batch fetched in 2.685s
2025-11-03 15:59:46,893 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:46,897 - INFO -      [0] ‚úì Data moved to device in 0.004s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:47,147 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.251s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:47,148 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:49,751 - INFO -      [0] ‚úì Forward pass completed in 2.603s, loss = 293.0322 (accum_step 1/16)
2025-11-03 15:59:49,751 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:49,959 - INFO -      [0] ‚úì Backward pass completed in 0.208s
2025-11-03 15:59:49,967 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 15:59:49,967 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:49,967 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:49,971 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:49,972 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:49,972 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:50,080 - INFO -      [0] ‚úì Forward pass completed in 0.027s, loss = 298.1180 (accum_step 2/16)
2025-11-03 15:59:50,080 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:50,131 - INFO -      [0] ‚úì Backward pass completed in 0.051s
2025-11-03 15:59:50,216 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 15:59:50,216 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:50,216 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:50,219 - INFO -      [0] ‚úì Data moved to device in 0.002s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:50,219 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:50,219 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:50,327 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 294.9651 (accum_step 3/16)
2025-11-03 15:59:50,327 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:50,338 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:59:50,461 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 15:59:50,461 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:50,461 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:50,462 - INFO -      [0] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:50,463 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:50,463 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:50,570 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 287.0170 (accum_step 4/16)
2025-11-03 15:59:50,570 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:50,581 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:59:50,705 - INFO -      [0] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 15:59:50,705 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:50,705 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:50,706 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:59:50,708 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.002s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:59:50,708 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:53,382 - INFO -      [0] ‚úì Forward pass completed in 2.663s, loss = 293.9517 (accum_step 5/16)
2025-11-03 15:59:53,382 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:53,462 - INFO -      [0] ‚úì Backward pass completed in 0.080s
2025-11-03 15:59:53,463 - INFO -      [0] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 15:59:54,922 - INFO -      [0] ‚úì Batch fetched in 1.459s
2025-11-03 15:59:54,922 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:54,926 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:54,927 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:54,927 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:55,035 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 288.5027 (accum_step 6/16)
2025-11-03 15:59:55,035 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:55,047 - INFO -      [0] ‚úì Backward pass completed in 0.012s
2025-11-03 15:59:55,169 - INFO -      [0] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 15:59:55,277 - INFO -      [0] ‚úì Batch fetched in 0.109s
2025-11-03 15:59:55,277 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:55,281 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:55,282 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:55,282 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:55,389 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 295.0726 (accum_step 7/16)
2025-11-03 15:59:55,389 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:55,401 - INFO -      [0] ‚úì Backward pass completed in 0.012s
2025-11-03 15:59:55,523 - INFO -      [0] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 15:59:55,523 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:55,523 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:55,527 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:55,527 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:55,527 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:55,635 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 295.5229 (accum_step 8/16)
2025-11-03 15:59:55,635 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:55,647 - INFO -      [0] ‚úì Backward pass completed in 0.012s
2025-11-03 15:59:55,769 - INFO -      [0] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 15:59:55,769 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:55,769 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:55,772 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:55,773 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:55,773 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:55,880 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 291.4683 (accum_step 9/16)
2025-11-03 15:59:55,880 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:55,892 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:59:56,014 - INFO -      [0] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 15:59:56,014 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:56,014 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:56,015 - INFO -      [0] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:59:56,015 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:59:56,015 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:56,042 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 295.2999 (accum_step 10/16)
2025-11-03 15:59:56,042 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:56,053 - INFO -      [0] ‚úì Backward pass completed in 0.012s
2025-11-03 15:59:56,075 - INFO -      [0] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 15:59:57,087 - INFO -      [0] ‚úì Batch fetched in 1.011s
2025-11-03 15:59:57,087 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:57,088 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:57,088 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:57,088 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:57,196 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 292.1412 (accum_step 11/16)
2025-11-03 15:59:57,196 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:57,210 - INFO -      [0] ‚úì Backward pass completed in 0.013s
2025-11-03 15:59:57,331 - INFO -      [0] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 15:59:57,331 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:57,331 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:57,334 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:57,335 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:57,335 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:57,442 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 288.1638 (accum_step 12/16)
2025-11-03 15:59:57,442 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:57,457 - INFO -      [0] ‚úì Backward pass completed in 0.014s
2025-11-03 15:59:57,576 - INFO -      [0] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 15:59:57,577 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:57,577 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:57,580 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:57,580 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:57,580 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:57,688 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 294.6042 (accum_step 13/16)
2025-11-03 15:59:57,688 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:57,700 - INFO -      [0] ‚úì Backward pass completed in 0.012s
2025-11-03 15:59:57,822 - INFO -      [0] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 15:59:57,823 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:57,823 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:57,826 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:57,827 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:57,827 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:57,934 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 290.8181 (accum_step 14/16)
2025-11-03 15:59:57,934 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:57,946 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 15:59:58,068 - INFO -      [0] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 15:59:58,068 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 15:59:58,068 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:58,069 - INFO -      [0] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 15:59:58,069 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 15:59:58,070 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:58,096 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 292.9935 (accum_step 15/16)
2025-11-03 15:59:58,096 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:58,108 - INFO -      [0] ‚úì Backward pass completed in 0.012s
2025-11-03 15:59:58,130 - INFO -      [0] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 15:59:59,715 - INFO -      [0] ‚úì Batch fetched in 1.585s
2025-11-03 15:59:59,715 - INFO -      [0] Moving data to device cuda...
2025-11-03 15:59:59,719 - INFO -      [0] ‚úì Data moved to device in 0.004s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 15:59:59,719 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 15:59:59,720 - INFO -      [0] Starting forward pass...
2025-11-03 15:59:59,827 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 290.3492 (accum_step 16/16)
2025-11-03 15:59:59,827 - INFO -      [0] Starting backward pass...
2025-11-03 15:59:59,839 - INFO -      [0] ‚úì Backward pass completed in 0.012s
2025-11-03 15:59:59,961 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 16:00:00,055 - INFO -      [0] ‚úì Optimizer step completed in 0.094s, grad_norm = 324.3024
2025-11-03 16:00:00,056 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 16:00:00,056 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:00,056 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:00,063 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:00,064 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:00,064 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:00,173 - INFO -      [1] ‚úì Forward pass completed in 0.039s, loss = 291.2433 (accum_step 1/16)
2025-11-03 16:00:00,173 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:00,190 - INFO -      [1] ‚úì Backward pass completed in 0.017s
2025-11-03 16:00:00,310 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 16:00:00,310 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:00,310 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:00,317 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:00,317 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:00,318 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:00,425 - INFO -      [1] ‚úì Forward pass completed in 0.011s, loss = 290.2343 (accum_step 2/16)
2025-11-03 16:00:00,425 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:00,442 - INFO -      [1] ‚úì Backward pass completed in 0.017s
2025-11-03 16:00:00,561 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 16:00:00,562 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:00,562 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:00,566 - INFO -      [1] ‚úì Data moved to device in 0.004s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:00,567 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:00,567 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:00,674 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 291.1611 (accum_step 3/16)
2025-11-03 16:00:00,674 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:00,686 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:00,808 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 16:00:00,808 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:00,808 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:00,809 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 16:00:00,809 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 16:00:00,810 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:00,836 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 299.2874 (accum_step 4/16)
2025-11-03 16:00:00,836 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:00,848 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:00,870 - INFO -      [1] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 16:00:01,639 - INFO -      [1] ‚úì Batch fetched in 0.769s
2025-11-03 16:00:01,639 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:01,643 - INFO -      [1] ‚úì Data moved to device in 0.004s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:01,644 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:01,644 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:01,752 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 295.6163 (accum_step 5/16)
2025-11-03 16:00:01,752 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:01,764 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:01,886 - INFO -      [1] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 16:00:01,887 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:01,887 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:01,890 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:01,891 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:01,891 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:01,999 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 296.1576 (accum_step 6/16)
2025-11-03 16:00:01,999 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:02,011 - INFO -      [1] ‚úì Backward pass completed in 0.013s
2025-11-03 16:00:02,133 - INFO -      [1] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 16:00:02,160 - INFO -      [1] ‚úì Batch fetched in 0.027s
2025-11-03 16:00:02,160 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:02,160 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:02,161 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:02,161 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:02,269 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 286.4061 (accum_step 7/16)
2025-11-03 16:00:02,269 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:02,281 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:02,403 - INFO -      [1] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 16:00:02,403 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:02,403 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:02,406 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:02,407 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:02,407 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:02,515 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 290.9438 (accum_step 8/16)
2025-11-03 16:00:02,515 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:02,526 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 16:00:02,649 - INFO -      [1] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 16:00:02,649 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:02,649 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:02,649 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 16:00:02,650 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 16:00:02,650 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:02,676 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 300.5749 (accum_step 9/16)
2025-11-03 16:00:02,676 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:02,687 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 16:00:02,710 - INFO -      [1] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 16:00:03,824 - INFO -      [1] ‚úì Batch fetched in 1.115s
2025-11-03 16:00:03,825 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:03,828 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:03,829 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:03,829 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:03,937 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 295.3271 (accum_step 10/16)
2025-11-03 16:00:03,937 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:03,949 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:04,071 - INFO -      [1] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 16:00:04,071 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:04,071 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:04,074 - INFO -      [1] ‚úì Data moved to device in 0.002s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:04,074 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:04,074 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:04,182 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 287.4343 (accum_step 11/16)
2025-11-03 16:00:04,182 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:04,194 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 16:00:04,316 - INFO -      [1] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 16:00:04,316 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:04,316 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:04,317 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:04,317 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:04,317 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:04,425 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 291.3046 (accum_step 12/16)
2025-11-03 16:00:04,425 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:04,436 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 16:00:04,559 - INFO -      [1] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 16:00:04,559 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:04,559 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:04,563 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:04,563 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:04,563 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:04,671 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 290.5557 (accum_step 13/16)
2025-11-03 16:00:04,671 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:04,682 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 16:00:04,805 - INFO -      [1] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 16:00:04,805 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:04,805 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:04,805 - INFO -      [1] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 16:00:04,806 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 16:00:04,806 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:04,832 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 288.7553 (accum_step 14/16)
2025-11-03 16:00:04,832 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:04,844 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:04,866 - INFO -      [1] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 16:00:05,704 - INFO -      [1] ‚úì Batch fetched in 0.838s
2025-11-03 16:00:05,704 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:05,705 - INFO -      [1] ‚úì Data moved to device in 0.001s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:05,706 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:05,706 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:05,814 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 287.2500 (accum_step 15/16)
2025-11-03 16:00:05,814 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:05,826 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:05,948 - INFO -      [1] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 16:00:05,948 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:05,948 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:00:05,951 - INFO -      [1] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:05,952 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:05,952 - INFO -      [1] Starting forward pass...
2025-11-03 16:00:06,060 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 291.9219 (accum_step 16/16)
2025-11-03 16:00:06,060 - INFO -      [1] Starting backward pass...
2025-11-03 16:00:06,071 - INFO -      [1] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:06,194 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 16:00:06,203 - INFO -      [1] ‚úì Optimizer step completed in 0.009s, grad_norm = 324.4190
2025-11-03 16:00:06,203 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 16:00:06,203 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:06,203 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:06,206 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:06,207 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:06,207 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:06,315 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 291.5941 (accum_step 1/16)
2025-11-03 16:00:06,315 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:06,326 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 16:00:06,447 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 16:00:06,447 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:06,447 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:06,448 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:06,448 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:06,448 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:06,556 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 290.4429 (accum_step 2/16)
2025-11-03 16:00:06,556 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:06,568 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:06,690 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 16:00:06,690 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:06,690 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:06,691 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 16:00:06,691 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 16:00:06,691 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:06,718 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 301.6416 (accum_step 3/16)
2025-11-03 16:00:06,718 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:06,729 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:06,752 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 16:00:07,476 - INFO -      [2] ‚úì Batch fetched in 0.724s
2025-11-03 16:00:07,476 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:07,477 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:07,478 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:07,478 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:07,586 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 291.0611 (accum_step 4/16)
2025-11-03 16:00:07,586 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:07,598 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:07,720 - INFO -      [2] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 16:00:08,197 - INFO -      [2] ‚úì Batch fetched in 0.477s
2025-11-03 16:00:08,197 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:08,198 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:08,198 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:08,198 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:08,306 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.2713 (accum_step 5/16)
2025-11-03 16:00:08,307 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:08,319 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:08,441 - INFO -      [2] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 16:00:08,441 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:08,441 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:08,444 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:08,445 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:08,445 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:08,552 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 290.2299 (accum_step 6/16)
2025-11-03 16:00:08,552 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:08,564 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 16:00:08,686 - INFO -      [2] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 16:00:08,686 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:08,686 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:08,690 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:08,690 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:08,690 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:08,798 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 291.9509 (accum_step 7/16)
2025-11-03 16:00:08,798 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:08,810 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 16:00:08,932 - INFO -      [2] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 16:00:08,932 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:08,932 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:08,932 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 16:00:08,933 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 16:00:08,933 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:08,959 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 278.8180 (accum_step 8/16)
2025-11-03 16:00:08,959 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:08,971 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:08,993 - INFO -      [2] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 16:00:09,878 - INFO -      [2] ‚úì Batch fetched in 0.885s
2025-11-03 16:00:09,878 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:09,879 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:09,880 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:09,880 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:09,988 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 294.7649 (accum_step 9/16)
2025-11-03 16:00:09,988 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:10,001 - INFO -      [2] ‚úì Backward pass completed in 0.013s
2025-11-03 16:00:10,122 - INFO -      [2] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 16:00:10,122 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:10,122 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:10,125 - INFO -      [2] ‚úì Data moved to device in 0.002s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:10,126 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:10,126 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:10,233 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 291.7267 (accum_step 10/16)
2025-11-03 16:00:10,233 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:10,244 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 16:00:10,367 - INFO -      [2] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 16:00:10,368 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:10,368 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:10,370 - INFO -      [2] ‚úì Data moved to device in 0.003s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:10,371 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:10,371 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:10,478 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 293.9366 (accum_step 11/16)
2025-11-03 16:00:10,479 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:10,490 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:10,612 - INFO -      [2] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 16:00:10,613 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:10,613 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:10,613 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:10,614 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:10,614 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:10,722 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.6573 (accum_step 12/16)
2025-11-03 16:00:10,722 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:10,733 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 16:00:10,856 - INFO -      [2] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 16:00:10,856 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:10,856 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:10,856 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 16:00:10,857 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 16:00:10,857 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:10,883 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 286.0074 (accum_step 13/16)
2025-11-03 16:00:10,883 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:10,895 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:10,917 - INFO -      [2] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 16:00:11,793 - INFO -      [2] ‚úì Batch fetched in 0.875s
2025-11-03 16:00:11,793 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:11,797 - INFO -      [2] ‚úì Data moved to device in 0.004s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:11,797 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:11,798 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:11,906 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 293.0951 (accum_step 14/16)
2025-11-03 16:00:11,906 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:11,918 - INFO -      [2] ‚úì Backward pass completed in 0.013s
2025-11-03 16:00:12,040 - INFO -      [2] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 16:00:12,417 - INFO -      [2] ‚úì Batch fetched in 0.377s
2025-11-03 16:00:12,417 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:12,418 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:12,418 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:12,419 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:12,527 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 283.5560 (accum_step 15/16)
2025-11-03 16:00:12,527 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:12,539 - INFO -      [2] ‚úì Backward pass completed in 0.012s
2025-11-03 16:00:12,661 - INFO -      [2] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 16:00:12,661 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:12,661 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:00:12,664 - INFO -      [2] ‚úì Data moved to device in 0.002s (frames: torch.Size([64, 256, 128]), targets: torch.Size([64, 1024]))
2025-11-03 16:00:12,664 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([64, 256, 512]))
2025-11-03 16:00:12,664 - INFO -      [2] Starting forward pass...
2025-11-03 16:00:12,772 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 294.4223 (accum_step 16/16)
2025-11-03 16:00:12,772 - INFO -      [2] Starting backward pass...
2025-11-03 16:00:12,785 - INFO -      [2] ‚úì Backward pass completed in 0.013s
2025-11-03 16:00:12,906 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 16:00:12,915 - INFO -      [2] ‚úì Optimizer step completed in 0.009s, grad_norm = 327.6323
2025-11-03 16:00:12,915 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 16:00:12,915 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:13,027 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 282.9394 (accum_step 1/16)
2025-11-03 16:00:13,160 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 16:00:13,160 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:13,188 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 288.8014 (accum_step 2/16)
2025-11-03 16:00:13,222 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 16:00:14,099 - INFO -      [3] ‚úì Batch fetched in 0.877s
2025-11-03 16:00:14,211 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 287.6319 (accum_step 3/16)
2025-11-03 16:00:14,346 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 16:00:14,346 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:14,455 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 282.4268 (accum_step 4/16)
2025-11-03 16:00:14,589 - INFO -      [3] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 16:00:14,589 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:14,700 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 284.2598 (accum_step 5/16)
2025-11-03 16:00:14,834 - INFO -      [3] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 16:00:14,834 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:14,946 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 283.2464 (accum_step 6/16)
2025-11-03 16:00:15,080 - INFO -      [3] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 16:00:15,080 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:15,107 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 290.3213 (accum_step 7/16)
2025-11-03 16:00:15,141 - INFO -      [3] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 16:00:16,294 - INFO -      [3] ‚úì Batch fetched in 1.154s
2025-11-03 16:00:16,407 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 287.8117 (accum_step 8/16)
2025-11-03 16:00:16,541 - INFO -      [3] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 16:00:16,541 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:16,650 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 285.8485 (accum_step 9/16)
2025-11-03 16:00:16,784 - INFO -      [3] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 16:00:16,784 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:16,895 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 282.8258 (accum_step 10/16)
2025-11-03 16:00:17,029 - INFO -      [3] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 16:00:17,030 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:17,141 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 286.4938 (accum_step 11/16)
2025-11-03 16:00:17,275 - INFO -      [3] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 16:00:17,275 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:17,302 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 291.7513 (accum_step 12/16)
2025-11-03 16:00:17,336 - INFO -      [3] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 16:00:18,553 - INFO -      [3] ‚úì Batch fetched in 1.218s
2025-11-03 16:00:18,666 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 286.1108 (accum_step 13/16)
2025-11-03 16:00:18,800 - INFO -      [3] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 16:00:18,801 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:18,911 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 287.0613 (accum_step 14/16)
2025-11-03 16:00:19,045 - INFO -      [3] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 16:00:19,046 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:19,154 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 284.7589 (accum_step 15/16)
2025-11-03 16:00:19,288 - INFO -      [3] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 16:00:19,288 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:19,400 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 291.1194 (accum_step 16/16)
2025-11-03 16:00:19,546 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 16:00:19,546 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:19,573 - INFO -      [4] ‚úì Forward pass completed in 0.008s, loss = 272.1722 (accum_step 1/16)
2025-11-03 16:00:19,606 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 16:00:20,137 - INFO -      [4] ‚úì Batch fetched in 0.531s
2025-11-03 16:00:20,247 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 271.8383 (accum_step 2/16)
2025-11-03 16:00:20,381 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 16:00:20,381 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:20,491 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 276.6732 (accum_step 3/16)
2025-11-03 16:00:20,625 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 16:00:20,626 - INFO -      [4] ‚úì Batch fetched in 0.001s
2025-11-03 16:00:20,737 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 279.3394 (accum_step 4/16)
2025-11-03 16:00:20,871 - INFO -      [4] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 16:00:20,871 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:20,983 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 280.7352 (accum_step 5/16)
2025-11-03 16:00:21,118 - INFO -      [4] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 16:00:21,119 - INFO -      [4] ‚úì Batch fetched in 0.001s
2025-11-03 16:00:21,146 - INFO -      [4] ‚úì Forward pass completed in 0.008s, loss = 282.7389 (accum_step 6/16)
2025-11-03 16:00:21,180 - INFO -      [4] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 16:00:21,797 - INFO -      [4] ‚úì Batch fetched in 0.618s
2025-11-03 16:00:21,910 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 276.5548 (accum_step 7/16)
2025-11-03 16:00:22,044 - INFO -      [4] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 16:00:22,070 - INFO -      [4] ‚úì Batch fetched in 0.026s
2025-11-03 16:00:22,181 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 282.0985 (accum_step 8/16)
2025-11-03 16:00:22,315 - INFO -      [4] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 16:00:22,544 - INFO -      [4] ‚úì Batch fetched in 0.228s
2025-11-03 16:00:22,657 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 279.3550 (accum_step 9/16)
2025-11-03 16:00:22,790 - INFO -      [4] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 16:00:22,791 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:22,902 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 281.4515 (accum_step 10/16)
2025-11-03 16:00:23,036 - INFO -      [4] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 16:00:23,036 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:23,064 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 282.4488 (accum_step 11/16)
2025-11-03 16:00:23,097 - INFO -      [4] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 16:00:23,957 - INFO -      [4] ‚úì Batch fetched in 0.860s
2025-11-03 16:00:24,069 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 276.6747 (accum_step 12/16)
2025-11-03 16:00:24,203 - INFO -      [4] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 16:00:24,401 - INFO -      [4] ‚úì Batch fetched in 0.198s
2025-11-03 16:00:24,513 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 273.5849 (accum_step 13/16)
2025-11-03 16:00:24,647 - INFO -      [4] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 16:00:24,647 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:24,758 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 275.4337 (accum_step 14/16)
2025-11-03 16:00:24,891 - INFO -      [4] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 16:00:24,891 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:25,000 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 274.3245 (accum_step 15/16)
2025-11-03 16:00:25,134 - INFO -      [4] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 16:00:25,134 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:25,161 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 276.3428 (accum_step 16/16)
2025-11-03 16:00:25,206 - INFO -   Step 5/10: loss = 277.6104, avg_loss = 287.8943, lr = 0.000011, grad_norm = 327.9969
2025-11-03 16:00:25,206 - INFO -     ‚è±Ô∏è  Timing: total=5.660s (fetch=2.466s, to_device=0.031s, spec_compute=0.010s, forward=0.109s, backward=0.194s, optim=0.010s)
2025-11-03 16:00:25,206 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 16:00:25,783 - INFO -      [5] ‚úì Batch fetched in 0.577s
2025-11-03 16:00:25,895 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 268.5504 (accum_step 1/16)
2025-11-03 16:00:26,029 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 16:00:26,029 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:26,138 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 263.3537 (accum_step 2/16)
2025-11-03 16:00:26,271 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 16:00:26,272 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:26,384 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 270.7921 (accum_step 3/16)
2025-11-03 16:00:26,517 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 16:00:26,518 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:26,630 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 270.2401 (accum_step 4/16)
2025-11-03 16:00:26,763 - INFO -      [5] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 16:00:26,764 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:26,791 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 254.5802 (accum_step 5/16)
2025-11-03 16:00:26,824 - INFO -      [5] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 16:00:27,304 - INFO -      [5] ‚úì Batch fetched in 0.480s
2025-11-03 16:00:27,417 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 270.9994 (accum_step 6/16)
2025-11-03 16:00:27,551 - INFO -      [5] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 16:00:28,082 - INFO -      [5] ‚úì Batch fetched in 0.531s
2025-11-03 16:00:28,193 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 275.2313 (accum_step 7/16)
2025-11-03 16:00:28,327 - INFO -      [5] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 16:00:28,328 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:28,439 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 269.9117 (accum_step 8/16)
2025-11-03 16:00:28,573 - INFO -      [5] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 16:00:28,573 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:28,682 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 270.1384 (accum_step 9/16)
2025-11-03 16:00:28,816 - INFO -      [5] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 16:00:28,817 - INFO -      [5] ‚úì Batch fetched in 0.001s
2025-11-03 16:00:28,844 - INFO -      [5] ‚úì Forward pass completed in 0.011s, loss = 263.7170 (accum_step 10/16)
2025-11-03 16:00:28,878 - INFO -      [5] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 16:00:29,243 - INFO -      [5] ‚úì Batch fetched in 0.365s
2025-11-03 16:00:29,357 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 266.2746 (accum_step 11/16)
2025-11-03 16:00:29,491 - INFO -      [5] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 16:00:29,946 - INFO -      [5] ‚úì Batch fetched in 0.455s
2025-11-03 16:00:30,057 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 268.3343 (accum_step 12/16)
2025-11-03 16:00:30,191 - INFO -      [5] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 16:00:30,288 - INFO -      [5] ‚úì Batch fetched in 0.097s
2025-11-03 16:00:30,400 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 262.1616 (accum_step 13/16)
2025-11-03 16:00:30,534 - INFO -      [5] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 16:00:30,535 - INFO -      [5] ‚úì Batch fetched in 0.001s
2025-11-03 16:00:30,646 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 276.8383 (accum_step 14/16)
2025-11-03 16:00:30,780 - INFO -      [5] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 16:00:30,780 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:30,807 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 261.9277 (accum_step 15/16)
2025-11-03 16:00:30,841 - INFO -      [5] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 16:00:31,834 - INFO -      [5] ‚úì Batch fetched in 0.993s
2025-11-03 16:00:31,944 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 267.1250 (accum_step 16/16)
2025-11-03 16:00:32,087 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 16:00:32,183 - INFO -      [6] ‚úì Batch fetched in 0.096s
2025-11-03 16:00:32,293 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 257.0513 (accum_step 1/16)
2025-11-03 16:00:32,426 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 16:00:32,426 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:32,538 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 265.0361 (accum_step 2/16)
2025-11-03 16:00:32,672 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 16:00:32,672 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:32,783 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.3495 (accum_step 3/16)
2025-11-03 16:00:32,918 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 16:00:32,918 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:32,945 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 266.2018 (accum_step 4/16)
2025-11-03 16:00:32,979 - INFO -      [6] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 16:00:33,862 - INFO -      [6] ‚úì Batch fetched in 0.883s
2025-11-03 16:00:33,974 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 260.3698 (accum_step 5/16)
2025-11-03 16:00:34,108 - INFO -      [6] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 16:00:34,108 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:34,217 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 260.4585 (accum_step 6/16)
2025-11-03 16:00:34,351 - INFO -      [6] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 16:00:34,352 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:34,463 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 261.5896 (accum_step 7/16)
2025-11-03 16:00:34,597 - INFO -      [6] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 16:00:34,597 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:34,711 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 262.6060 (accum_step 8/16)
2025-11-03 16:00:34,845 - INFO -      [6] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 16:00:34,845 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:34,872 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 258.0216 (accum_step 9/16)
2025-11-03 16:00:34,906 - INFO -      [6] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 16:00:36,072 - INFO -      [6] ‚úì Batch fetched in 1.166s
2025-11-03 16:00:36,184 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 263.1217 (accum_step 10/16)
2025-11-03 16:00:36,319 - INFO -      [6] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 16:00:36,357 - INFO -      [6] ‚úì Batch fetched in 0.039s
2025-11-03 16:00:36,466 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 264.8992 (accum_step 11/16)
2025-11-03 16:00:36,600 - INFO -      [6] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 16:00:36,601 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:36,712 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 262.5342 (accum_step 12/16)
2025-11-03 16:00:36,846 - INFO -      [6] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 16:00:36,846 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:36,958 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.3016 (accum_step 13/16)
2025-11-03 16:00:37,092 - INFO -      [6] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 16:00:37,092 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:37,119 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 257.2703 (accum_step 14/16)
2025-11-03 16:00:37,153 - INFO -      [6] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 16:00:38,399 - INFO -      [6] ‚úì Batch fetched in 1.246s
2025-11-03 16:00:38,511 - INFO -      [6] ‚úì Forward pass completed in 0.008s, loss = 258.7437 (accum_step 15/16)
2025-11-03 16:00:38,646 - INFO -      [6] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 16:00:39,016 - INFO -      [6] ‚úì Batch fetched in 0.371s
2025-11-03 16:00:39,128 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 262.3342 (accum_step 16/16)
2025-11-03 16:00:39,271 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 16:00:39,271 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:39,382 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 246.5124 (accum_step 1/16)
2025-11-03 16:00:39,515 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 16:00:39,515 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:39,627 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.7506 (accum_step 2/16)
2025-11-03 16:00:39,761 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 16:00:39,761 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:39,788 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 235.7586 (accum_step 3/16)
2025-11-03 16:00:39,822 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 16:00:40,658 - INFO -      [7] ‚úì Batch fetched in 0.836s
2025-11-03 16:00:40,770 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 251.4610 (accum_step 4/16)
2025-11-03 16:00:40,904 - INFO -      [7] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 16:00:40,905 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:41,016 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 253.8091 (accum_step 5/16)
2025-11-03 16:00:41,149 - INFO -      [7] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 16:00:41,150 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:41,261 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.0898 (accum_step 6/16)
2025-11-03 16:00:41,395 - INFO -      [7] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 16:00:41,395 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:41,506 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.0309 (accum_step 7/16)
2025-11-03 16:00:41,640 - INFO -      [7] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 16:00:41,640 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:41,667 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 247.8404 (accum_step 8/16)
2025-11-03 16:00:41,701 - INFO -      [7] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 16:00:42,762 - INFO -      [7] ‚úì Batch fetched in 1.061s
2025-11-03 16:00:42,875 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 252.5795 (accum_step 9/16)
2025-11-03 16:00:43,009 - INFO -      [7] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 16:00:43,432 - INFO -      [7] ‚úì Batch fetched in 0.424s
2025-11-03 16:00:43,544 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 255.4771 (accum_step 10/16)
2025-11-03 16:00:43,678 - INFO -      [7] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 16:00:43,678 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:43,788 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.5897 (accum_step 11/16)
2025-11-03 16:00:43,921 - INFO -      [7] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 16:00:43,921 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:44,032 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 250.6107 (accum_step 12/16)
2025-11-03 16:00:44,166 - INFO -      [7] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 16:00:44,167 - INFO -      [7] ‚úì Batch fetched in 0.001s
2025-11-03 16:00:44,194 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 258.9622 (accum_step 13/16)
2025-11-03 16:00:44,228 - INFO -      [7] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 16:00:45,216 - INFO -      [7] ‚úì Batch fetched in 0.988s
2025-11-03 16:00:45,329 - INFO -      [7] ‚úì Forward pass completed in 0.008s, loss = 248.2088 (accum_step 14/16)
2025-11-03 16:00:45,463 - INFO -      [7] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 16:00:45,472 - INFO -      [7] ‚úì Batch fetched in 0.008s
2025-11-03 16:00:45,582 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 250.6952 (accum_step 15/16)
2025-11-03 16:00:45,716 - INFO -      [7] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 16:00:45,716 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:45,825 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 251.5065 (accum_step 16/16)
2025-11-03 16:00:45,969 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 16:00:45,969 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:46,080 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 235.4636 (accum_step 1/16)
2025-11-03 16:00:46,213 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 16:00:46,213 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:46,240 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 223.5231 (accum_step 2/16)
2025-11-03 16:00:46,274 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 16:00:47,379 - INFO -      [8] ‚úì Batch fetched in 1.106s
2025-11-03 16:00:47,492 - INFO -      [8] ‚úì Forward pass completed in 0.008s, loss = 241.5865 (accum_step 3/16)
2025-11-03 16:00:47,626 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 16:00:47,627 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:47,736 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 236.8646 (accum_step 4/16)
2025-11-03 16:00:47,870 - INFO -      [8] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 16:00:47,870 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:47,981 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 237.7748 (accum_step 5/16)
2025-11-03 16:00:48,114 - INFO -      [8] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 16:00:48,114 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:48,223 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 238.4548 (accum_step 6/16)
2025-11-03 16:00:48,357 - INFO -      [8] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 16:00:48,357 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:48,384 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 239.5417 (accum_step 7/16)
2025-11-03 16:00:48,418 - INFO -      [8] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 16:00:49,552 - INFO -      [8] ‚úì Batch fetched in 1.134s
2025-11-03 16:00:49,665 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 236.6440 (accum_step 8/16)
2025-11-03 16:00:49,799 - INFO -      [8] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 16:00:49,800 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:49,910 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 239.0314 (accum_step 9/16)
2025-11-03 16:00:50,043 - INFO -      [8] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 16:00:50,044 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:50,152 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 236.9597 (accum_step 10/16)
2025-11-03 16:00:50,286 - INFO -      [8] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 16:00:50,286 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:50,397 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 237.8947 (accum_step 11/16)
2025-11-03 16:00:50,531 - INFO -      [8] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 16:00:50,532 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:50,559 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 242.5211 (accum_step 12/16)
2025-11-03 16:00:50,592 - INFO -      [8] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 16:00:51,556 - INFO -      [8] ‚úì Batch fetched in 0.964s
2025-11-03 16:00:51,668 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 239.3761 (accum_step 13/16)
2025-11-03 16:00:51,802 - INFO -      [8] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 16:00:52,112 - INFO -      [8] ‚úì Batch fetched in 0.309s
2025-11-03 16:00:52,224 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 235.9805 (accum_step 14/16)
2025-11-03 16:00:52,357 - INFO -      [8] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 16:00:52,358 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:52,468 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 241.0225 (accum_step 15/16)
2025-11-03 16:00:52,602 - INFO -      [8] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 16:00:52,602 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:52,713 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 238.2320 (accum_step 16/16)
2025-11-03 16:00:52,856 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/16)...
2025-11-03 16:00:52,856 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:52,883 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 229.0967 (accum_step 1/16)
2025-11-03 16:00:52,916 - INFO -      [9] Fetching batch from DataLoader (accum_step 2/16)...
2025-11-03 16:00:54,017 - INFO -      [9] ‚úì Batch fetched in 1.101s
2025-11-03 16:00:54,130 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 220.7081 (accum_step 2/16)
2025-11-03 16:00:54,263 - INFO -      [9] Fetching batch from DataLoader (accum_step 3/16)...
2025-11-03 16:00:54,292 - INFO -      [9] ‚úì Batch fetched in 0.029s
2025-11-03 16:00:54,403 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 221.2829 (accum_step 3/16)
2025-11-03 16:00:54,537 - INFO -      [9] Fetching batch from DataLoader (accum_step 4/16)...
2025-11-03 16:00:54,538 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:54,647 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 223.7849 (accum_step 4/16)
2025-11-03 16:00:54,780 - INFO -      [9] Fetching batch from DataLoader (accum_step 5/16)...
2025-11-03 16:00:54,781 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:54,892 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 223.0844 (accum_step 5/16)
2025-11-03 16:00:55,026 - INFO -      [9] Fetching batch from DataLoader (accum_step 6/16)...
2025-11-03 16:00:55,026 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:55,053 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 224.9855 (accum_step 6/16)
2025-11-03 16:00:55,087 - INFO -      [9] Fetching batch from DataLoader (accum_step 7/16)...
2025-11-03 16:00:56,090 - INFO -      [9] ‚úì Batch fetched in 1.004s
2025-11-03 16:00:56,203 - INFO -      [9] ‚úì Forward pass completed in 0.007s, loss = 222.1826 (accum_step 7/16)
2025-11-03 16:00:56,336 - INFO -      [9] Fetching batch from DataLoader (accum_step 8/16)...
2025-11-03 16:00:56,336 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:56,448 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 222.1464 (accum_step 8/16)
2025-11-03 16:00:56,581 - INFO -      [9] Fetching batch from DataLoader (accum_step 9/16)...
2025-11-03 16:00:56,582 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:56,693 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 228.6918 (accum_step 9/16)
2025-11-03 16:00:56,826 - INFO -      [9] Fetching batch from DataLoader (accum_step 10/16)...
2025-11-03 16:00:56,826 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:56,935 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 226.7051 (accum_step 10/16)
2025-11-03 16:00:57,069 - INFO -      [9] Fetching batch from DataLoader (accum_step 11/16)...
2025-11-03 16:00:57,069 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:57,097 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 223.3077 (accum_step 11/16)
2025-11-03 16:00:57,130 - INFO -      [9] Fetching batch from DataLoader (accum_step 12/16)...
2025-11-03 16:00:58,555 - INFO -      [9] ‚úì Batch fetched in 1.425s
2025-11-03 16:00:58,667 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 227.4846 (accum_step 12/16)
2025-11-03 16:00:58,801 - INFO -      [9] Fetching batch from DataLoader (accum_step 13/16)...
2025-11-03 16:00:58,801 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:58,912 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 225.9557 (accum_step 13/16)
2025-11-03 16:00:59,046 - INFO -      [9] Fetching batch from DataLoader (accum_step 14/16)...
2025-11-03 16:00:59,046 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:59,157 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 225.7831 (accum_step 14/16)
2025-11-03 16:00:59,291 - INFO -      [9] Fetching batch from DataLoader (accum_step 15/16)...
2025-11-03 16:00:59,291 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:59,400 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 221.9458 (accum_step 15/16)
2025-11-03 16:00:59,534 - INFO -      [9] Fetching batch from DataLoader (accum_step 16/16)...
2025-11-03 16:00:59,534 - INFO -      [9] ‚úì Batch fetched in 0.000s
2025-11-03 16:00:59,561 - INFO -      [9] ‚úì Forward pass completed in 0.006s, loss = 221.9043 (accum_step 16/16)
2025-11-03 16:00:59,603 - INFO -   Step 10/10: loss = 224.3156, avg_loss = 268.0713, lr = 0.000021, grad_norm = 276.8614
2025-11-03 16:00:59,603 - INFO -     ‚è±Ô∏è  Timing: total=6.748s (fetch=3.562s, to_device=0.032s, spec_compute=0.008s, forward=0.100s, backward=0.170s, optim=0.009s)
2025-11-03 16:00:59,604 - INFO - 
================================================================================
2025-11-03 16:00:59,604 - INFO - TRAINING SUMMARY:
2025-11-03 16:00:59,604 - INFO -   Steps Completed: 10
2025-11-03 16:00:59,604 - INFO -   Average Loss: 268.0713
2025-11-03 16:00:59,604 - INFO -   Best Validation Loss: inf
2025-11-03 16:00:59,604 - INFO - ================================================================================
2025-11-03 16:00:59,604 - INFO - 
================================================================================
2025-11-03 16:00:59,604 - INFO - TRAINING COMPLETED
2025-11-03 16:00:59,604 - INFO - Configuration: A100_pretraining_test
2025-11-03 16:00:59,604 - INFO - Final step: 10
2025-11-03 16:00:59,604 - INFO - Checkpoints saved to: /cluster/home/ahmedyz/yassine/MT3-pytorch/checkpoint
2025-11-03 16:00:59,605 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 16:00:59,605 - INFO - ================================================================================
2025-11-03 16:01:29,539 - INFO - ================================================================================
2025-11-03 16:01:29,539 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 16:01:29,539 - INFO - ================================================================================
2025-11-03 16:01:29,539 - INFO - Configuration: A100_pretraining_test
2025-11-03 16:01:29,539 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 16:01:29,539 - INFO - ================================================================================
2025-11-03 16:01:29,541 - INFO - Device: cuda
2025-11-03 16:01:29,541 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 16:01:29,541 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 16:01:29,541 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 16:01:29,541 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 16:01:29,541 - INFO -   Batch size: 256, Steps: 10
2025-11-03 16:01:29,541 - INFO -   Validation interval: 20 steps
2025-11-03 16:01:29,541 - INFO -   Log interval: 5 steps
2025-11-03 16:01:29,541 - INFO - 
Initializing model...
2025-11-03 16:01:30,116 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 16:01:30,117 - INFO -   Total parameters: 44,674,663
2025-11-03 16:01:30,117 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 16:01:33,375 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 16:01:33,375 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 16:01:33,384 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 16:01:33,384 - INFO - 
Setting up datasets...
2025-11-03 16:01:33,384 - INFO -   Loading MAESTRO dataset...
2025-11-03 16:01:33,388 - INFO -   ‚úì MAESTRO train: 20 samples (cached)
2025-11-03 16:01:33,389 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 16:01:33,389 - INFO -   Loading SLAKH stems dataset...
2025-11-03 16:01:34,074 - INFO -   ‚úì SLAKH stems train: 209 samples (cached)
2025-11-03 16:01:34,514 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 16:01:34,514 - INFO -   Loading SLAKH mix dataset...
2025-11-03 16:01:34,572 - INFO -   ‚úì SLAKH mix train: 20 samples (cached)
2025-11-03 16:01:34,625 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 16:01:34,625 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 16:01:34,688 - INFO -   ‚úì SLAKH mixed train: 20 samples (cached)
2025-11-03 16:01:34,736 - INFO -   ‚úì SLAKH mixed val: 20 samples (cached)
2025-11-03 16:01:34,736 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 16:01:34,736 - INFO -   Warming train cache for maestro dataset before forking workers...
2025-11-03 16:01:35,018 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 16:01:35,785 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 16:01:36,550 - INFO -   Warming validation cache for maestro dataset before forking workers...
2025-11-03 16:01:36,773 - INFO -   Warming validation cache for slakh_stems dataset before forking workers...
2025-11-03 16:01:37,461 - INFO -   Warming validation cache for slakh_mix dataset before forking workers...
2025-11-03 16:01:38,144 - INFO - 
  Creating multi-task dataset...
2025-11-03 16:01:38,144 - INFO -   ‚úì Multi-task dataset: 269 total samples
2025-11-03 16:01:38,144 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 16:01:38,144 - INFO - 
  Setting up validation data...
2025-11-03 16:01:38,144 - INFO -   ‚úì Validation: 267 samples
2025-11-03 16:01:38,146 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 16:01:38,146 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 16:01:38,146 - INFO -   Label smoothing: 0.1
2025-11-03 16:01:38,146 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 16:01:38,146 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 16:01:38,147 - INFO - 
Starting training...
2025-11-03 16:01:38,147 - INFO -   Total steps: 10
2025-11-03 16:01:38,147 - INFO -   Batch size: 256
2025-11-03 16:01:38,147 - INFO -   Learning rate: 0.0001
2025-11-03 16:01:38,147 - INFO -   Weight decay: 0.1
2025-11-03 16:01:38,147 - INFO -   Log interval: 5 steps
2025-11-03 16:01:38,147 - INFO -   Validation interval: 20 steps
2025-11-03 16:01:38,147 - INFO -   Save interval: 100 steps
2025-11-03 16:01:38,148 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 16:01:38,199 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 16:01:38,199 - INFO - 
================================================================================
2025-11-03 16:01:38,199 - INFO - STEP-BASED TRAINING
2025-11-03 16:01:38,199 - INFO -   Starting from step: 0
2025-11-03 16:01:38,199 - INFO -   Target steps: 10
2025-11-03 16:01:38,199 - INFO -   Batch size: 256
2025-11-03 16:01:38,199 - INFO -   Gradient accumulation steps: 4
2025-11-03 16:01:38,199 - INFO -   Effective batch size: 1024
2025-11-03 16:01:38,200 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 16:01:38,200 - INFO - ================================================================================
2025-11-03 16:01:38,200 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 16:01:38,200 - INFO - 
üöÄ Starting training loop...
2025-11-03 16:01:38,200 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 16:01:38,200 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:01:44,180 - INFO -      [0] ‚úì Batch fetched in 5.980s
2025-11-03 16:01:44,180 - INFO -      [0] Moving data to device cuda...
2025-11-03 16:01:44,188 - INFO -      [0] ‚úì Data moved to device in 0.007s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:01:44,590 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.402s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:01:44,590 - INFO -      [0] Starting forward pass...
2025-11-03 16:01:47,341 - INFO -      [0] ‚úì Forward pass completed in 2.751s, loss = 291.1472 (accum_step 1/4)
2025-11-03 16:01:47,341 - INFO -      [0] Starting backward pass...
2025-11-03 16:01:47,892 - INFO -      [0] ‚úì Backward pass completed in 0.551s
2025-11-03 16:01:47,938 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:01:47,938 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 16:01:47,938 - INFO -      [0] Moving data to device cuda...
2025-11-03 16:01:47,939 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 16:01:47,940 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.002s (shape: torch.Size([13, 256, 512]))
2025-11-03 16:01:47,941 - INFO -      [0] Starting forward pass...
2025-11-03 16:01:50,588 - INFO -      [0] ‚úì Forward pass completed in 2.639s, loss = 300.3485 (accum_step 2/4)
2025-11-03 16:01:50,588 - INFO -      [0] Starting backward pass...
2025-11-03 16:01:50,669 - INFO -      [0] ‚úì Backward pass completed in 0.080s
2025-11-03 16:01:50,669 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:01:53,980 - INFO -      [0] ‚úì Batch fetched in 3.311s
2025-11-03 16:01:53,980 - INFO -      [0] Moving data to device cuda...
2025-11-03 16:01:53,983 - INFO -      [0] ‚úì Data moved to device in 0.003s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:01:53,984 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:01:53,984 - INFO -      [0] Starting forward pass...
2025-11-03 16:01:54,432 - INFO -      [0] ‚úì Forward pass completed in 0.007s, loss = 293.9425 (accum_step 3/4)
2025-11-03 16:01:54,432 - INFO -      [0] Starting backward pass...
2025-11-03 16:01:54,443 - INFO -      [0] ‚úì Backward pass completed in 0.012s
2025-11-03 16:01:54,945 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:01:54,945 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 16:01:54,945 - INFO -      [0] Moving data to device cuda...
2025-11-03 16:01:54,946 - INFO -      [0] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 16:01:54,946 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 16:01:54,947 - INFO -      [0] Starting forward pass...
2025-11-03 16:01:54,973 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 292.1335 (accum_step 4/4)
2025-11-03 16:01:54,973 - INFO -      [0] Starting backward pass...
2025-11-03 16:01:54,984 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 16:01:55,006 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 16:01:55,118 - INFO -      [0] ‚úì Optimizer step completed in 0.112s, grad_norm = 326.7719
2025-11-03 16:01:55,118 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:01:58,714 - INFO -      [1] ‚úì Batch fetched in 3.596s
2025-11-03 16:01:58,714 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:01:58,721 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:01:58,738 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.017s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:01:58,738 - INFO -      [1] Starting forward pass...
2025-11-03 16:01:59,173 - INFO -      [1] ‚úì Forward pass completed in 0.039s, loss = 295.6741 (accum_step 1/4)
2025-11-03 16:01:59,174 - INFO -      [1] Starting backward pass...
2025-11-03 16:01:59,187 - INFO -      [1] ‚úì Backward pass completed in 0.013s
2025-11-03 16:01:59,686 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:01:59,686 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:01:59,687 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:01:59,687 - INFO -      [1] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 16:01:59,688 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 16:01:59,688 - INFO -      [1] Starting forward pass...
2025-11-03 16:01:59,714 - INFO -      [1] ‚úì Forward pass completed in 0.009s, loss = 304.1199 (accum_step 2/4)
2025-11-03 16:01:59,714 - INFO -      [1] Starting backward pass...
2025-11-03 16:01:59,729 - INFO -      [1] ‚úì Backward pass completed in 0.015s
2025-11-03 16:01:59,748 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:02:02,811 - INFO -      [1] ‚úì Batch fetched in 3.063s
2025-11-03 16:02:02,811 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:02:02,819 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:02:02,820 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:02:02,820 - INFO -      [1] Starting forward pass...
2025-11-03 16:02:03,249 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 289.3441 (accum_step 3/4)
2025-11-03 16:02:03,250 - INFO -      [1] Starting backward pass...
2025-11-03 16:02:03,263 - INFO -      [1] ‚úì Backward pass completed in 0.013s
2025-11-03 16:02:03,763 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:02:03,763 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:03,763 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:02:03,764 - INFO -      [1] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 16:02:03,765 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([13, 256, 512]))
2025-11-03 16:02:03,765 - INFO -      [1] Starting forward pass...
2025-11-03 16:02:03,791 - INFO -      [1] ‚úì Forward pass completed in 0.006s, loss = 306.0600 (accum_step 4/4)
2025-11-03 16:02:03,791 - INFO -      [1] Starting backward pass...
2025-11-03 16:02:03,801 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 16:02:03,825 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 16:02:03,833 - INFO -      [1] ‚úì Optimizer step completed in 0.008s, grad_norm = 332.1068
2025-11-03 16:02:03,833 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:02:06,118 - INFO -      [2] ‚úì Batch fetched in 2.285s
2025-11-03 16:02:06,119 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:02:06,126 - INFO -      [2] ‚úì Data moved to device in 0.008s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:02:06,127 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:02:06,127 - INFO -      [2] Starting forward pass...
2025-11-03 16:02:06,567 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 286.4581 (accum_step 1/4)
2025-11-03 16:02:06,567 - INFO -      [2] Starting backward pass...
2025-11-03 16:02:06,577 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 16:02:07,079 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:02:07,079 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:07,079 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:02:07,080 - INFO -      [2] ‚úì Data moved to device in 0.001s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 16:02:07,081 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 16:02:07,081 - INFO -      [2] Starting forward pass...
2025-11-03 16:02:07,107 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 285.5686 (accum_step 2/4)
2025-11-03 16:02:07,107 - INFO -      [2] Starting backward pass...
2025-11-03 16:02:07,117 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 16:02:07,140 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:02:11,159 - INFO -      [2] ‚úì Batch fetched in 4.019s
2025-11-03 16:02:11,159 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:02:11,167 - INFO -      [2] ‚úì Data moved to device in 0.007s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:02:11,168 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:02:11,168 - INFO -      [2] Starting forward pass...
2025-11-03 16:02:11,610 - INFO -      [2] ‚úì Forward pass completed in 0.007s, loss = 288.9672 (accum_step 3/4)
2025-11-03 16:02:11,611 - INFO -      [2] Starting backward pass...
2025-11-03 16:02:11,621 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 16:02:12,123 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:02:12,123 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:12,123 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:02:12,124 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([13, 256, 128]), targets: torch.Size([13, 1024]))
2025-11-03 16:02:12,124 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.000s (shape: torch.Size([13, 256, 512]))
2025-11-03 16:02:12,124 - INFO -      [2] Starting forward pass...
2025-11-03 16:02:12,151 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 284.7724 (accum_step 4/4)
2025-11-03 16:02:12,151 - INFO -      [2] Starting backward pass...
2025-11-03 16:02:12,161 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 16:02:12,184 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 16:02:12,193 - INFO -      [2] ‚úì Optimizer step completed in 0.008s, grad_norm = 324.2001
2025-11-03 16:02:12,193 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:02:16,397 - INFO -      [3] ‚úì Batch fetched in 4.204s
2025-11-03 16:02:16,849 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 285.3671 (accum_step 1/4)
2025-11-03 16:02:17,360 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:02:17,361 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:17,388 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 290.2548 (accum_step 2/4)
2025-11-03 16:02:17,422 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:02:21,795 - INFO -      [3] ‚úì Batch fetched in 4.373s
2025-11-03 16:02:22,249 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 283.4199 (accum_step 3/4)
2025-11-03 16:02:22,762 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:02:22,762 - INFO -      [3] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:22,790 - INFO -      [3] ‚úì Forward pass completed in 0.006s, loss = 287.2065 (accum_step 4/4)
2025-11-03 16:02:22,832 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:02:26,385 - INFO -      [4] ‚úì Batch fetched in 3.553s
2025-11-03 16:02:26,831 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 279.1799 (accum_step 1/4)
2025-11-03 16:02:27,343 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:02:27,344 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:27,371 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 281.6130 (accum_step 2/4)
2025-11-03 16:02:27,404 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:02:31,319 - INFO -      [4] ‚úì Batch fetched in 3.914s
2025-11-03 16:02:31,756 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 276.7735 (accum_step 3/4)
2025-11-03 16:02:32,269 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:02:32,269 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:32,297 - INFO -      [4] ‚úì Forward pass completed in 0.006s, loss = 282.5694 (accum_step 4/4)
2025-11-03 16:02:32,339 - INFO -   Step 5/10: loss = 280.0340, avg_loss = 289.2460, lr = 0.000011, grad_norm = 330.5103
2025-11-03 16:02:32,339 - INFO -     ‚è±Ô∏è  Timing: total=9.507s (fetch=7.468s, to_device=0.005s, spec_compute=0.002s, forward=0.025s, backward=0.041s, optim=0.008s)
2025-11-03 16:02:32,339 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:02:36,239 - INFO -      [5] ‚úì Batch fetched in 3.900s
2025-11-03 16:02:36,696 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 272.9543 (accum_step 1/4)
2025-11-03 16:02:37,207 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:02:37,208 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:37,235 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 283.3610 (accum_step 2/4)
2025-11-03 16:02:37,268 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:02:40,224 - INFO -      [5] ‚úì Batch fetched in 2.956s
2025-11-03 16:02:40,661 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 270.1338 (accum_step 3/4)
2025-11-03 16:02:41,174 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:02:41,174 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:41,202 - INFO -      [5] ‚úì Forward pass completed in 0.006s, loss = 255.4208 (accum_step 4/4)
2025-11-03 16:02:41,244 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:02:44,442 - INFO -      [6] ‚úì Batch fetched in 3.198s
2025-11-03 16:02:44,876 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 259.7195 (accum_step 1/4)
2025-11-03 16:02:45,388 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:02:45,389 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:45,416 - INFO -      [6] ‚úì Forward pass completed in 0.007s, loss = 247.9162 (accum_step 2/4)
2025-11-03 16:02:45,450 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:02:49,129 - INFO -      [6] ‚úì Batch fetched in 3.680s
2025-11-03 16:02:49,576 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.3831 (accum_step 3/4)
2025-11-03 16:02:50,089 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:02:50,089 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:50,116 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 262.4940 (accum_step 4/4)
2025-11-03 16:02:50,158 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:02:53,577 - INFO -      [7] ‚úì Batch fetched in 3.419s
2025-11-03 16:02:54,025 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.2453 (accum_step 1/4)
2025-11-03 16:02:54,537 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:02:54,538 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:54,565 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 248.8200 (accum_step 2/4)
2025-11-03 16:02:54,599 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:02:58,308 - INFO -      [7] ‚úì Batch fetched in 3.709s
2025-11-03 16:02:58,742 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 249.9443 (accum_step 3/4)
2025-11-03 16:02:59,254 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:02:59,254 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:02:59,282 - INFO -      [7] ‚úì Forward pass completed in 0.006s, loss = 236.6991 (accum_step 4/4)
2025-11-03 16:02:59,324 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:03:01,787 - INFO -      [8] ‚úì Batch fetched in 2.463s
2025-11-03 16:03:02,238 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 237.6671 (accum_step 1/4)
2025-11-03 16:03:02,751 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:03:02,751 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:03:02,778 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 241.5454 (accum_step 2/4)
2025-11-03 16:03:02,812 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:03:10,889 - INFO - ================================================================================
2025-11-03 16:03:10,889 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 16:03:10,889 - INFO - ================================================================================
2025-11-03 16:03:10,889 - INFO - Configuration: A100_pretraining_test
2025-11-03 16:03:10,889 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 16:03:10,889 - INFO - ================================================================================
2025-11-03 16:03:10,890 - INFO - Device: cuda
2025-11-03 16:03:10,890 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 16:03:10,890 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 16:03:10,891 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 16:03:10,891 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 16:03:10,891 - INFO -   Batch size: 256, Steps: 10
2025-11-03 16:03:10,891 - INFO -   Validation interval: 20 steps
2025-11-03 16:03:10,891 - INFO -   Log interval: 5 steps
2025-11-03 16:03:10,891 - INFO - 
Initializing model...
2025-11-03 16:03:11,406 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 16:03:11,407 - INFO -   Total parameters: 44,674,663
2025-11-03 16:03:11,407 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 16:03:14,470 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 16:03:14,470 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 16:03:14,478 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 16:03:14,479 - INFO - 
Setting up datasets...
2025-11-03 16:03:14,479 - INFO -   Loading MAESTRO dataset...
2025-11-03 16:03:14,582 - INFO -     Loading MAESTRO samples...
2025-11-03 16:03:18,717 - INFO - Loaded 20 MAESTRO samples
2025-11-03 16:03:19,200 - INFO - Loaded 40 MAESTRO samples
2025-11-03 16:03:19,591 - INFO - Loaded 60 MAESTRO samples
2025-11-03 16:03:20,213 - INFO - Loaded 80 MAESTRO samples
2025-11-03 16:03:20,751 - INFO -   ‚úì MAESTRO: 100 samples
2025-11-03 16:03:20,751 - INFO -   Loading SLAKH stems dataset...
2025-11-03 16:03:23,599 - INFO -   ‚úì SLAKH stems: 1140 samples
2025-11-03 16:03:23,599 - INFO -   Loading SLAKH mix dataset...
2025-11-03 16:03:23,653 - INFO -   ‚úì SLAKH mix: 100 samples
2025-11-03 16:03:23,654 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 16:03:23,711 - INFO -   ‚úì SLAKH mixed: 100 samples
2025-11-03 16:03:23,712 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 16:03:23,712 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 16:06:10,371 - INFO - ================================================================================
2025-11-03 16:06:10,371 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 16:06:10,371 - INFO - ================================================================================
2025-11-03 16:06:10,371 - INFO - Configuration: A100_pretraining_test
2025-11-03 16:06:10,371 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 16:06:10,371 - INFO - ================================================================================
2025-11-03 16:06:10,372 - INFO - Device: cuda
2025-11-03 16:06:10,373 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 16:06:10,373 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 16:06:10,373 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 16:06:10,373 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 16:06:10,373 - INFO -   Batch size: 256, Steps: 10
2025-11-03 16:06:10,373 - INFO -   Validation interval: 20 steps
2025-11-03 16:06:10,373 - INFO -   Log interval: 5 steps
2025-11-03 16:06:10,373 - INFO - 
Initializing model...
2025-11-03 16:06:10,868 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 16:06:10,869 - INFO -   Total parameters: 44,674,663
2025-11-03 16:06:10,869 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 16:06:13,904 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 16:06:13,904 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 16:06:13,912 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 16:06:13,913 - INFO - 
Setting up datasets...
2025-11-03 16:06:13,913 - INFO -   Loading MAESTRO dataset...
2025-11-03 16:06:13,965 - INFO -     Loading MAESTRO samples...
2025-11-03 16:06:16,101 - INFO - Loaded 20 MAESTRO samples
2025-11-03 16:06:16,498 - INFO - Loaded 40 MAESTRO samples
2025-11-03 16:06:16,910 - INFO - Loaded 60 MAESTRO samples
2025-11-03 16:06:17,314 - INFO - Loaded 80 MAESTRO samples
2025-11-03 16:06:17,732 - INFO -   ‚úì MAESTRO: 100 samples
2025-11-03 16:06:17,733 - INFO -   Loading SLAKH stems dataset...
2025-11-03 16:06:18,281 - INFO -   ‚úì SLAKH stems: 1140 samples
2025-11-03 16:06:18,281 - INFO -   Loading SLAKH mix dataset...
2025-11-03 16:06:18,332 - INFO -   ‚úì SLAKH mix: 100 samples
2025-11-03 16:06:18,332 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 16:06:18,385 - INFO -   ‚úì SLAKH mixed: 100 samples
2025-11-03 16:06:18,385 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 16:06:18,385 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 16:06:56,177 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 16:09:08,835 - INFO - ================================================================================
2025-11-03 16:09:08,835 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 16:09:08,836 - INFO - ================================================================================
2025-11-03 16:09:08,836 - INFO - Configuration: A100_pretraining_test
2025-11-03 16:09:08,836 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 16:09:08,836 - INFO - ================================================================================
2025-11-03 16:09:08,837 - INFO - Device: cuda
2025-11-03 16:09:08,837 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 16:09:08,837 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 16:09:08,837 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 16:09:08,837 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 16:09:08,837 - INFO -   Batch size: 256, Steps: 10
2025-11-03 16:09:08,837 - INFO -   Validation interval: 20 steps
2025-11-03 16:09:08,837 - INFO -   Log interval: 5 steps
2025-11-03 16:09:08,837 - INFO - 
Initializing model...
2025-11-03 16:09:09,382 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 16:09:09,383 - INFO -   Total parameters: 44,674,663
2025-11-03 16:09:09,383 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 16:09:12,430 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 16:09:12,430 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 16:09:12,439 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 16:09:12,439 - INFO - 
Setting up datasets...
2025-11-03 16:09:12,439 - INFO -   Loading MAESTRO dataset...
2025-11-03 16:09:12,505 - INFO -     Loading MAESTRO samples...
2025-11-03 16:09:15,157 - INFO - Loaded 20 MAESTRO samples
2025-11-03 16:09:16,034 - INFO - Loaded 40 MAESTRO samples
2025-11-03 16:09:17,574 - INFO - Loaded 60 MAESTRO samples
2025-11-03 16:09:19,256 - INFO - Loaded 80 MAESTRO samples
2025-11-03 16:09:20,587 - INFO -   ‚úì MAESTRO: 100 samples
2025-11-03 16:09:20,587 - INFO -   Loading SLAKH stems dataset...
2025-11-03 16:09:21,148 - INFO -   ‚úì SLAKH stems: 1140 samples
2025-11-03 16:09:21,148 - INFO -   Loading SLAKH mix dataset...
2025-11-03 16:09:21,211 - INFO -   ‚úì SLAKH mix: 100 samples
2025-11-03 16:09:21,212 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 16:09:21,266 - INFO -   ‚úì SLAKH mixed: 100 samples
2025-11-03 16:09:21,266 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 16:09:21,267 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 16:09:53,390 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 16:13:05,939 - INFO - 
  Dataset timing summary (s): maestro_train_s=3.82, slakh_mix_train_s=0.05, slakh_mixed_train_s=0.05, slakh_stems_train_s=0.55, warm_caches_s=407.55
2025-11-03 16:13:05,939 - INFO - 
  Creating multi-task dataset...
2025-11-03 16:13:05,939 - INFO -   ‚úì Multi-task dataset: 1440 total samples
2025-11-03 16:13:05,939 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 16:13:05,939 - INFO - 
  Setting up validation data...
2025-11-03 16:13:05,939 - WARNING -   ! No validation datasets loaded
2025-11-03 16:13:05,940 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 16:13:05,941 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 16:13:05,941 - INFO -   Label smoothing: 0.1
2025-11-03 16:13:05,941 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 16:13:05,941 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 16:13:05,941 - INFO - 
Starting training...
2025-11-03 16:13:05,941 - INFO -   Total steps: 10
2025-11-03 16:13:05,941 - INFO -   Batch size: 256
2025-11-03 16:13:05,941 - INFO -   Learning rate: 0.0001
2025-11-03 16:13:05,941 - INFO -   Weight decay: 0.1
2025-11-03 16:13:05,941 - INFO -   Log interval: 5 steps
2025-11-03 16:13:05,941 - INFO -   Validation interval: 20 steps
2025-11-03 16:13:05,941 - INFO -   Save interval: 100 steps
2025-11-03 16:13:05,943 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 16:13:06,089 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 16:13:06,089 - INFO - 
================================================================================
2025-11-03 16:13:06,089 - INFO - STEP-BASED TRAINING
2025-11-03 16:13:06,089 - INFO -   Starting from step: 0
2025-11-03 16:13:06,089 - INFO -   Target steps: 10
2025-11-03 16:13:06,089 - INFO -   Batch size: 256
2025-11-03 16:13:06,089 - INFO -   Gradient accumulation steps: 4
2025-11-03 16:13:06,089 - INFO -   Effective batch size: 1024
2025-11-03 16:13:06,089 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 16:13:06,089 - INFO - ================================================================================
2025-11-03 16:13:06,089 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 16:13:06,089 - INFO - 
üöÄ Starting training loop...
2025-11-03 16:13:06,089 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 16:13:06,089 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:13:58,480 - INFO - 
  Dataset timing summary (s): maestro_train_s=8.15, slakh_mix_train_s=0.06, slakh_mixed_train_s=0.05, slakh_stems_train_s=0.56, warm_caches_s=277.21
2025-11-03 16:13:58,481 - INFO - 
  Creating multi-task dataset...
2025-11-03 16:13:58,481 - INFO -   ‚úì Multi-task dataset: 1440 total samples
2025-11-03 16:13:58,481 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 16:13:58,481 - INFO - 
  Setting up validation data...
2025-11-03 16:13:58,481 - WARNING -   ! No validation datasets loaded
2025-11-03 16:13:58,482 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 16:13:58,483 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 16:13:58,483 - INFO -   Label smoothing: 0.1
2025-11-03 16:13:58,483 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 16:13:58,483 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 16:13:58,483 - INFO - 
Starting training...
2025-11-03 16:13:58,483 - INFO -   Total steps: 10
2025-11-03 16:13:58,483 - INFO -   Batch size: 256
2025-11-03 16:13:58,483 - INFO -   Learning rate: 0.0001
2025-11-03 16:13:58,483 - INFO -   Weight decay: 0.1
2025-11-03 16:13:58,483 - INFO -   Log interval: 5 steps
2025-11-03 16:13:58,483 - INFO -   Validation interval: 20 steps
2025-11-03 16:13:58,483 - INFO -   Save interval: 100 steps
2025-11-03 16:13:58,484 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 16:13:58,627 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 16:13:58,627 - INFO - 
================================================================================
2025-11-03 16:13:58,627 - INFO - STEP-BASED TRAINING
2025-11-03 16:13:58,628 - INFO -   Starting from step: 0
2025-11-03 16:13:58,628 - INFO -   Target steps: 10
2025-11-03 16:13:58,628 - INFO -   Batch size: 256
2025-11-03 16:13:58,628 - INFO -   Gradient accumulation steps: 4
2025-11-03 16:13:58,628 - INFO -   Effective batch size: 1024
2025-11-03 16:13:58,628 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 16:13:58,628 - INFO - ================================================================================
2025-11-03 16:13:58,628 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 16:13:58,628 - INFO - 
üöÄ Starting training loop...
2025-11-03 16:13:58,628 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 16:13:58,628 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:15:15,564 - INFO - ================================================================================
2025-11-03 16:15:15,564 - INFO - MULTITRACK TRAINING - MAESTRO + SLAKH
2025-11-03 16:15:15,564 - INFO - ================================================================================
2025-11-03 16:15:15,564 - INFO - Configuration: A100_pretraining_test
2025-11-03 16:15:15,564 - INFO - Log file: /cluster/home/ahmedyz/yassine/MT3-pytorch/test_outputs/train_multitrack.log
2025-11-03 16:15:15,564 - INFO - ================================================================================
2025-11-03 16:15:15,565 - INFO - Device: cuda
2025-11-03 16:15:15,565 - INFO -   ‚úì Flash Attention backends enabled
2025-11-03 16:15:15,566 - INFO -   ‚úì TensorFloat32 enabled for faster matmul
2025-11-03 16:15:15,566 - INFO - 
Loaded config: A100_pretraining_test
2025-11-03 16:15:15,566 - INFO -   Datasets: MAESTRO=True, SLAKH_stems=True, SLAKH_mix=True, SLAKH_mixed=True
2025-11-03 16:15:15,566 - INFO -   Batch size: 256, Steps: 10
2025-11-03 16:15:15,566 - INFO -   Validation interval: 20 steps
2025-11-03 16:15:15,566 - INFO -   Log interval: 5 steps
2025-11-03 16:15:15,566 - INFO - 
Initializing model...
2025-11-03 16:15:16,185 - INFO -   ‚úì Flash Attention enabled in model
2025-11-03 16:15:16,186 - INFO -   Total parameters: 44,674,663
2025-11-03 16:15:16,186 - INFO - 
‚ö° Compiling model with torch.compile()...
2025-11-03 16:15:19,342 - INFO -   ‚úì Model compiled (mode=default)
2025-11-03 16:15:19,342 - INFO -   Note: First batch will be slower due to compilation
2025-11-03 16:15:19,351 - INFO -   ‚úì EMA initialized (decay=0.9999)
2025-11-03 16:15:19,351 - INFO - 
Setting up datasets...
2025-11-03 16:15:19,351 - INFO -   Loading MAESTRO dataset...
2025-11-03 16:15:19,355 - INFO -   ‚úì MAESTRO train: 100 samples (cached)
2025-11-03 16:15:19,355 - INFO -   ‚úì MAESTRO val: 20 samples (cached)
2025-11-03 16:15:19,356 - INFO -   Loading SLAKH stems dataset...
2025-11-03 16:15:31,828 - INFO -   ‚úì SLAKH stems train: 1062 samples (cached)
2025-11-03 16:15:32,366 - INFO -   ‚úì SLAKH stems val: 207 samples (cached)
2025-11-03 16:15:32,366 - INFO -   Loading SLAKH mix dataset...
2025-11-03 16:15:32,420 - INFO -   ‚úì SLAKH mix train: 100 samples (cached)
2025-11-03 16:15:32,469 - INFO -   ‚úì SLAKH mix val: 20 samples (cached)
2025-11-03 16:15:32,469 - INFO -   Loading SLAKH mixed dataset...
2025-11-03 16:15:32,528 - INFO -   ‚úì SLAKH mixed train: 100 samples (cached)
2025-11-03 16:15:32,579 - INFO -   ‚úì SLAKH mixed val: 20 samples (cached)
2025-11-03 16:15:32,579 - INFO - 
  Warming dataset caches in main process for copy-on-write reuse...
2025-11-03 16:15:32,579 - INFO -   Warming train cache for maestro dataset before forking workers...
2025-11-03 16:15:42,922 - INFO -   Warming train cache for slakh_stems dataset before forking workers...
2025-11-03 16:15:53,379 - INFO -   Warming train cache for slakh_mix dataset before forking workers...
2025-11-03 16:16:05,966 - INFO -   Warming validation cache for maestro dataset before forking workers...
2025-11-03 16:16:06,264 - INFO -   Warming validation cache for slakh_stems dataset before forking workers...
2025-11-03 16:16:07,833 - INFO -   Warming validation cache for slakh_mix dataset before forking workers...
2025-11-03 16:16:09,415 - INFO - 
  Dataset timing summary (s): maestro_train_s=0.00, maestro_val_s=0.00, slakh_mix_train_s=0.10, slakh_mix_val_s=0.05, slakh_mixed_train_s=0.11, slakh_mixed_val_s=0.05, slakh_stems_train_s=13.01, slakh_stems_val_s=0.54, warm_caches_s=36.84
2025-11-03 16:16:09,416 - INFO - 
  Creating multi-task dataset...
2025-11-03 16:16:09,416 - INFO -   ‚úì Multi-task dataset: 1362 total samples
2025-11-03 16:16:09,416 - INFO -   Temperature settings: {'maestro': 3.0, 'slakh_stems': 3.0, 'slakh_mix': 3.0, 'slakh_mixed': 3.0}
2025-11-03 16:16:09,416 - INFO - 
  Setting up validation data...
2025-11-03 16:16:09,416 - INFO -   ‚úì Validation: 267 samples
2025-11-03 16:16:09,418 - INFO -   Optimizer: AdamW (betas=(0.9, 0.98), weight_decay=0.1)
2025-11-03 16:16:09,418 - INFO -   Using Fused AdamW optimizer (faster on CUDA)
2025-11-03 16:16:09,418 - INFO -   Label smoothing: 0.1
2025-11-03 16:16:09,418 - INFO - 
  Mixed Precision: ENABLED (FP16 with GradScaler)
2025-11-03 16:16:09,418 - INFO - 
  Learning Rate Scheduler: Warmup (50 steps) + Constant
2025-11-03 16:16:09,418 - INFO - 
Starting training...
2025-11-03 16:16:09,419 - INFO -   Total steps: 10
2025-11-03 16:16:09,419 - INFO -   Batch size: 256
2025-11-03 16:16:09,419 - INFO -   Learning rate: 0.0001
2025-11-03 16:16:09,419 - INFO -   Weight decay: 0.1
2025-11-03 16:16:09,419 - INFO -   Log interval: 5 steps
2025-11-03 16:16:09,419 - INFO -   Validation interval: 20 steps
2025-11-03 16:16:09,419 - INFO -   Save interval: 100 steps
2025-11-03 16:16:09,420 - INFO -   Initializing GPU spectrogram computer...
2025-11-03 16:16:09,492 - INFO -   ‚úì GPU spectrogram computer ready
2025-11-03 16:16:09,492 - INFO - 
================================================================================
2025-11-03 16:16:09,492 - INFO - STEP-BASED TRAINING
2025-11-03 16:16:09,492 - INFO -   Starting from step: 0
2025-11-03 16:16:09,492 - INFO -   Target steps: 10
2025-11-03 16:16:09,492 - INFO -   Batch size: 256
2025-11-03 16:16:09,492 - INFO -   Gradient accumulation steps: 4
2025-11-03 16:16:09,493 - INFO -   Effective batch size: 1024
2025-11-03 16:16:09,493 - INFO -   Mixed Precision: ENABLED (FP16)
2025-11-03 16:16:09,493 - INFO - ================================================================================
2025-11-03 16:16:09,493 - INFO - 
  ‚úì Infinite data iterator created (reshuffles each epoch)
2025-11-03 16:16:09,493 - INFO - 
üöÄ Starting training loop...
2025-11-03 16:16:09,493 - INFO -   ‚è≥ Loading first batch (this may take 10-60s due to DataLoader worker initialization + torch.compile)...
2025-11-03 16:16:09,493 - INFO -      [0] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:16:23,149 - INFO -      [0] ‚úì Batch fetched in 13.656s
2025-11-03 16:16:23,150 - INFO -      [0] Moving data to device cuda...
2025-11-03 16:16:23,158 - INFO -      [0] ‚úì Data moved to device in 0.008s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:16:23,622 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.464s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:16:23,622 - INFO -      [0] Starting forward pass...
2025-11-03 16:16:27,116 - INFO -      [0] ‚úì Forward pass completed in 3.494s, loss = 289.4440 (accum_step 1/4)
2025-11-03 16:16:27,117 - INFO -      [0] Starting backward pass...
2025-11-03 16:16:27,667 - INFO -      [0] ‚úì Backward pass completed in 0.550s
2025-11-03 16:16:27,712 - INFO -      [0] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:16:27,712 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 16:16:27,712 - INFO -      [0] Moving data to device cuda...
2025-11-03 16:16:27,720 - INFO -      [0] ‚úì Data moved to device in 0.008s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:16:27,721 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:16:27,721 - INFO -      [0] Starting forward pass...
2025-11-03 16:16:28,142 - INFO -      [0] ‚úì Forward pass completed in 0.010s, loss = 290.7148 (accum_step 2/4)
2025-11-03 16:16:28,142 - INFO -      [0] Starting backward pass...
2025-11-03 16:16:28,156 - INFO -      [0] ‚úì Backward pass completed in 0.014s
2025-11-03 16:16:28,656 - INFO -      [0] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:16:28,657 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 16:16:28,657 - INFO -      [0] Moving data to device cuda...
2025-11-03 16:16:28,658 - INFO -      [0] ‚úì Data moved to device in 0.002s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:16:28,659 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:16:28,659 - INFO -      [0] Starting forward pass...
2025-11-03 16:16:29,080 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 290.6825 (accum_step 3/4)
2025-11-03 16:16:29,080 - INFO -      [0] Starting backward pass...
2025-11-03 16:16:29,092 - INFO -      [0] ‚úì Backward pass completed in 0.012s
2025-11-03 16:16:29,595 - INFO -      [0] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:16:29,595 - INFO -      [0] ‚úì Batch fetched in 0.000s
2025-11-03 16:16:29,595 - INFO -      [0] Moving data to device cuda...
2025-11-03 16:16:29,603 - INFO -      [0] ‚úì Data moved to device in 0.008s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:16:29,604 - INFO -      [0] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:16:29,604 - INFO -      [0] Starting forward pass...
2025-11-03 16:16:30,024 - INFO -      [0] ‚úì Forward pass completed in 0.006s, loss = 287.6068 (accum_step 4/4)
2025-11-03 16:16:30,024 - INFO -      [0] Starting backward pass...
2025-11-03 16:16:30,035 - INFO -      [0] ‚úì Backward pass completed in 0.011s
2025-11-03 16:16:30,538 - INFO -      [0] Gradient clipping and optimizer step...
2025-11-03 16:16:30,654 - INFO -      [0] ‚úì Optimizer step completed in 0.116s, grad_norm = 320.6483
2025-11-03 16:16:30,655 - INFO -      [1] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:16:30,655 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:16:30,655 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:16:30,679 - INFO -      [1] ‚úì Data moved to device in 0.024s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:16:30,680 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:16:30,680 - INFO -      [1] Starting forward pass...
2025-11-03 16:16:31,517 - INFO -      [1] ‚úì Forward pass completed in 0.824s, loss = 290.1149 (accum_step 1/4)
2025-11-03 16:16:31,517 - INFO -      [1] Starting backward pass...
2025-11-03 16:16:31,609 - INFO -      [1] ‚úì Backward pass completed in 0.092s
2025-11-03 16:16:32,110 - INFO -      [1] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:16:32,110 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:16:32,111 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:16:32,112 - INFO -      [1] ‚úì Data moved to device in 0.001s (frames: torch.Size([82, 256, 128]), targets: torch.Size([82, 1024]))
2025-11-03 16:16:32,114 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.002s (shape: torch.Size([82, 256, 512]))
2025-11-03 16:16:32,114 - INFO -      [1] Starting forward pass...
2025-11-03 16:16:35,010 - INFO -      [1] ‚úì Forward pass completed in 2.820s, loss = 293.3273 (accum_step 2/4)
2025-11-03 16:16:35,010 - INFO -      [1] Starting backward pass...
2025-11-03 16:16:35,238 - INFO -      [1] ‚úì Backward pass completed in 0.228s
2025-11-03 16:16:35,250 - INFO -      [1] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:16:42,589 - INFO -      [1] ‚úì Batch fetched in 7.340s
2025-11-03 16:16:42,590 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:16:42,597 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:16:42,599 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:16:42,599 - INFO -      [1] Starting forward pass...
2025-11-03 16:16:43,029 - INFO -      [1] ‚úì Forward pass completed in 0.008s, loss = 291.0556 (accum_step 3/4)
2025-11-03 16:16:43,030 - INFO -      [1] Starting backward pass...
2025-11-03 16:16:43,043 - INFO -      [1] ‚úì Backward pass completed in 0.013s
2025-11-03 16:16:43,543 - INFO -      [1] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:16:43,543 - INFO -      [1] ‚úì Batch fetched in 0.000s
2025-11-03 16:16:43,543 - INFO -      [1] Moving data to device cuda...
2025-11-03 16:16:43,550 - INFO -      [1] ‚úì Data moved to device in 0.007s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:16:43,551 - INFO -      [1] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:16:43,551 - INFO -      [1] Starting forward pass...
2025-11-03 16:16:43,971 - INFO -      [1] ‚úì Forward pass completed in 0.007s, loss = 289.3482 (accum_step 4/4)
2025-11-03 16:16:43,972 - INFO -      [1] Starting backward pass...
2025-11-03 16:16:43,983 - INFO -      [1] ‚úì Backward pass completed in 0.011s
2025-11-03 16:16:44,484 - INFO -      [1] Gradient clipping and optimizer step...
2025-11-03 16:16:44,493 - INFO -      [1] ‚úì Optimizer step completed in 0.009s, grad_norm = 323.3961
2025-11-03 16:16:44,493 - INFO -      [2] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:16:44,493 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:16:44,493 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:16:44,495 - INFO -      [2] ‚úì Data moved to device in 0.002s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:16:44,496 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:16:44,496 - INFO -      [2] Starting forward pass...
2025-11-03 16:16:44,916 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.7172 (accum_step 1/4)
2025-11-03 16:16:44,916 - INFO -      [2] Starting backward pass...
2025-11-03 16:16:44,926 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 16:16:45,428 - INFO -      [2] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:16:45,428 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:16:45,428 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:16:45,437 - INFO -      [2] ‚úì Data moved to device in 0.008s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:16:45,437 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:16:45,437 - INFO -      [2] Starting forward pass...
2025-11-03 16:16:45,858 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 289.1096 (accum_step 2/4)
2025-11-03 16:16:45,858 - INFO -      [2] Starting backward pass...
2025-11-03 16:16:45,868 - INFO -      [2] ‚úì Backward pass completed in 0.010s
2025-11-03 16:16:46,370 - INFO -      [2] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:16:46,371 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:16:46,371 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:16:46,379 - INFO -      [2] ‚úì Data moved to device in 0.009s (frames: torch.Size([256, 256, 128]), targets: torch.Size([256, 1024]))
2025-11-03 16:16:46,380 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([256, 256, 512]))
2025-11-03 16:16:46,380 - INFO -      [2] Starting forward pass...
2025-11-03 16:16:46,800 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.8923 (accum_step 3/4)
2025-11-03 16:16:46,800 - INFO -      [2] Starting backward pass...
2025-11-03 16:16:46,811 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 16:16:47,313 - INFO -      [2] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:16:47,313 - INFO -      [2] ‚úì Batch fetched in 0.000s
2025-11-03 16:16:47,313 - INFO -      [2] Moving data to device cuda...
2025-11-03 16:16:47,313 - INFO -      [2] ‚úì Data moved to device in 0.000s (frames: torch.Size([82, 256, 128]), targets: torch.Size([82, 1024]))
2025-11-03 16:16:47,314 - INFO -      [2] ‚úì Mel-spectrograms computed on GPU in 0.001s (shape: torch.Size([82, 256, 512]))
2025-11-03 16:16:47,314 - INFO -      [2] Starting forward pass...
2025-11-03 16:16:47,453 - INFO -      [2] ‚úì Forward pass completed in 0.006s, loss = 288.9645 (accum_step 4/4)
2025-11-03 16:16:47,453 - INFO -      [2] Starting backward pass...
2025-11-03 16:16:47,464 - INFO -      [2] ‚úì Backward pass completed in 0.011s
2025-11-03 16:16:47,623 - INFO -      [2] Gradient clipping and optimizer step...
2025-11-03 16:16:47,632 - INFO -      [2] ‚úì Optimizer step completed in 0.009s, grad_norm = 325.8563
2025-11-03 16:16:47,632 - INFO -      [3] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:16:52,045 - INFO -      [3] ‚úì Batch fetched in 4.413s
2025-11-03 16:16:52,484 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 283.1287 (accum_step 1/4)
2025-11-03 16:16:52,996 - INFO -      [3] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:16:53,721 - INFO -      [3] ‚úì Batch fetched in 0.725s
2025-11-03 16:16:54,150 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 282.9729 (accum_step 2/4)
2025-11-03 16:16:54,663 - INFO -      [3] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:16:54,664 - INFO -      [3] ‚úì Batch fetched in 0.001s
2025-11-03 16:16:55,093 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 283.3706 (accum_step 3/4)
2025-11-03 16:16:55,607 - INFO -      [3] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:16:55,607 - INFO -      [3] ‚úì Batch fetched in 0.001s
2025-11-03 16:16:56,030 - INFO -      [3] ‚úì Forward pass completed in 0.007s, loss = 282.0572 (accum_step 4/4)
2025-11-03 16:16:56,553 - INFO -      [4] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:16:56,554 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 16:16:56,982 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 276.9446 (accum_step 1/4)
2025-11-03 16:16:57,494 - INFO -      [4] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:16:57,494 - INFO -      [4] ‚úì Batch fetched in 0.000s
2025-11-03 16:16:57,637 - INFO -      [4] ‚úì Forward pass completed in 0.007s, loss = 281.8099 (accum_step 2/4)
2025-11-03 16:16:57,807 - INFO -      [4] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:17:02,373 - INFO -      [4] ‚úì Batch fetched in 4.566s
2025-11-03 16:17:02,825 - INFO -      [4] ‚úì Forward pass completed in 0.009s, loss = 278.6711 (accum_step 3/4)
2025-11-03 16:17:03,339 - INFO -      [4] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:17:03,340 - INFO -      [4] ‚úì Batch fetched in 0.001s
2025-11-03 16:17:03,768 - INFO -      [4] ‚úì Forward pass completed in 0.009s, loss = 277.2386 (accum_step 4/4)
2025-11-03 16:17:04,293 - INFO -   Step 5/10: loss = 278.6661, avg_loss = 286.2086, lr = 0.000011, grad_norm = 329.5804
2025-11-03 16:17:04,294 - INFO -     ‚è±Ô∏è  Timing: total=7.740s (fetch=4.568s, to_device=0.026s, spec_compute=0.004s, forward=0.031s, backward=0.049s, optim=0.011s)
2025-11-03 16:17:04,294 - INFO -      [5] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:17:04,294 - INFO -      [5] ‚úì Batch fetched in 0.000s
2025-11-03 16:17:04,716 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 265.7399 (accum_step 1/4)
2025-11-03 16:17:05,229 - INFO -      [5] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:17:05,230 - INFO -      [5] ‚úì Batch fetched in 0.001s
2025-11-03 16:17:05,658 - INFO -      [5] ‚úì Forward pass completed in 0.008s, loss = 270.5648 (accum_step 2/4)
2025-11-03 16:17:06,172 - INFO -      [5] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:17:06,172 - INFO -      [5] ‚úì Batch fetched in 0.001s
2025-11-03 16:17:06,601 - INFO -      [5] ‚úì Forward pass completed in 0.007s, loss = 269.9822 (accum_step 3/4)
2025-11-03 16:17:07,115 - INFO -      [5] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:17:07,116 - INFO -      [5] ‚úì Batch fetched in 0.001s
2025-11-03 16:17:07,256 - INFO -      [5] ‚úì Forward pass completed in 0.009s, loss = 273.1808 (accum_step 4/4)
2025-11-03 16:17:07,436 - INFO -      [6] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:17:09,761 - INFO -      [6] ‚úì Batch fetched in 2.324s
2025-11-03 16:17:10,199 - INFO -      [6] ‚úì Forward pass completed in 0.008s, loss = 261.1902 (accum_step 1/4)
2025-11-03 16:17:10,713 - INFO -      [6] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:17:11,600 - INFO -      [6] ‚úì Batch fetched in 0.887s
2025-11-03 16:17:12,029 - INFO -      [6] ‚úì Forward pass completed in 0.008s, loss = 258.7108 (accum_step 2/4)
2025-11-03 16:17:12,543 - INFO -      [6] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:17:12,543 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:17:12,971 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 261.2436 (accum_step 3/4)
2025-11-03 16:17:13,484 - INFO -      [6] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:17:13,485 - INFO -      [6] ‚úì Batch fetched in 0.000s
2025-11-03 16:17:13,913 - INFO -      [6] ‚úì Forward pass completed in 0.006s, loss = 260.4143 (accum_step 4/4)
2025-11-03 16:17:14,437 - INFO -      [7] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:17:14,437 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:17:14,866 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 250.8850 (accum_step 1/4)
2025-11-03 16:17:15,379 - INFO -      [7] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:17:15,379 - INFO -      [7] ‚úì Batch fetched in 0.000s
2025-11-03 16:17:15,522 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 250.8562 (accum_step 2/4)
2025-11-03 16:17:15,692 - INFO -      [7] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:17:19,044 - INFO -      [7] ‚úì Batch fetched in 3.352s
2025-11-03 16:17:19,495 - INFO -      [7] ‚úì Forward pass completed in 0.008s, loss = 250.2106 (accum_step 3/4)
2025-11-03 16:17:20,009 - INFO -      [7] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:17:20,010 - INFO -      [7] ‚úì Batch fetched in 0.001s
2025-11-03 16:17:20,438 - INFO -      [7] ‚úì Forward pass completed in 0.007s, loss = 249.6501 (accum_step 4/4)
2025-11-03 16:17:20,960 - INFO -      [8] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:17:20,960 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:17:21,388 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 238.3614 (accum_step 1/4)
2025-11-03 16:17:21,901 - INFO -      [8] Fetching batch from DataLoader (accum_step 2/4)...
2025-11-03 16:17:21,901 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:17:22,329 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 234.9042 (accum_step 2/4)
2025-11-03 16:17:22,842 - INFO -      [8] Fetching batch from DataLoader (accum_step 3/4)...
2025-11-03 16:17:22,842 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:17:23,271 - INFO -      [8] ‚úì Forward pass completed in 0.006s, loss = 237.7911 (accum_step 3/4)
2025-11-03 16:17:23,785 - INFO -      [8] Fetching batch from DataLoader (accum_step 4/4)...
2025-11-03 16:17:23,785 - INFO -      [8] ‚úì Batch fetched in 0.000s
2025-11-03 16:17:23,924 - INFO -      [8] ‚úì Forward pass completed in 0.007s, loss = 234.8989 (accum_step 4/4)
2025-11-03 16:17:24,103 - INFO -      [9] Fetching batch from DataLoader (accum_step 1/4)...
2025-11-03 16:23:02,373 - INFO -      [0] ‚úì Batch fetched in 596.284s
2025-11-03 16:23:02,374 - INFO -      [0] Moving data to device cuda...
2025-11-03 16:23:02,409 - INFO -      [0] ‚úì Data moved to device in 0.035s (frames: torch.Size([256, 256, 512]), targets: torch.Size([256, 1024]))
